{"version":3,"sources":["img/silhouette2.png","CanvasEarth.js","CanvasSpace.js","AngleInput.js","InputField.js","PlayBack.js","RadioConvertUnits.js","crunchnumbers.js","processQueries.js","OutputMenu.js","App.js","serviceWorker.js","index.js","img/silhouette.png"],"names":["module","exports","timeouts","movetimeout","repeattimeout","sourceready","delayrefresh","namesp","canvasParent","canvasElement","draw_curve_static","ctx","canvaspoints","dimensions","nocircle","clearTimeout","lineWidth","beginPath","strokeStyle","arc","x","X_BUFFER","y","Y_BUFFER","Math","PI","stroke","moveTo","i","length","lineTo","draw_curve_active","time","percenttime","silhouette","startheight","currentframe","minmaxes","lastpoint","reset_canvas","pointsperframegoal","pointsperframeactual","ceil","time_delay_in_ms","setTimeout","moveline","DELAY_BETWEEN_DRAWS","scale_increment","this","series","run","value","scalemark","spot","y1","pxperfoot","y2","start","CanvasPoint","end","toString","canvasX3","canvasY3","numberspot","clearRect","width","height","fillStyle","leftside","bottomside","rightside","topside","closePath","fill","draw_floor","increment","increaseval","a","scalemarks","push","angle","font","mark","fillText","draw_scale","drawing_left","origin","numpixtotop","drawing_top","px_width","px_offset_left","directionLeft","drawImage","draw_silhouette","defaultheight","fromx","fromy","tox","toy","atan2","pxheight","cos","sin","num","places","multiplier","pow","output","round","abs","units","canvas_arrow","img","deg","flip","flop","center","save","translate","flipScale","flopScale","rad","rotate","scale","restore","getCanvaspoints","relativepoints","pointlist","maxY","minX","maxX","minY","range","canvasSize","rangeX","rangeY","DRAWING_WIDTH","DRAWING_HEIGHT","offsetX","minmax","inc","AbsolutePoint","start_v_x","start_v_y","accel_earth","x_coin","y_coin","fixBottom","canvasX","canvasY","CanvasEarth","observe","RO","resizeObserver","entries","contentRect","setState","state","updateCanvasSize","bind","loadImage","update_canvaspoints","update_all_points","draw_canvas_partial","draw_canvas_full","setDimensions","restart_interval","parentDiv","React","createRef","earthCanvasRef","disconnect","current","window","ResizeObserver","addEventListener","Image","silhouette2","props","vars","onload","src","imagefile","image2","clientWidth","clientHeight","getContext","canvas","menuLeftOpen","menuRightOpen","defaults","newProps","newState","slope","radius","omega","frozen","prevProps","prevState","speed","oldlength","floor","resources","time_increment","absolutePoint","absolutepointslist","t","Number","getRelativepoints","expectedtime","anglefromVertical","slice","ref","className","style","position","background","Component","x1","x2","factor","values","floor_start","floor_end","toconvert","acos","bottomcurve","topcurve","half_chord_value","persontoCoin","chord_angle","asin","arc_per_foot","RelativePoint","angle_hop","angle_cpo","x_rel","y_rel","x_person","y_person","x_diff","y_diff","sqrt","angle_oph","atan","CanvasSpace","sendRotation","spaceCanvasRef","duration","point","rotationStats","centerX","centerY","pointsList","isFinite","getRelativePoints","AngleInput","compassRef","focused","compassSize","onFocus","onBlur","handleOutput","e","updateState","min","max","display","componentDidUpdate","computedangle","target","type","default","variable","UnitsStyle","simplified","simplified2","plural","droppedflag","fontSize","title","float","marginBottom","marginTop","marginLeft","backgroundColor","borderRadius","padding","step","onChange","color","textAlign","log","LN10","InputField","minSlider","maxSlider","offset","handleSlider","actualValue","sliderValue","offsetMin","offsetMax","exp","sliderclass","rangeclass","rangemin","rangemax","offsetValue","bignumber","toExponential","replace","paddingLeft","id","PlayBack","maxvalue","RadioConvertUnits","name","checked","Decimal","set","precision","crunchnumbers","inputvalues","expectedheight","percentgravity","diameter","relative_v_x","relative_v_y","end_v_y","standingcoin","g_accel","standingvelocity","r_oncoin","g_oncoin","expecteddist","start_speed","x_c","y_c","div","sqroot1","mul","add","sub","max_x","max_y","theta_traversed_person","final_angle_person","x_p","y_p","x_difference","y_difference","total_difference","theta_traversed_coin","new_theta_traversed_person","angular_diff","curvilinear","maxheight","defaultImperial","thrownUp","defaultMetric","getQueryVariable","document","location","href","split","pair","decodeURIComponent","format","order","OutputMenu","menuOpen","secondaryunits","rotation","time_to_rotate","time_to_rotate_units","finalseparation2","expecteddist2","displaysecondary","finalseparation","showCurvy","rotationAngle","numRotations","lineHeight","articleUrl","onClick","closeMenuButton","defaultQuery","starsanimation","burgerPageObject","App","pageShape","queryValues","queryflag","isNaN","gravity","queryMenu","rightMenu","leftMenu","displayPopUp","PopUpOpen","processQueryVariables","answers","innerWidth","innerHeight","starSpeed","showStarForm","canvasStarData","shouldShiftForBurger","setDefaultState","updateStarSpeed","receiveStarCenter","freeze","convertunits","updateDiameter","updateOtherVars","toggleLeftMenu","toggleRightMenu","closeMenus","togglePopUp","burgerPageRef","shrinkPageForBurger","childData","starsobj","getElementById","frozenstars","canvascoords","getBoundingClientRect","page_x","page_y","diagonal","diagonal2","diagonal3","leftval","offsetWidth","topval","offsetHeight","left","top","animate","transform","iterations","Infinity","slidestarsleft","slidestarswidth","pause","newdefaults","convertfeetmet","currentTarget","isOpen","fullunits","secondspeed","EncapsulatedVariables","EncapsulatedOutput","centripaccel","throwspeed","heightexpected","checkvalue","difference","showDifference","diff_from_expected2","show_diff_from_expected2","burgerPageClass","noOverlay","onStateChange","menuClassName","swipeTolerance","tapTolerance","onSwipe","marginRight","right","open","toggle","fromunit","tounit","PopUp","showelement","FreezeButton","buttontext","MenuButton","children","Boolean","hostname","match","ReactDOM","render","StrictMode","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.9c776952.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/silhouette2.6a12f96e.png\";","/*eslint-disable eqeqeq*/\r\n//this at the top prevents the console from displaying pointless warnings.\r\n\r\n\r\n//The code has been simplified somewhat in the CanvasSpace.js page\r\n//in ways that I have not duplicated here. Some comments in that file\r\n//may explain how it works here as well.\r\n//This file still functions the same as that one in most ways.\r\n\r\n\r\nimport React, { Component } from 'react';\r\nimport './App.css';\r\n//import ReactDOM from 'react-dom'\r\nimport imagefile from './img/silhouette.png'\r\nimport image2 from './img/silhouette2.png'\r\n\r\n//If ResizeObserver isn't supported to my liking...\r\n//then there is react-resize-observer import which could do the same thing.\r\n\r\n\r\nvar timeouts = {\r\n\tmovetimeout: null,\r\n\trepeattimeout : null,\r\n\tsourceready: false,\r\n\tdelayrefresh: null,\r\n}\r\n\r\n//I created a namespace, because I don't want to post to state and then have the component refresh more than necessary. So this is in lieu of changing the state.\r\nvar namesp = {}\r\nnamesp.currentframe = null\r\nnamesp.relativepoints = null\r\nnamesp.canvaspoints = null\r\nnamesp.minmaxes = null\r\nnamesp.lastpoint = null\r\nnamesp.dimensions = null\r\n\r\n//refs are global b/c the item was mysteriously disappearing and becoming null.\r\n//This way works, and repetitively re-identifying the ref doesn't work.\r\nvar canvasParent = null;\r\nvar canvasElement = null;\r\n\r\nclass CanvasEarth extends Component {\r\n\t\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.state = { width: null, height: null,}\r\n\r\n\t\tthis.updateCanvasSize = this.updateCanvasSize.bind(this);\r\n\t\tthis.loadImage = this.loadImage.bind(this)\r\n\t\tthis.update_canvaspoints = this.update_canvaspoints.bind(this)\r\n\t\tthis.update_all_points = this.update_all_points.bind(this)\r\n\t\tthis.draw_canvas_partial = this.draw_canvas_partial.bind(this)\r\n\t\tthis.draw_canvas_full = this.draw_canvas_full.bind(this)\r\n\t\tthis.setDimensions = this.setDimensions.bind(this)\r\n\t\tthis.restart_interval = this.restart_interval.bind(this)\r\n\t\t\r\n\t\t//necessary to capture the context for the canvas\r\n\t\tthis.parentDiv = React.createRef();\r\n\t\tthis.earthCanvasRef = React.createRef();\r\n\t\t\r\n\t}\r\n\t\r\n\tobserve = RO => {\r\n\t\tthis.resizeObserver = new RO(entries => {\r\n\t\t\tconst {\r\n\t\t\t\twidth,\r\n\t\t\t\theight,\r\n\t\t\t\t//top,\r\n\t\t\t\t//right,\r\n\t\t\t\t//bottom,\r\n\t\t\t\t//left\r\n\t\t\t} = entries[0].contentRect;\r\n\t\t\tthis.setState({ width, height })\r\n\t\t});\r\n\t};\r\n\t\r\n\tcomponentWillUnmount() {\r\n\t\tif(this.resizeObserver){\r\n\t\t\tthis.resizeObserver.disconnect();\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n\tcomponentDidMount()\r\n\t{\r\n\t\tcanvasParent = this.parentDiv.current;\r\n\t\tcanvasElement = this.earthCanvasRef.current;\r\n\r\n\t\tif(\"ResizeObserver\" in window)\r\n\t\t{ this.observe(ResizeObserver);\t} \r\n\t\telse { window.addEventListener('resize', () => { this.updateCanvasSize(); });}\r\n\t\t//If no ResizeObserver, then the browser doesn't shift for the burger menu.\r\n\t\t//But ResizeObserver has wide support :-)\r\n\t\t\r\n\t\tthis.resizeObserver.observe(canvasParent);\r\n\r\n\r\n\r\n\r\n\t\t//\t\t\r\n\r\n\t\tthis.loadImage() //calls updateCanvasSize when image is ready\r\n\t\t\t\t\t\t//(otherwise image won't render at start)\r\n\t\t\t\t\t\t//which then updates state, triggering draw onto canvas\r\n\t\t\t\t\t\t//in componentDidUpdate\r\n\t}\r\n\t\r\n\t\r\n\tloadImage()\r\n\t{\r\n\t\tthis.silhouette = new window.Image();\r\n\t\tthis.silhouette2 = new window.Image();\r\n\t\t\t\t\r\n\t\t//waits for image to load. Important so it actually appears on first render.\r\n\t\tif((this.props.vars.startheight===4 && this.props.vars.units===\"ft\") || \r\n\t\t  (this.props.vars.startheight===1.2 && this.props.vars.units===\"m\"))\r\n\t\t{ this.silhouette.onload = this.updateCanvasSize.bind(this) }\r\n\t\telse\r\n\t\t{ this.silhouette2.onload = this.updateCanvasSize.bind(this) }\r\n\t\r\n\t\tthis.silhouette.src = imagefile //require('silhouette.png')\r\n\t\tthis.silhouette2.src = image2 //require('silhouette2.png')\t\t\r\n\t}\r\n\t\r\n\t/*onImageLoaded()\r\n\t{\r\n\t\t//this.setState({sourceReady:true});\r\n\t\tthis.updateCanvasSize()\t\t\r\n\t}*/\r\n\t\r\n\tupdateCanvasSize() //called by window resize event\r\n\t{\r\n\t\tconst width = (canvasParent.clientWidth)\r\n\t\tconst height = (canvasParent.clientHeight)\r\n\t\tthis.setState({ width:width, height:height })\r\n\t}\r\n\t\r\n\r\n\tsetDimensions()\r\n\t{\r\n\t\t//let canvas = this.earthCanvasRef.current;\r\n\t\t//let canvas = ReactDOM.findDOMNode(this.earthCanvasRef.current);\r\n\t\tlet ctx = canvasElement.getContext('2d');\r\n\t\t\r\n\t\tvar dimensions = {}\r\n\t\tdimensions.units = this.props.vars.units\r\n\t\tdimensions.width = ctx.canvas.clientWidth;\r\n\t\tdimensions.height = ctx.canvas.clientHeight;\r\n\t\t\r\n\t\t//Buffers used to scale the person in the middle appropriately\r\n\t\tdimensions.X_BUFFER = dimensions.width/8;\r\n\t\tdimensions.Y_BUFFER = dimensions.height/10;\r\n\t\tdimensions.DRAWING_WIDTH = dimensions.width - 2 * dimensions.X_BUFFER;\r\n\t\tdimensions.DRAWING_HEIGHT = dimensions.height - 2 * dimensions.Y_BUFFER;\r\n\t\tdimensions.DELAY_BETWEEN_DRAWS = 2.5;\r\n\t\tdimensions.menuLeftOpen = this.props.vars.menuLeftOpen;\r\n\t\tdimensions.menuRightOpen = this.props.vars.menuRightOpen;\r\n\t\tdimensions.defaultheight = this.props.defaults.startheight;\r\n\r\n\t\t//the bounds of the filled in white box\r\n\t\tdimensions.leftside = dimensions.width * -.05\r\n\t\tdimensions.rightside = dimensions.width * 1.05\r\n\t\tdimensions.topside = dimensions.height * -.05\r\n\t\tdimensions.bottomside = dimensions.height * .77\r\n\t\t\r\n\t\t/*if the menu is open, give the drawing more space*/\r\n\t\t/*if(dimensions.width < 900 && (dimensions.menuLeftOpen || dimensions.menuRightOpen))\r\n\t\t{ dimensions.X_BUFFER /= 2; }*/\r\n\t\t\r\n\t\tif(dimensions.height < 300)\t   //somehow, counterintuitively,\r\n\t\t{ dimensions.Y_BUFFER /= 1.5 } //shrinking it improved the scalemarks.\r\n\t\t\t\r\n\t\tnamesp.dimensions = dimensions\r\n\r\n\t}\r\n\t\r\n\tshouldComponentUpdate(newProps, newState)\r\n\t{\r\n\t\t//Sometimes it tries to re-render without a state or props change.\r\n\t\tif( this.props.vars.slope === newProps.vars.slope &&\r\n\t\t\tthis.props.vars.time === newProps.vars.time &&\r\n\t\t\tthis.props.vars.radius === newProps.vars.radius &&\r\n\t\t\tthis.props.vars.omega === newProps.vars.omega &&\r\n\t\t\tthis.props.vars.startheight === newProps.vars.startheight &&\r\n\t\t\tthis.props.vars.start_v_x === newProps.vars.start_v_x &&\r\n\t\t\tthis.props.vars.start_v_y === newProps.vars.start_v_y &&\r\n\t\t\tthis.props.vars.units === newProps.vars.units &&\r\n\t\t\tthis.props.vars.menuLeftOpen === newProps.vars.menuLeftOpen &&\r\n\t\t\tthis.props.vars.menuRightOpen === newProps.vars.menuRightOpen &&\r\n\t\t\tthis.props.vars.frozen === newProps.vars.frozen &&\r\n\t\t\tthis.props.vars.percenttime === newProps.vars.percenttime &&\r\n\t\t\tthis.state.height === newState.height &&\r\n\t\t\tthis.state.width === newState.width \r\n\t\t\t) \t\r\n\t\t\t{ return false; }\r\n\t\telse{ return true; \t}\r\n\t}\t\t\r\n\t\t\r\n\t\r\n\t//calculates *how much* of the canvas it needs to re-render\r\n\t//based on what changed.\r\n\tcomponentDidUpdate(prevProps, prevState)\r\n\t{\r\n\t\tif(\t\tthis.props.vars.startheight!==prevProps.vars.startheight ||\r\n\t\t\t\tthis.props.vars.speed!==prevProps.vars.speed ||\r\n\t\t\t\tthis.props.vars.units!==prevProps.vars.units)\r\n\t\t{\r\n\t\t\tthis.setDimensions()\r\n\t\t\tthis.update_all_points()\r\n\t\t\tthis.draw_canvas_full()\r\n\t\t}\r\n\t\telse if( (prevProps.vars.percenttime > 20 && this.props.vars.percenttime < 20) ||\r\n\t\t\t(prevProps.vars.percenttime > 50 && this.props.vars.percenttime < 50) )\r\n\t\t{\r\n\t\t\tvar oldlength = namesp.canvaspoints.length;\r\n\t\t\tthis.update_all_points()\r\n\t\t\tnamesp.currentframe = Math.floor((namesp.currentframe / oldlength) * namesp.canvaspoints.length); //\r\n\t\t\tthis.draw_canvas_partial()\r\n\t\t}\r\n\t\telse if(prevProps.vars.percenttime !== this.props.vars.percenttime)\r\n\t\t{\r\n\t\t\tthis.restart_interval()\r\n\t\t}\r\n\t\telse if( (this.props.vars.menuLeftOpen!==prevProps.vars.menuLeftOpen) || (this.props.vars.menuRightOpen!==prevProps.vars.menuRightOpen))\r\n\t\t{\r\n\t\t\tthis.setDimensions()\r\n\t\t\tthis.update_canvaspoints() //only need to update canvaspoints\r\n\t\t\tthis.draw_canvas_partial()\r\n\t\t}\r\n\t\telse if( ((this.state.width !== prevState.width) || (this.state.height !== prevState.height)) && namesp.relativepoints!=null )\r\n\t\t{\r\n\t\t\tthis.setDimensions()\r\n\t\t\tthis.update_canvaspoints() //only need to update canvaspoints\r\n\t\t\tthis.draw_canvas_partial()\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.setDimensions()\r\n\t\t\tthis.update_all_points()\r\n\t\t\tthis.draw_canvas_full()\r\n\t\t}\r\n\t}\r\n\r\n\tupdate_canvaspoints()\r\n\t{\r\n\t\tvar resources = getCanvaspoints(namesp.relativepoints, namesp.dimensions)//, this.props.vars.time, this.props.vars.percenttime);\r\n\t\tnamesp.canvaspoints = resources.canvaspoints\r\n\t\tnamesp.minmaxes = resources.minmaxes\r\n\t}\r\n\t\r\n\tupdate_all_points()\r\n\t{\r\n\t\tvar relativepoints = getRelativepoints(this.props.vars.expectedtime, this.props.vars.startheight, this.props.vars.percenttime, this.props.defaults.accel_earth, this.props.vars.speed, this.props.vars.anglefromVertical)\r\n\t\t\t\t\r\n\t\tvar resources = getCanvaspoints(relativepoints, namesp.dimensions)//, this.props.vars.time, this.props.vars.percenttime);\r\n\r\n\t\tnamesp.relativepoints = relativepoints\r\n\t\tnamesp.canvaspoints = resources.canvaspoints\r\n\t\tnamesp.minmaxes = resources.minmaxes\r\n\t\tnamesp.lastpoint = relativepoints[relativepoints.length-1]\r\n\t}\r\n\t\r\n\trestart_interval() //for adjustments in percent time (playback speed) only. Restarts the interval without resetting the canvas.\r\n\t{\r\n\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\t\tclearTimeout(timeouts.repeattimeout); timeouts.repeattimeout=null;\r\n\r\n\t\t//let canvas = this.earthCanvasRef.current;\r\n\t\t//let canvas = ReactDOM.findDOMNode(this.earthCanvasRef.current);\r\n\t\tlet ctx = canvasElement.getContext('2d');\r\n\r\n\t\tvar silhouette\r\n\r\n\t\tif(this.props.vars.startheight===this.props.defaults.startheight)\r\n\t\t{\tsilhouette=this.silhouette\t\t}\r\n\t\telse\r\n\t\t{ \tsilhouette=this.silhouette2 \t}\t\t\r\n\t\t\r\n\t\tif(!this.props.vars.frozen)\r\n\t\t{\tdraw_curve_active(ctx, this.props.vars.expectedtime, this.props.vars.percenttime, /* this.props.vars.radius,  */silhouette, this.props.vars.startheight, namesp.currentframe)\t}\r\n\t}\r\n\t\r\n\tdraw_canvas_partial()\r\n\t{\r\n\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\t\tclearTimeout(timeouts.repeattimeout); timeouts.repeattimeout=null;\r\n\t\t\r\n\t\t//let canvas = this.earthCanvasRef.current;\r\n\t\t//let canvas = ReactDOM.findDOMNode(this.earthCanvasRef.current);\r\n\t\tlet ctx = canvasElement.getContext('2d');\r\n\t\t\r\n\t\tvar silhouette\r\n\r\n\t\tif(this.props.vars.startheight===this.props.defaults.startheight)\r\n\t\t{\tsilhouette=this.silhouette\t\t}\r\n\t\telse\r\n\t\t{ \tsilhouette=this.silhouette2 \t}\r\n\t\r\n\t\treset_canvas(ctx, /* this.props.vars.radius,  */namesp.minmaxes, namesp.dimensions, namesp.lastpoint, silhouette, this.props.vars.startheight);\r\n\t\tif(this.props.vars.frozen) // || this.props.vars.percenttime === 0)\r\n\t\t{\r\n\t\t\tdraw_curve_static(ctx, namesp.canvaspoints, namesp.dimensions)\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tdraw_curve_static(ctx, namesp.canvaspoints.slice(0,namesp.currentframe), namesp.dimensions, \"nocircle\")\r\n\t\t\tdraw_curve_active(ctx, this.props.vars.expectedtime, this.props.vars.percenttime, /* this.props.vars.radius,  */silhouette, this.props.vars.startheight, namesp.currentframe)\r\n\t\t\t//Passing the currentframe from the namespace signals it to refresh from that point.\r\n\t\t}\r\n\t}\r\n\t\r\n\tdraw_canvas_full()\r\n\t{\r\n\t\tnamesp.currentframe=1\r\n\r\n\t\tclearTimeout(timeouts.repeattimeout); timeouts.repeattimeout=null;\t\t\r\n\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\t\t\r\n\t\t//let canvas = this.earthCanvasRef.current;\r\n\t\t//let canvas = ReactDOM.findDOMNode(this.earthCanvasRef.current);\r\n\t\tlet ctx = canvasElement.getContext('2d');\r\n\t\t\r\n\t\tvar silhouette\r\n\r\n\t\tif(this.props.vars.startheight===this.props.defaults.startheight)\r\n\t\t{\tsilhouette=this.silhouette\t\t}\r\n\t\telse\r\n\t\t{ \tsilhouette=this.silhouette2 \t}\r\n\r\n\t\t\r\n\t\tif(this.props.vars.frozen)\r\n\t\t{\r\n\t\t\t\r\n\t\t\treset_canvas(ctx, /* this.props.vars.radius,  */namesp.minmaxes, namesp.dimensions, namesp.lastpoint, silhouette, this.props.vars.startheight);\r\n\t\t\tdraw_curve_static(ctx, namesp.canvaspoints, namesp.dimensions)\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tdraw_curve_active(ctx, this.props.vars.expectedtime, this.props.vars.percenttime, /* this.props.vars.radius,  */silhouette, this.props.vars.startheight) //also resets the canvas.\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n\trender() {\r\n\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tref={this.parentDiv}\r\n\t\t\t\tclassName=\"canvasParent\"\r\n\t\t\t\tstyle={{width:'100%',height:'100%', position:'absolute', background:'#853f03'}}>\r\n\t\t\t\t\t<canvas\r\n\t\t\t\t\t\tref={this.earthCanvasRef} \r\n\t\t\t\t\t\twidth={this.state.width}\r\n\t\t\t\t\t\theight={this.state.height}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t</div>\r\n\t\t);\t\r\n\t}\r\n\t\r\n}\r\n\r\n\r\n\r\n//round to the nearest thousandth.\r\nfunction round(num, places) {\r\n    if(places==null)\r\n\t{\r\n\t\tplaces=1;\r\n\t}\r\n\t\r\n\tvar multiplier = Math.pow(10, places);\r\n    var output = Math.round(num * multiplier) / multiplier;\r\n\t\r\n\t//fix some weird output. Probably due to feet/meters conversion not being more precise.\r\n\tif(Math.abs(output - Math.round(output)) <= .0011)\r\n\t{ output = Math.round(output); }\r\n\r\n\treturn output;\t\r\n}\r\n\r\n\r\n\r\nfunction getRelativepoints(time, startheight, percenttime, accel_earth, speed, angle)\r\n{\r\n\t\r\n\tvar absolutepointslist = []\r\n\t\t\r\n\t//get ~240 increments per second, but min 240 increments, max 3000 increments.\r\n\t//It won't SHOW that many, but if the user shows at 50% speed, then I'll want them.\r\n\tvar time_increment\r\n\tif( time<1.2 )\r\n\t{ time_increment = time/130 }\r\n\telse if( time>50 )\r\n\t{ time_increment = time/6500 }\r\n\telse\r\n\t{ time_increment = .0077; }\r\n\t\r\n\tif(percenttime<10)\r\n\t{ time_increment /= 5; }\r\n\telse if(percenttime<50)\r\n\t{ time_increment /= 2; }\r\n\t\r\n\tvar absolutePoint\r\n\t\r\n\r\n\t//remember, sine and cosine are backwards from what you think since it's the angle from vertical, not from horizontal\r\n\t//also, must be converted to radians\r\n\tvar start_v_x = speed * Math.sin(angle * Math.PI / 180)\r\n\tvar start_v_y = speed * Math.cos(angle * Math.PI / 180)\r\n\t\r\n\tvar t\r\n\tfor(t=0; t<=Number(time); t+=time_increment)\r\n\t{\r\n\t\tabsolutePoint = new AbsolutePoint( t, Number(startheight), Number(start_v_x), Number(start_v_y), accel_earth)\r\n\t\tabsolutepointslist.push(absolutePoint)\r\n\t}\r\n\t\r\n\t//do it once more at t = time.\r\n\tabsolutePoint = new AbsolutePoint( Number(time), Number(startheight), Number(start_v_x), Number(start_v_y), accel_earth );\r\n\tabsolutepointslist.push( absolutePoint );\t\r\n\t\r\n\treturn absolutepointslist\r\n\t\r\n}\r\n\r\n\r\n\r\nfunction draw_curve_static(ctx, canvaspoints, dimensions, nocircle)\r\n{\r\n\t\r\n\tif(timeouts.repeattimeout!=null)\r\n\t{\t\r\n\t\tclearTimeout(timeouts.repeattimeout); timeouts.repeattimeout=null;\r\n\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\t}\r\n\r\n\t//draw a little circle where the coin *started*.\r\n\tctx.lineWidth=2\r\n\tctx.beginPath();\r\n\tctx.strokeStyle=\"#5c6870\";\r\n\tctx.arc(canvaspoints[0].x+dimensions.X_BUFFER, canvaspoints[0].y+dimensions.Y_BUFFER,5,0,2*Math.PI);\r\n\tctx.stroke();\r\n\t\r\n\t//now render all of the canvaspoints for the coin's calculated path.\r\n\tctx.beginPath();\r\n\tctx.strokeStyle=\"#000000\";\r\n\tctx.moveTo(canvaspoints[0].x+dimensions.X_BUFFER, canvaspoints[0].y+dimensions.Y_BUFFER);\r\n\t\r\n\tfor(var i=1; i<canvaspoints.length; i++)\r\n\t{\t\t\r\n\t\tctx.lineTo(canvaspoints[i].x+dimensions.X_BUFFER, canvaspoints[i].y+dimensions.Y_BUFFER)\r\n\t}\r\n\t\r\n    ctx.stroke();\r\n\t\r\n\t//draw a little circle where the coin *ended*.\r\n\tif(typeof nocircle === 'undefined') //prevents an extra circle on window resize\r\n\t{\r\n\t\tctx.beginPath();\r\n\t\tctx.strokeStyle=\"#5c6870\";\r\n\t\tctx.arc(canvaspoints[canvaspoints.length-1].x+dimensions.X_BUFFER, canvaspoints[canvaspoints.length-1].y+dimensions.Y_BUFFER,5,0,2*Math.PI);\r\n\t\tctx.stroke();\r\n\t\tctx.strokeStyle=\"#000000\";\r\n\t}\r\n}\r\n\r\n\r\nfunction draw_curve_active(ctx, time, percenttime, /* radius,  */silhouette, startheight, currentframe)\r\n{\r\n\tvar canvaspoints = namesp.canvaspoints\r\n\tvar dimensions = namesp.dimensions\r\n\tvar minmaxes = namesp.minmaxes\r\n\tvar lastpoint = namesp.lastpoint\r\n\t\r\n\tif(timeouts.repeattimeout!=null)\r\n\t{\t\r\n\t\tclearTimeout(timeouts.repeattimeout); timeouts.repeattimeout=null;\r\n\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\t}\r\n\t\t\r\n\tif(currentframe==null)\r\n\t{\r\n\t\treset_canvas(ctx, /* radius,  */minmaxes, dimensions, lastpoint, silhouette, startheight);\r\n\t\tnamesp.currentframe=1;\r\n\t\t\r\n\t\t//draw a little circle where the coin *started*.\r\n\t\tctx.lineWidth=2\r\n\t\tctx.beginPath();\r\n\t\tctx.strokeStyle=\"#5c6870\";\r\n\t\tctx.arc(canvaspoints[0].x+dimensions.X_BUFFER, canvaspoints[0].y+dimensions.Y_BUFFER,5,0,2*Math.PI);\r\n\t\tctx.stroke();\r\n\r\n\t\tctx.strokeStyle=\"#000000\"; //reset the stroke style to black.\r\n\t}\r\n\t\r\n\t\r\n\t//output ~38fps\r\n\tconst framespersecond = 38\r\n\tvar pointspersecond = canvaspoints.length / ( time * (100/percenttime)  )\r\n\tvar pointsperframegoal = pointspersecond / framespersecond\r\n\tvar pointsperframeactual = Math.ceil(pointsperframegoal)\r\n\tvar offset = pointsperframeactual / pointsperframegoal\r\n\tvar time_delay_in_ms = (1/framespersecond) * offset * 1000\r\n\t\r\n\t//Timeouts are better than intervals because they can be adjusted mid-draw,\r\n\t//and they will not interfere with each other.\r\n\tfunction moveline() {\r\n\t\tif(namesp.currentframe>=canvaspoints.length)\r\n\t\t{  \r\n\t\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\t\t\t//necessary so you don't have to wait forever\r\n\t\t\t//if you adjusted the percent time mid-draw.\r\n\r\n\t\t\ttimeouts.repeattimeout = setTimeout(function() {\r\n\t\t\t\tdraw_curve_active(ctx, time, percenttime, /* radius,  */silhouette, startheight); }, dimensions.DELAY_BETWEEN_DRAWS * 1000);\r\n\r\n\t\t\t//draw a little circle where the coin *ended*.\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.strokeStyle=\"#5c6870\";\r\n\t\t\tctx.lineWidth=2\r\n\t\t\tctx.arc(canvaspoints[canvaspoints.length-1].x+dimensions.X_BUFFER, canvaspoints[canvaspoints.length-1].y+dimensions.Y_BUFFER,5,0,2*Math.PI);\r\n\t\t\tctx.stroke();\r\n\t\t\tctx.strokeStyle=\"#000000\";\t\t\t\t\t\r\n\r\n\t\t\treturn; \r\n\t\t}\r\n\r\n\t\tctx.beginPath();\r\n\t\tctx.moveTo(canvaspoints[namesp.currentframe-1].x+dimensions.X_BUFFER, canvaspoints[namesp.currentframe-1].y+dimensions.Y_BUFFER);\r\n\t\t\t\t\r\n\t\tfor(var x=0; x<pointsperframeactual; x++)\r\n\t\t{\r\n\t\t\tif(namesp.currentframe>=canvaspoints.length)\r\n\t\t\t{  \r\n\t\t\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\t\r\n\t\t\t\t//necessary so you don't have to wait forever\r\n\t\t\t\t//if you adjusted the percent time mid-draw.\r\n\t\t\t\tctx.stroke();\r\n\r\n\t\t\t\ttimeouts.repeattimeout = setTimeout(function() {\r\n\t\t\t\t\tdraw_curve_active(ctx, time, percenttime, /* radius,  */silhouette, startheight); }, dimensions.DELAY_BETWEEN_DRAWS * 1000);\r\n\t\t\t\t\t\r\n\t\t\t\t//draw a little circle where the coin *ended*.\r\n\t\t\t\tctx.lineWidth=2\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.strokeStyle=\"#5c6870\";\r\n\t\t\t\tctx.arc(canvaspoints[canvaspoints.length-1].x+dimensions.X_BUFFER, canvaspoints[canvaspoints.length-1].y+dimensions.Y_BUFFER,5,0,2*Math.PI);\r\n\t\t\t\tctx.stroke();\r\n\t\t\t\tctx.strokeStyle=\"#000000\";\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\treturn; \r\n\t\t\t}\r\n\r\n\t\t\tctx.lineTo(canvaspoints[namesp.currentframe].x+dimensions.X_BUFFER, canvaspoints[namesp.currentframe].y+dimensions.Y_BUFFER)\r\n\t\t\t\r\n\t\t\tnamesp.currentframe+=1;\r\n\t\t}\r\n\t\tctx.stroke();\r\n\r\n\t\tif(namesp.currentframe<=canvaspoints.length)\r\n\t\t\t{timeouts.movetimeout = setTimeout(moveline, time_delay_in_ms)}\r\n\t};\r\n\r\n\ttimeouts.movetimeout = setTimeout(moveline, time_delay_in_ms);\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n//increment the scale nicely to units of 1,2,4,5,10,20,40,50,100,...\r\n//more intuitive for the user.\r\nfunction scale_increment() {\r\n\tthis.series = -1;\r\n\t\t\r\n\tthis.run = function(value) {\r\n\t\tthis.series+=1;\r\n\t\tif(this.series==4)\r\n\t\t{\r\n\t\t\tthis.series=0;\r\n\t\t}\r\n\t\t\r\n\t\tif(this.series!=2)\r\n\t\t{\r\n\t\t\treturn value*=2\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\treturn value+=value/4\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n//generate the positions for a scale mark,\r\n//given the angle on a circle where you want to display it and a labeled \"value\"\r\nfunction scalemark(spot, minmaxes, value, dimensions)\r\n{\r\n\t//mark size 10px, means 5px above and below ground\r\n\t//subtract the proper number of feet-per-pixel\r\n\tvar x = spot\r\n\t\t\r\n\tvar y1 = 5 / minmaxes.pxperfoot //top \r\n\tvar y2 = -5 / minmaxes.pxperfoot //bottom\r\n\t\r\n\tthis.start = new CanvasPoint(minmaxes, x, y1, dimensions)\r\n\tthis.end = new CanvasPoint(minmaxes, x, y2, dimensions)\r\n\t\r\n\tthis.spot=spot\r\n\t\r\n\tvar length = value.toString().length;\r\n\tvar canvasX3 = this.end.x - length*4\r\n\tvar canvasY3 = this.end.y + 15\r\n\t\t\t\t//the draw coord starts from the bottom. adjust for that.\r\n\t\t\t\t//the more \"up\" on the circle, the more it matters.\r\n\t\t\t\t\r\n\tthis.numberspot = {x : canvasX3, y : canvasY3}\r\n\tthis.value = value\r\n}\r\n\r\n\r\n\r\nfunction draw_scale(ctx, minmaxes, dimensions, lastpoint)\r\n{\r\n\t\r\n\tconst scale_color = \"#9dfcdb\"\r\n\t\t\r\n\tvar start = 0;\r\n\t\r\n\t//show the scale in both directions! \r\n\t//If the coin goes the other way, then display the scale the other way.\r\n\r\n\tif(lastpoint.x < 1e-10 && lastpoint.x > -1e-10)\r\n\t{\r\n\t\tlastpoint.x = 0;\r\n\t}\r\n\r\n\tvar end = lastpoint.x\r\n\t\r\n\t//Match the scale to the canvas. Calculate arc-per-foot, px-per-foot.\r\n\t//Or METERS...the math works out the same. I'm not changing variable names.\r\n\t//arcperfoot is the variable actually used to calculate tic locations.\r\n\t//Pxperfoot is used to generate a scale range that would actually be\r\n\t//human-interpretable.\r\n\t//var arc_per_foot = 1 / radius\r\n\t\r\n\t//Pick a scale distance that fits with > 20 pixels between each tick.\r\n\t//Intelligently increment the scale interval to something human-interpretable.\r\n\t//Goes 1, 2, 4, 5, 10, 20, 40, 50, 100, 200, 400, 500, 1000...\r\n\tvar increment=1;\r\n\tvar increaseval = new scale_increment()\r\n\t\r\n\twhile(minmaxes.pxperfoot*increment<25)\r\n\t{\r\n\t\tincrement = increaseval.run(increment);\r\n\t}\r\n\r\n\t\r\n\t//if the numbers are long, give it extra space\r\n\t//by incrementing the interval a bit more.\r\n\tif(increment.toString().length >= 3 )\r\n\t{\twhile(minmaxes.pxperfoot*increment<45)\r\n\t\t{\r\n\t\t\tincrement = increaseval.run(increment);\r\n\t\t}\r\n\t}\r\n\r\n\tvar i=0;\r\n\t\r\n\tif(end===0)\r\n\t{\r\n\t\tstart = -increment\r\n\t\tend = increment\r\n\r\n\t\ti -= increment\t\t\r\n\t}\r\n\r\n\t//generate the locations for the tic marcks, \r\n\t//up to the end spot plus one tic.\r\n\t//coded for both a positive arc and a negative arc, depending\r\n\t//which way the coin went.\r\n\t\r\n\tvar scalemarks = [];\r\n\tvar a\r\n\tif(lastpoint.x < 0)\r\n\t{\r\n\t\t//incrementing over an angle, so I called it a for angle.\r\n\t\tfor(a=start; a>end-increment; a-=increment) //-increment to give an extra tic\r\n\t\t{\r\n\t\t\tscalemarks.push(new scalemark(/*radius,*/ a, minmaxes, i, dimensions) )\r\n\t\t\ti+=increment;\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\tfor(a=start; a<end+increment; a+=increment)\r\n\t\t{\r\n\t\t\tscalemarks.push(new scalemark(/*radius,*/ a, minmaxes, i, dimensions) )\r\n\t\t\ti+=increment;\r\n\t\t}\r\n\t}\r\n\t\r\n\tif(scalemarks.length===2)\r\n\t{\r\n\t\tvar angle=((scalemarks[1].angle - start) * -1) + start\r\n\t\tscalemarks.push(new scalemark(/*radius,*/ angle, minmaxes, scalemarks[1].value, dimensions) )\r\n\t}\r\n\r\n\t//draw the marks\t\r\n\tctx.font = \"bold 14px Arial\";\r\n\tctx.lineWidth = 3;\r\n\t\r\n\tctx.beginPath();\r\n\tctx.fillStyle = scale_color;\r\n\tctx.strokeStyle = scale_color;\r\n\tfor(i=0; i<scalemarks.length; i++)\r\n\t{\r\n\t\tvar mark = scalemarks[i]\r\n\t\tctx.moveTo(mark.start.x+dimensions.X_BUFFER, mark.start.y+dimensions.Y_BUFFER)\r\n\t\tctx.lineTo(mark.end.x+dimensions.X_BUFFER, mark.end.y+dimensions.Y_BUFFER)\r\n\t\tctx.fillText(mark.value.toString(), mark.numberspot.x+dimensions.X_BUFFER, mark.numberspot.y+dimensions.Y_BUFFER);\r\n\t}\r\n\tctx.stroke()\r\n\t\r\n}\r\n\r\n\r\n\r\n//erase canvas, draw the floor, and draw the scale if applicable.\r\nfunction reset_canvas(ctx, /* radius,  */minmaxes, dimensions, lastpoint, silhouette, startheight) {\r\n\t\r\n\tctx.clearRect(0, 0, dimensions.width, dimensions.height);\r\n\t\r\n\tdraw_floor(ctx, minmaxes, dimensions)\t\r\n\t\r\n\tdraw_scale(ctx, minmaxes, dimensions, lastpoint)\r\n\r\n\tif(silhouette!=null)\r\n\t{ draw_silhouette(ctx, silhouette, minmaxes, dimensions, dimensions.defaultheight);  }\r\n\t\r\n\tif( startheight !== dimensions.defaultheight )\r\n\t{   canvas_arrow(ctx, minmaxes, dimensions, startheight); \t}\r\n\t\r\n\t\r\n}\r\n\r\nfunction canvas_arrow(ctx, minmaxes, dimensions, startheight) {\t\r\n    \r\n\tvar origin = new CanvasPoint(minmaxes, 0, 0, dimensions)\r\n\tvar start = new CanvasPoint(minmaxes, 0, startheight, dimensions)\r\n\r\n\tvar fromx = origin.x + dimensions.X_BUFFER\r\n\tvar fromy = origin.y + dimensions.Y_BUFFER\r\n\tvar tox = start.x + dimensions.X_BUFFER\r\n\tvar toy = start.y + dimensions.Y_BUFFER + 7 //+7 so it's not dwarfing the coin.\r\n\t\r\n\tvar headlen = 10;   // length of head in pixels\r\n    var angle = Math.atan2(toy-fromy,tox-fromx);\r\n\t\r\n\tvar pxheight = fromy - toy\r\n\tif(pxheight > 15)\r\n\t{\r\n\t\tctx.beginPath()\r\n\t\tctx.strokeStyle=\"red\"\r\n\t\tctx.fillStyle=\"red\"\r\n\t\tctx.lineWidth=1.5\r\n\t\tctx.moveTo(fromx, fromy);\r\n\t\tctx.lineTo(tox, toy);\r\n\t\tctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/6),toy-headlen*Math.sin(angle-Math.PI/6));\r\n\t\tctx.moveTo(tox, toy);\r\n\t\tctx.lineTo(tox-headlen*Math.cos(angle+Math.PI/6),toy-headlen*Math.sin(angle+Math.PI/6));\r\n\r\n\t\tctx.fillText(round(startheight).toString() + \" \" + dimensions.units, fromx + 5, fromy - pxheight/2);\r\n\t\tctx.stroke()\r\n\t}\r\n}\r\n\r\nfunction draw_silhouette(ctx, silhouette, minmaxes, dimensions, startheight)\r\n{\r\n\t//drawing is dimensions [323,831] (width, height).\r\n\t//Need the spot (24, 539) (from bottom) to cooincide\r\n\t\t//with *relative* coordinate (0,4), aligned to the canvas.\r\n\r\n\t//var footbuffer = 2\r\n\t\r\n\tvar origin = new CanvasPoint(minmaxes, 0, 0, dimensions)\r\n\tvar px_startheight = minmaxes.pxperfoot * startheight\r\n\tvar numpixtotop = (px_startheight * 830/539)\r\n\tvar drawing_top = origin.y - numpixtotop\r\n\tvar px_width = numpixtotop * 323/831\r\n\tvar px_offset_left = px_width * 24/323\r\n\t\r\n\tvar drawing_left\r\n\tif(minmaxes.directionLeft)\r\n\t{\r\n\t\tdrawing_left = origin.x - px_offset_left\t\r\n\t\tdrawImage(ctx, silhouette, drawing_left + dimensions.X_BUFFER, drawing_top + dimensions.Y_BUFFER, px_width, numpixtotop);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tdrawing_left = origin.x + px_offset_left\r\n\t\tdrawImage(ctx, silhouette, drawing_left + dimensions.X_BUFFER-px_width, drawing_top + dimensions.Y_BUFFER, px_width, numpixtotop, 0, true);\r\n\t}\r\n}\r\n\r\n\r\nfunction drawImage(ctx, img, x, y, width, height, deg, flip, flop, center)\r\n{\r\n\tctx.save();\r\n\r\n\tif(typeof width === \"undefined\") width = img.width;\r\n\tif(typeof height === \"undefined\") height = img.height;\r\n\tif(typeof center === \"undefined\") center = false;\r\n\r\n\t// Set rotation point to center of image, instead of top/left\r\n\tif(center) {\r\n\t\tx -= width/2;\r\n\t\ty -= height/2;\r\n\t}\r\n\r\n\t// Set the origin to the center of the image\r\n\tctx.translate(x + width/2, y + height/2);\r\n\r\n\t// Rotate the canvas around the origin\r\n\tvar rad = 2 * Math.PI - deg * Math.PI / 180;    \r\n\tctx.rotate(rad);\r\n\r\n\tvar flipScale\r\n\tvar flopScale\r\n\t// Flip/flop the canvas\r\n\tif(flip) flipScale = -1; else flipScale = 1;\r\n\tif(flop) flopScale = -1; else flopScale = 1;\r\n\tctx.scale(flipScale, flopScale);\r\n\r\n\t// Draw the image    \r\n\tctx.drawImage(img, -width/2, -height/2, width, height);\r\n\r\n\tctx.restore();\r\n}\r\n\r\n//only runs when the canvaspoints need to be *changed*.\r\n//(when the model is changed, or percent speed is altered)\r\nfunction getCanvaspoints(relativepoints, dimensions)//, time, percenttime) \r\n{\r\n\t\r\n\tvar minmaxes = minmax(relativepoints, dimensions)\r\n\t\r\n\tvar canvaspoints = []\r\n\t\r\n\t//generate HTML canvas coordinates.\r\n\t//Will select a variable number based on the \"percent speed\" selected.\r\n\t//(it won't use all of the relativepoint()'s)\r\n\tvar i=0;\r\n\t//var interval = relativepoints.length / numpoints\r\n\tfor(var inc=0; inc<relativepoints.length; inc+=1) //interval)\r\n\t{\r\n\t\ti=Math.ceil(inc)\r\n\t\tif(i>=relativepoints.length)\r\n\t\t{\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\t\r\n\t\tcanvaspoints.push(new CanvasPoint(minmaxes, relativepoints[i], dimensions))\r\n\t}\r\n\t\t\r\n\t//ensure the very last relativepoint gets used, to make it seamless with the floor.\r\n\tif(i!=relativepoints.length-1)\r\n\t{\r\n\t\tcanvaspoints.push(new CanvasPoint(minmaxes, relativepoints[relativepoints.length-1], dimensions))\r\n\t}\r\n\r\n\t\r\n\treturn { canvaspoints: canvaspoints, minmaxes: minmaxes,};  //set it in the global namespace for the draw functions.\r\n}\r\n\r\n\r\n//Calculate and store the location of the coin at t = time\r\nfunction AbsolutePoint( time, startheight, start_v_x, start_v_y, accel_earth)\r\n{\r\n\r\n\tvar x_coin = start_v_x * time\t\r\n\tvar y_coin = startheight + (start_v_y * time) + ((-1/2) * accel_earth * time * time) //basic kinematics formula. -1/2 because accel is downward.\r\n\tthis.time = time\r\n\tthis.x = x_coin\r\n\tthis.y = y_coin\r\n\t\r\n}\r\n\r\n//Generate point coordinates with respect to the canvas.\r\nfunction CanvasPoint(minmaxes, x, y, dimensions) {\r\n\t//canvasPoint can accept either X and Y coordinates or a RelativePoint.\r\n\t\r\n\t//sometimes the function gets called with three variables instead of four.\r\n\t//In that case, x is a point with x and y attached, and \"y\" is dimensions.\r\n\tif(!(typeof x==\"number\"))\r\n\t{ dimensions = y; y = x.y; x=x.x; }\r\n\t\r\n\t\r\n\tvar zeroY = namesp.dimensions.bottomside\r\n\tvar testY = namesp.dimensions.DRAWING_HEIGHT - 0\r\n\t\t\r\n\tvar fixBottom = zeroY - testY\t\r\n\t\r\n\tvar canvasX = (((x - minmaxes.minX) / minmaxes.range) * minmaxes.canvasSize) + minmaxes.offsetX\r\n\tvar canvasY = dimensions.DRAWING_HEIGHT - (( y / minmaxes.range ) * minmaxes.canvasSize ) + fixBottom\r\n\t\r\n\tthis.x = canvasX;\r\n\tthis.y = canvasY;\r\n\r\n}\r\n\r\n//calculate the min and max values for the displayed canvas.\r\nfunction minmax(pointlist, dimensions) {\r\n\t\r\n\t//Ensure, that if these max values are not reached, that\r\n\t//these are set to the maxes (otherwise it will find a greater value)\r\n\tvar minX=pointlist[0].x  //a good starting value is the first one in the list.\r\n\r\n\tvar maxX=pointlist[0].x \r\n\tvar maxY\r\n\tif(dimensions.units==\"ft\")\r\n\t{\tif(pointlist[0].x < 1)\r\n\t\t{ maxX = 1 }\r\n\r\n\t\tmaxY=6 \t\r\n\t}\r\n\telse\r\n\t{\tif(pointlist[0].x < 1)\r\n\t\t{ maxX = 0.3048 }\r\n\r\n\t\tmaxY = 1.829  //meters \r\n\t}\r\n\r\n\r\n\r\n\tvar minY=0 //definitely need to show the original floor. Include y=0 in the range!\r\n\r\n\t//the coin toss assumes a 6-ft person :-)\r\n\t//I'd ideally like to put that person into the window.\r\n\t\r\n\t//Iterate through the given point list to find the min and max values\r\n\t//(assuming it supercedes the values I initialized above)\r\n\tfor(var i=0; i<pointlist.length; i++)\r\n\t{\r\n\t\tif(pointlist[i].x < minX)\r\n\t\t{ minX = pointlist[i].x }\r\n\r\n\t\tif(pointlist[i].x > maxX)\r\n\t\t{ maxX = pointlist[i].x }\r\n\r\n\t\tif(pointlist[i].y < minY)\r\n\t\t{ minY = pointlist[i].y }\r\n\r\n\t\tif(pointlist[i].y > maxY)\r\n\t\t{ maxY = pointlist[i].y }\r\n\t}\r\n\t\r\n\tvar rangeX = Math.abs(maxX - minX)\r\n\tvar rangeY = Math.abs(maxY - minY)\r\n\tvar range\r\n\tif(rangeX > rangeY)\r\n\t{ range = rangeX }\r\n\telse\r\n\t{ range = rangeY }\r\n\t\r\n\t//Ensures the scale stays proportional if height/width are adjusted differently.\r\n\tvar canvasSize\r\n\tif(dimensions.DRAWING_WIDTH/dimensions.DRAWING_HEIGHT < rangeX/rangeY)\r\n\t{\tcanvasSize = dimensions.DRAWING_WIDTH \t}\r\n\telse\r\n\t{ \tcanvasSize = dimensions.DRAWING_HEIGHT  }\r\n\t\r\n\tvar offsetX = (dimensions.DRAWING_WIDTH - (rangeX / range) * canvasSize) / 2\r\n\r\n\t/*\t\t\t\t\t//more annoying than helpful\r\n\t//(counteract the side menu somewhat)\r\n\tif(dimensions.menuRightOpen && dimensions.menuLeftOpen)\r\n\t{\t\t\t}  //do nothing\r\n\telse if(dimensions.menuLeftOpen && dimensions.width < 900 && rangeY/rangeX<=10)\r\n\t{\t\toffsetX *= 2;  \t}\r\n\telse if(dimensions.menuRightOpen && dimensions.width < 900 && rangeY/rangeX<=10)\r\n\t{\t\toffsetX = 0;   \t}\r\n\telse if(dimensions.menuLeftOpen && dimensions.width < 900 && rangeY/rangeX > 10)\r\n\t{\t\toffsetX *= (7/4);\t}\r\n\telse if(dimensions.menuRightOpen && dimensions.width < 900 && rangeY/rangeX > 10)\r\n\t{\t\toffsetX *= (1/4);\t}\r\n\telse if(dimensions.menuLeftOpen && dimensions.width >= 900)\r\n\t{\t\toffsetX *= (3/2); \t}\r\n\telse if(dimensions.menuRightOpen && dimensions.width >= 900)\r\n\t{\t\toffsetX *= (1/2); \t}\r\n\t*/\r\n\t\r\n\t//used to know which way the silhouette should face :-).\r\n\tvar directionLeft=true;\r\n\tif(pointlist.length>10) //sometimes it is only one point. Don't want it to crash.\r\n\t{ \t\r\n\t\tvar point_difference=pointlist[10].x-pointlist[0].x\r\n\t\tif( point_difference > 1e-4)  //either very small or positive (to the right)\r\n\t\t{ directionLeft=false; }\r\n\t}\r\n\t\r\n\tvar minmaxes = { minX: minX,\r\n\t\t\t\t maxX: maxX,\r\n\t\t\t\t minY: minY,\r\n\t\t\t\t maxY: maxY,\r\n\t\t\t\t range: range, //only one variable for range, to keep x proportional with y.\r\n\t\t\t\t canvasSize: canvasSize,\r\n\t\t\t \t pxperfoot: canvasSize / range,\r\n\t\t\t\t directionLeft: directionLeft,\r\n\t\t\t\t offsetX: offsetX,\r\n\t\t\t\t rangeX: rangeX,\r\n\t\t\t\t rangeY: rangeY,\r\n\t}\r\n\t\t\t\t \r\n\treturn minmaxes\r\n}\r\n\r\n\r\n\r\n//Custom circle-drawing function to render the station floor.\r\n\r\n//depending on the parameters, the station could be HUGE, or very small.\r\n\t//If it's huge, I don't want to render the entire floor. Too big!\r\n\t//If it's small, I DO want to render the entire floor.\r\n\t\r\n//I felt that it would be easier to keep it proportional by doing this\r\n\t\t//together with my canvaspoint()'s,\r\n//rather than simply using the context.arc() function.\r\nfunction draw_floor(ctx, minmaxes, dimensions)\r\n{\r\n\r\n\tconst floor_color = \"#318503\"\r\n\tconst floor_width = 6\r\n\tconst station_color = \"white\"\r\n\r\n\tctx.lineWidth=floor_width;\r\n\tctx.strokeStyle=floor_color;\r\n\tctx.fillStyle=station_color;\t\r\n\t\r\n\t\t\r\n\t\t//START by filling outer-space around the curve!\r\n\t\tctx.beginPath()\r\n\t\t\t\t\r\n\t\tctx.moveTo(dimensions.leftside,dimensions.bottomside + dimensions.Y_BUFFER)\r\n\t\tctx.lineTo(dimensions.rightside,dimensions.bottomside + dimensions.Y_BUFFER)\r\n\t\tctx.lineTo(dimensions.rightside,dimensions.topside)\r\n\t\tctx.lineTo(dimensions.leftside, dimensions.topside)\r\n\t\tctx.lineTo(dimensions.leftside,dimensions.bottomside + dimensions.Y_BUFFER)\r\n\r\n\r\n\t\tctx.closePath()\r\n\t\tctx.fill()\r\n\t\tctx.stroke()\r\n}\r\n\r\n\r\nexport default CanvasEarth;","/*eslint-disable eqeqeq*/\r\n\r\nimport React, { Component } from 'react';\r\n//import ContainerDimensions from 'react-container-dimensions';\r\n\t//cannot obtain a ref from a functional component,\r\n\t//thus cannot get the context.\r\n\r\nimport './App.css';\r\n//import ReactDOM from 'react-dom'\r\nimport imagefile from './img/silhouette.png'\r\nimport image2 from './img/silhouette2.png'\r\n\r\n//If ResizeObserver isn't supported to my liking...\r\n//then there is react-resize-observer import which could do the same thing.\r\n\r\nvar timeouts = {\r\n\t//moveinterval : null,\r\n\tmovetimeout: null,\r\n\trepeattimeout : null,\r\n\tsourceready: false,\r\n\tdelayrefresh: null,\r\n}\r\n\r\n//I created a namespace, because I don't want to post to state and then have the component refresh.\r\nvar namesp = {}\r\nnamesp.currentframe = null\r\nnamesp.relativepoints = null\r\nnamesp.canvaspoints = null\r\nnamesp.minmaxes = null\r\nnamesp.lastpoint = null\r\nnamesp.dimensions = null\r\n\r\n//refs are global b/c the item was mysteriously disappearing and becoming null.\r\n//This way works, and repetitively re-identifying the ref doesn't work.\r\nvar canvasParent = null;\r\nvar canvasElement = null;\r\n\r\nclass CanvasSpace extends Component {\r\n\t\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis.state = { width: null, height: null,}\r\n\t\t\r\n\t\tthis.updateCanvasSize = this.updateCanvasSize.bind(this);\r\n\t\t\r\n\t\tthis.loadImage = this.loadImage.bind(this)\r\n\t\tthis.update_canvaspoints = this.update_canvaspoints.bind(this)\r\n\t\tthis.update_all_points = this.update_all_points.bind(this)\r\n\t\tthis.draw_canvas_partial = this.draw_canvas_partial.bind(this)\r\n\t\tthis.draw_canvas_full = this.draw_canvas_full.bind(this)\r\n\t\tthis.setDimensions = this.setDimensions.bind(this)\r\n\t\tthis.restart_interval = this.restart_interval.bind(this)\r\n\t\tthis.sendRotation = this.sendRotation.bind(this)\r\n\r\n\t\t//necessary to capture the context for the canvas\r\n\t\tthis.parentDiv = React.createRef();\t\t\r\n\t\tthis.spaceCanvasRef = React.createRef();\r\n\t\tthis.resizeObserver = null;\r\n\t}\r\n\t\r\n\tobserve = RO => {\r\n\t\tthis.resizeObserver = new RO(entries => {\r\n\t\t\tconst {\r\n\t\t\t\twidth,\r\n\t\t\t\theight,\r\n\t\t\t\t//top,\r\n\t\t\t\t//right,\r\n\t\t\t\t//bottom,\r\n\t\t\t\t//left\r\n\t\t\t} = entries[0].contentRect;\r\n\t\t\tthis.setState({ width, height })\r\n\t\t});\r\n\t};\r\n\t\r\n\tcomponentWillUnmount() {\r\n\t\tif(this.resizeObserver){\r\n\t\t\tthis.resizeObserver.disconnect();\r\n\t\t}\r\n\t}\r\n\t\r\n\tcomponentDidMount()\r\n\t{\r\n\t\tcanvasParent = this.parentDiv.current;\r\n\t\tcanvasElement = this.spaceCanvasRef.current;\r\n\t\t\r\n\t\tif(\"ResizeObserver\" in window)\r\n\t\t{ this.observe(ResizeObserver);\t} \r\n\t\telse { window.addEventListener('resize', () => { this.updateCanvasSize(); });}\r\n\t\t//If no ResizeObserver, then the browser doesn't shift for the burger menu.\r\n\t\t//But ResizeObserver has wide support :-)\r\n\t\t\r\n\t\tthis.resizeObserver.observe(canvasParent);\r\n\t\t\r\n\t\t\r\n\t\t//window.addEventListener('resize', () => { this.updateCanvasSize(); });\r\n\r\n\t\tthis.loadImage() //calls updateCanvasSize when image is ready\r\n\t\t\t\t\t\t//(otherwise image won't render at start)\r\n\t\t\t\t\t\t//which then updates state, triggering draw onto canvas\r\n\t\t\t\t\t\t//in componentDidUpdate\r\n\t}\r\n\t\r\n\tloadImage()  //loads the person on the canvas\r\n\t{\r\n\t\tthis.silhouette = new window.Image();\r\n\t\tthis.silhouette2 = new window.Image();\r\n\t\t\t\t\r\n\t\t//waits for image to load. Important so it actually appears on first render.\r\n\t\tif((this.props.vars.startheight===4 && this.props.vars.units===\"ft\") || \r\n\t\t  (this.props.vars.startheight===1.2 && this.props.vars.units===\"m\"))\r\n\t\t{ this.silhouette.onload = this.updateCanvasSize.bind(this) }\r\n\t\telse\r\n\t\t{ this.silhouette2.onload = this.updateCanvasSize.bind(this) }\r\n\t\r\n\t\tthis.silhouette.src = imagefile //require('silhouette.png')\r\n\t\tthis.silhouette2.src = image2 //require('silhouette2.png')\t\t\r\n\t}\r\n\t\r\n\t//Runs after the image is loaded. If I don't wait for it to load like this,\r\n\t//the image won't draw at all on the first render\r\n\t/*onImageLoaded()\r\n\t{\r\n\t\tthis.updateCanvasSize()\t\t\r\n\t}*/\t\t//function is unnecessary. It just calls another function.\r\n\t\r\n\tupdateCanvasSize() //called by window resize event\r\n\t{\r\n\t\tconst width = (canvasParent.clientWidth);\r\n\t\tconst height = (canvasParent.clientHeight);\r\n\t\tthis.setState({ width:width, height:height })\r\n\t}\r\n\t\r\n\t//set canvas dimensions to a variable\r\n\tsetDimensions()\r\n\t{\r\n\t\t//let canvas = this.spaceCanvasRef.current\r\n\t\t//let canvas = ReactDOM.findDOMNode(this.spaceCanvasRef.current);\r\n\t\tlet ctx = canvasElement.getContext('2d');\r\n\t\t\r\n\t\tvar dimensions = {}\r\n\t\tdimensions.units = this.props.vars.units\r\n\t\tdimensions.width = ctx.canvas.clientWidth;\r\n\t\tdimensions.height = ctx.canvas.clientHeight;\r\n\t\t\r\n\t\t//Buffers used to scale the person in the middle appropriately\r\n\t\tdimensions.X_BUFFER = dimensions.width/10;\r\n\t\tdimensions.Y_BUFFER = dimensions.height/8;\r\n\t\tdimensions.DRAWING_WIDTH = dimensions.width - 2 * dimensions.X_BUFFER;\r\n\t\tdimensions.DRAWING_HEIGHT = dimensions.height - 2 * dimensions.Y_BUFFER;\r\n\t\tdimensions.DELAY_BETWEEN_DRAWS = 2.5;\r\n\t\tdimensions.menuLeftOpen = this.props.vars.menuLeftOpen;\r\n\t\tdimensions.menuRightOpen = this.props.vars.menuRightOpen;\r\n\t\tdimensions.defaultheight = this.props.defaults.startheight;\r\n\t\t\t\t//remember the canvas draws from top-left, so\r\n\t\t\t\t//these buffers are counterintuitive\r\n\t\t\t\t\r\n\t\tif(dimensions.height < 350)\t   //somehow, counterintuitively,\r\n\t\t{ dimensions.Y_BUFFER /= 1.5 } //shrinking it improved the scalemarks (on mobile)\r\n\t\telse if(dimensions.height>500)\r\n\t\t{ dimensions.Y_BUFFER *= 1.25 }  //for laptops and larger screens\r\n\r\n\t\tnamesp.dimensions = dimensions\r\n\t\t\r\n\t}\r\n\t\r\n\tshouldComponentUpdate(newProps, newState)\r\n\t{\t\r\n\t\t//Sometimes it tries to re-render without a state or props change.\r\n\t\tif( this.props.vars.slope === newProps.vars.slope &&\r\n\t\t\tthis.props.vars.time === newProps.vars.time &&\r\n\t\t\tthis.props.vars.radius === newProps.vars.radius &&\r\n\t\t\tthis.props.vars.omega === newProps.vars.omega &&\r\n\t\t\tthis.props.vars.startheight === newProps.vars.startheight &&\r\n\t\t\tthis.props.vars.start_v_x === newProps.vars.start_v_x &&\r\n\t\t\tthis.props.vars.start_v_y === newProps.vars.start_v_y &&\r\n\t\t\tthis.props.vars.units === newProps.vars.units &&\r\n\t\t\tthis.props.vars.menuLeftOpen === newProps.vars.menuLeftOpen &&\r\n\t\t\tthis.props.vars.menuRightOpen === newProps.vars.menuRightOpen &&\r\n\t\t\tthis.props.vars.frozen === newProps.vars.frozen &&\r\n\t\t\tthis.props.vars.percenttime === newProps.vars.percenttime &&\r\n\t\t\tthis.state.height === newState.height &&\r\n\t\t\tthis.state.width === newState.width\r\n\t\t)\r\n\t\t\t{ \treturn false; }\r\n\t\telse{ \treturn true; \t}\r\n\t}\t\t\r\n\t\t\r\n\t\r\n\t//calculates *how much* of the canvas it needs to re-render\r\n\t//based on what variables changed.\r\n\tcomponentDidUpdate(prevProps, prevState)\r\n\t{\t\t\t\t\t//never uses the angle!\t\r\n\t\t if( \tthis.props.vars.startheight!==prevProps.vars.startheight ||\r\n\t\t\t\tthis.props.vars.speed!==prevProps.vars.speed ||\r\n\t\t\t\tthis.props.vars.radius!==prevProps.vars.radius ||\r\n\t\t\t\tthis.props.vars.omega!==prevProps.vars.omega ||\r\n\t\t\t\tthis.props.vars.units!==prevProps.vars.units)\r\n\t\t{\r\n\t\t\tthis.setDimensions()\r\n\t\t\tthis.update_all_points()\r\n\t\t\tthis.draw_canvas_full()\r\n\t\t}\r\n\t\telse if((prevProps.vars.percenttime > 20 && this.props.vars.percenttime < 20) \r\n\t\t\t|| (prevProps.vars.percenttime > 50 && this.props.vars.percenttime < 50))\r\n\t\t{\r\n\t\t\tvar oldlength = namesp.canvaspoints.length;\r\n\t\t\tthis.update_all_points()\r\n\t\t\tnamesp.currentframe = Math.floor((namesp.currentframe / oldlength) * namesp.canvaspoints.length); //\r\n\t\t\tthis.draw_canvas_partial()\r\n\t\t}\r\n\t\telse if(prevProps.vars.percenttime != this.props.vars.percenttime)\r\n\t\t{\r\n\t\t\tthis.restart_interval()\r\n\t\t}\r\n\t\telse if( (this.props.vars.menuLeftOpen!==prevProps.vars.menuLeftOpen) || (this.props.vars.menuRightOpen!==prevProps.vars.menuRightOpen))\r\n\t\t{\r\n\t\t\tthis.setDimensions()\t\t\t//shape of canvas has changed.\r\n\t\t\tthis.update_canvaspoints() \t\t//only need to update canvaspoints\r\n\t\t\tthis.draw_canvas_partial()\t\t//because the actual path stays the same\r\n\t\t}\r\n\t\telse if( ((this.state.width != prevState.width) || (this.state.height != prevState.height)) && namesp.relativepoints!=null )\r\n\t\t{\r\n\t\t\tthis.setDimensions()\r\n\t\t\tthis.update_canvaspoints() //only need to update canvaspoints\r\n\t\t\tthis.draw_canvas_partial()\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.setDimensions()\r\n\t\t\tthis.update_all_points()\r\n\t\t\tthis.draw_canvas_full()\r\n\t\t}\r\n\t\t/*else if(prevProps.vars.percenttime===0 && this.props.vars.percenttime!==0)\r\n\t\t{\r\n\t\t\tthis.draw_canvas_partial()\r\n\t\t}*/\r\n\t\t/*else if( this.props.vars.frozen!==prevProps.vars.frozen)\r\n\t\t{\r\n\t\t\tthis.draw_canvas_partial() //don't need to update any variables.\r\n\t\t}*/\t\r\n\t\t\r\n\t\tthis.sendRotation();\r\n\t\t\r\n\t}\r\n\t\r\n\t//tells the parent app the center of rotation for the stars\r\n\tsendRotation() {  //sends to callbackFunction() in App.js\r\n\t\t\t\t\t\r\n\t\tvar point = new CanvasPoint(0, this.props.vars.radius, namesp.dimensions)\r\n\t\t\r\n\t\t//duration in ms of a full rotation\r\n\t\t\r\n\t\tvar duration\r\n\t\tif(Number(this.props.vars.omega)===0){ duration=0;}\r\n\t\telse{ duration = (1 / (this.props.vars.omega / (2*Math.PI) ) ) * 1000 }\r\n\t\t\t//the playback speed is dealt with in App.js\r\n\t\t//console.log(duration)\r\n\t\r\n\t\tvar rotationStats = {}\t\t//center of rotation on canvas\r\n\t\trotationStats.centerX = point.x\r\n\t\trotationStats.centerY = point.y\r\n\t\trotationStats.duration = duration\r\n\t\t//console.log(duration)\r\n\t\t\t\t\r\n\t\tthis.props.sendRotation(rotationStats);\r\n\t\t\r\n\t}\r\n\r\n\t//if the canvas size has changed, then you don't need to recalculate all points...\r\n\t//just the canvaspoints. Probably doesn't save that much cpu, but whatever.\r\n\tupdate_canvaspoints()\r\n\t{\r\n\t\t\t//if you don't do this first,\r\n\t\t\t//it won't adjust right when the screen resizes, etc\r\n\t\tnamesp.minmaxes = minmax(namesp.relativepoints, namesp.dimensions)\r\n\t\t\r\n\t\tgetCanvaspoints(namesp.relativepoints, this.props.vars.time, this.props.vars.percenttime);\r\n\t\t//namesp.canvaspoints = resources.canvaspoints\r\n\t}\r\n\t\r\n\t//Update all of the points when a variable changes\r\n\tupdate_all_points()\r\n\t{\r\n\t\tvar relativepoints = getRelativePoints(this.props.vars.slope, this.props.vars.time, this.props.vars.radius, this.props.vars.omega, this.props.vars.startheight, this.props.vars.start_v_x, this.props.vars.start_v_y, this.props.vars.percenttime)\r\n\t\t\r\n\t\t//update namespace now that I have new relativepoints\r\n\t\tnamesp.minmaxes = minmax(relativepoints, namesp.dimensions)\r\n\t\tnamesp.relativepoints = relativepoints\r\n\t\t\r\n\t\tgetCanvaspoints(relativepoints, this.props.vars.time, this.props.vars.percenttime);\r\n\r\n\t\t//namesp.canvaspoints = resources.canvaspoints\r\n\t\t//namesp.minmaxes = resources.minmaxes //the getCanvaspoints function does this\r\n\t\tnamesp.lastpoint = relativepoints[relativepoints.length-1]\r\n\t\t\r\n\t\t//console.log(\"lastpoint\", namesp.lastpoint.x, namesp.lastpoint.y)\r\n\t}\r\n\t\r\n\trestart_interval() //for adjustments in percent time only. Restarts the interval without resetting the canvas.\r\n\t{\r\n\t\t//clearInterval(timeouts.moveinterval); timeouts.moveinterval=null;\r\n\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\t\tclearTimeout(timeouts.repeattimeout); timeouts.repeattimeout=null;\r\n\r\n\t\t//let canvas = this.spaceCanvasRef.current\r\n\t\t//let canvas = ReactDOM.findDOMNode(this.spaceCanvasRef.current);\r\n\t\tlet ctx = canvasElement.getContext('2d');\r\n\r\n\t\tvar silhouette\r\n\t\t//if((this.props.vars.startheight==4 && this.props.vars.units===\"ft\") || (this.props.vars.startheight==1.219 && this.props.vars.units===\"m\"))\r\n\t\tif(this.props.vars.startheight===this.props.defaults.startheight)\r\n\t\t{\tsilhouette=this.silhouette\t\t}\r\n\t\telse\r\n\t\t{ \tsilhouette=this.silhouette2 \t}\t\t\r\n\t\t\r\n\t\tif(!this.props.vars.frozen) //&& this.props.vars.percenttime !== 0)\r\n\t\t{\tdraw_curve_active(ctx, this.props.vars.time, this.props.vars.percenttime, this.props.vars.radius, silhouette, this.props.vars.startheight, namesp.currentframe)\t}\r\n\t\t/*else if(this.props.vars.percenttime===0)\r\n\t\t{\tdraw_curve_static(ctx, namesp.canvaspoints, namesp.dimensions)\t}*/\r\n\t}\r\n\t\r\n\tdraw_canvas_partial()\r\n\t{\r\n\t\t//console.log(this.props.vars.frozen)\r\n\t\t\r\n\t\t//console.log(\"canvas partial update\")\r\n\t\t\r\n\t\t//clearInterval(timeouts.moveinterval); timeouts.moveinterval=null;\r\n\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\t\tclearTimeout(timeouts.repeattimeout); timeouts.repeattimeout=null;\r\n\t\t\r\n\t\t//let canvas = this.spaceCanvasRef.current\r\n\t\t//let canvas = ReactDOM.findDOMNode(this.spaceCanvasRef.current);\r\n\t\tlet ctx = canvasElement.getContext('2d');\r\n\t\t\r\n\t\tvar silhouette\r\n\t\t//if((this.props.vars.startheight==4 && this.props.vars.units===\"ft\") || (this.props.vars.startheight==1.219 && this.props.vars.units===\"m\"))\r\n\t\tif(this.props.vars.startheight===this.props.defaults.startheight)\r\n\t\t{\tsilhouette=this.silhouette\t\t}\r\n\t\telse\r\n\t\t{ \tsilhouette=this.silhouette2 \t}\r\n\t\r\n\t\treset_canvas(ctx, this.props.vars.radius, namesp.lastpoint, silhouette, this.props.vars.startheight);\r\n\t\tif(this.props.vars.frozen) // || this.props.vars.percenttime === 0)\r\n\t\t{\r\n\t\t\t//clearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\t\t\tdraw_curve_static(ctx, namesp.canvaspoints, namesp.dimensions)\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tdraw_curve_static(ctx, namesp.canvaspoints.slice(0,namesp.currentframe), namesp.dimensions,\"nocircle\")\r\n\t\t\tdraw_curve_active(ctx, this.props.vars.time, this.props.vars.percenttime, this.props.vars.radius, silhouette, this.props.vars.startheight, namesp.currentframe)\r\n\t\t\t//Passing the currentframe from the namespace signals it to refresh from that point.\r\n\t\t}\r\n\t}\r\n\t\r\n\tdraw_canvas_full()\r\n\t{\r\n\t\tnamesp.currentframe=1\r\n\t\t//console.log(\"canvas full update\")\r\n\t\t\r\n\t\t//clearInterval(timeouts.moveinterval); timeouts.moveinterval=null;\r\n\t\tclearTimeout(timeouts.repeattimeout); timeouts.repeattimeout=null;\t\t\r\n\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\t\t\r\n\t\t//let canvas = ReactDOM.findDOMNode(this.spaceCanvasRef.current);\r\n\t\t//let canvas = this.spaceCanvasRef.current;\r\n\t\tlet ctx = canvasElement.getContext('2d');\r\n\t\t\r\n\t\tvar silhouette\r\n\t\t//if((this.props.vars.startheight==4 && this.props.vars.units===\"ft\") || (this.props.vars.startheight==1.219 && this.props.vars.units===\"m\"))\r\n\t\tif(this.props.vars.startheight===this.props.defaults.startheight)\r\n\t\t{\tsilhouette=this.silhouette\t\t}\r\n\t\telse\r\n\t\t{ \tsilhouette=this.silhouette2 \t}\r\n\r\n\t\t\r\n\t\tif(this.props.vars.frozen) // || this.props.vars.percenttime == 0)\r\n\t\t{\r\n\t\t\t\r\n\t\t\treset_canvas(ctx, this.props.vars.radius, namesp.lastpoint, silhouette, this.props.vars.startheight);\r\n\t\t\tdraw_curve_static(ctx, namesp.canvaspoints, namesp.dimensions)\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tdraw_curve_active(ctx, this.props.vars.time, this.props.vars.percenttime, this.props.vars.radius, silhouette, this.props.vars.startheight) //also resets the canvas.\r\n\t\t}\r\n\t}\r\n\t\r\n\r\n\trender() {\r\n\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tref={this.parentDiv}\r\n\t\t\t\tclassName=\"canvasParent\"\r\n\t\t\t\tstyle={{width:'100%',height:'100%', position:'absolute',}}>\r\n\t\t\t\t\t<canvas\r\n\t\t\t\t\t\tref={this.spaceCanvasRef} \r\n\t\t\t\t\t\twidth={this.state.width}\r\n\t\t\t\t\t\theight={this.state.height}\r\n\t\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\t\r\n\t}\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//round to the nearest thousandth.\r\nfunction round(num, places) {\r\n    if(places==null)\r\n\t{\r\n\t\tplaces=1;\r\n\t}\r\n\t\r\n\tvar multiplier = Math.pow(10, places);\r\n    var output = Math.round(num * multiplier) / multiplier;\r\n\t\r\n\t//fix some weird output. Probably due to feet/meters conversion not being more precise.\r\n\tif(Math.abs(output - Math.round(output)) <= .0011)\r\n\t{ output = Math.round(output); }\r\n\r\n\treturn output;\t\r\n}\r\n\r\n\r\n\r\nfunction getRelativePoints(slope, time, radius, omega, startheight, start_v_x, start_v_y, percenttime)\r\n{\r\n\t\r\n\t\r\n\t//get ~240 increments per second, but min 240 increments, max 3000 increments.\r\n\t//It won't SHOW that many, but if the user shows at 50% speed, then I'll want them.\r\n\tvar time_increment\r\n\tif( time<1.2 )\r\n\t{ time_increment = time/130 }\r\n\telse if( time>50 )\r\n\t{ time_increment = time/6500 }\r\n\telse\r\n\t{ time_increment = .0077; }\r\n\t\r\n\tif(percenttime<10)\r\n\t{ time_increment /= 5; }\r\n\telse if(percenttime<50)\r\n\t{ time_increment /= 2; }\r\n\t\r\n\t//var time_increment = Number(time.div(150))\r\n\r\n\t//get the points\r\n\tvar pointsList = []\r\n\tvar point\r\n\tif(time > 0)\r\n\t{\r\n\t\tvar t\r\n\t\tfor(t=0; t<=Number(time); t+=time_increment)\r\n\t\t{\r\n\t\t\tpoint = new RelativePoint( t, Number(radius), Number(omega), Number(startheight), Number(start_v_x), Number(start_v_y) )\r\n\t\t\tpointsList.push(point)\r\n\t\t}\r\n\t\t\r\n\t\t//do it once more at t = time.\r\n\t\tpoint = new RelativePoint( Number(time), Number(radius), Number(omega), Number(startheight), Number(start_v_x), Number(start_v_y) );\r\n\t\tpointsList.push( point );\t\t\t\r\n\t}\r\n\telse if(time==0 || !isFinite(time))\r\n\t{\r\n\t\tpoint = new RelativePoint( 0, Number(radius), 0, Number(startheight), 0, 0 )\r\n\t\tpointsList.push(point) //push exactly one point\r\n\t}\r\n\t\r\n\treturn pointsList\r\n}\r\n\r\n\r\n\r\nfunction draw_curve_static(ctx, canvaspoints, dimensions, nocircle)\r\n{\r\n\t//console.log(timeouts)\r\n\t\r\n\t//draw a little circle where the coin *started*.\r\n\tctx.beginPath();\r\n\tctx.strokeStyle=\"#5c6870\";\r\n\tctx.arc(canvaspoints[0].x, canvaspoints[0].y,5,0,2*Math.PI);\r\n\tctx.stroke();\r\n\t\r\n\t//now render all of the canvaspoints for the coin's calculated path.\r\n\tctx.beginPath();\r\n\tctx.strokeStyle=\"#000000\";\r\n\tctx.moveTo(canvaspoints[0].x, canvaspoints[0].y);\r\n\t\r\n\tfor(var i=1; i<canvaspoints.length; i++)\r\n\t{\t\t\r\n\t\tctx.lineTo(canvaspoints[i].x, canvaspoints[i].y)\r\n\t}\r\n\t\r\n    ctx.stroke();\r\n\t\r\n\t//draw a little circle where the coin *ended*.\r\n\tif(typeof nocircle === 'undefined') //prevents an extra circle on window resize\r\n\t{\r\n\t\tctx.beginPath();\r\n\t\tctx.strokeStyle=\"#5c6870\";\r\n\t\tctx.arc(canvaspoints[canvaspoints.length-1].x, canvaspoints[canvaspoints.length-1].y,5,0,2*Math.PI);\r\n\t\tctx.stroke();\r\n\t\tctx.strokeStyle=\"#000000\";\r\n\t}\r\n}\r\n\r\n//draws the curve using a timeout, starting this function every so many milliseconds\r\n//based on the playback speed, showing an accurate, active coin toss\r\nfunction draw_curve_active(ctx, time, percenttime, radius, silhouette, startheight, currentframe)\r\n{\r\n\tvar canvaspoints = namesp.canvaspoints\r\n\tvar dimensions = namesp.dimensions\r\n\t//var minmaxes = namesp.minmaxes\r\n\tvar lastpoint = namesp.lastpoint\r\n\t\r\n//\tif(timeouts.moveinterval!=null)\r\n\tif(timeouts.repeattimeout!=null)\r\n\t{\t\r\n\t\t//clearInterval(timeouts.moveinterval); timeouts.moveinterval=null;\r\n\t\tclearTimeout(timeouts.repeattimeout); timeouts.repeattimeout=null;\r\n\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\t}\r\n\t\r\n\tif(currentframe==null)\r\n\t{\r\n\t\treset_canvas(ctx, radius, lastpoint, silhouette, startheight);\r\n\t\tnamesp.currentframe=1;\r\n\t\t\r\n\t\t//draw a little circle where the coin *started*.\r\n\t\tctx.beginPath();\r\n\t\tctx.strokeStyle=\"#5c6870\";\r\n\t\tctx.arc(canvaspoints[0].x, canvaspoints[0].y,5,0,2*Math.PI);\r\n\t\tctx.stroke();\r\n\r\n\t\tctx.strokeStyle=\"#000000\"; //reset the stroke style to black.\r\n\t}\r\n\t\r\n\t\r\n\t//output ~38fps\r\n\tconst framespersecond = 38\r\n\tvar pointspersecond = canvaspoints.length / ( time * (100/percenttime)  )\r\n\tvar pointsperframegoal = pointspersecond / framespersecond\r\n\tvar pointsperframeactual = Math.ceil(pointsperframegoal)\r\n\tvar offset = pointsperframeactual / pointsperframegoal\r\n\tvar time_delay_in_ms = (1/framespersecond) * offset * 1000\r\n\t\r\n\t//Timeouts are better than intervals because they can be adjusted mid-draw,\r\n\t//and they will not interfere with each other. Less buggy.\r\n\tfunction moveline() {\r\n\t\tif(namesp.currentframe>=canvaspoints.length)\r\n\t\t{  //clearInterval(timeouts.moveinterval); timeouts.moveinterval=null; \r\n\t\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\t\t\t//necessary so you don't have to wait forever\r\n\t\t\t//if you adjusted the percent time mid-draw.\r\n\r\n\t\t\ttimeouts.repeattimeout = setTimeout(function() {\r\n\t\t\t\tdraw_curve_active(ctx, time, percenttime, radius, silhouette, startheight); }, dimensions.DELAY_BETWEEN_DRAWS * 1000);\r\n\t\t\t\r\n\t\t\t//draw a little circle where the coin *ended*.\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.strokeStyle=\"#5c6870\";\r\n\t\t\tctx.arc(canvaspoints[canvaspoints.length-1].x, canvaspoints[canvaspoints.length-1].y,5,0,2*Math.PI);\r\n\t\t\tctx.stroke();\r\n\t\t\tctx.strokeStyle=\"#000000\";\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\treturn; \r\n\t\t}\r\n\r\n\t\tctx.beginPath();\r\n\t\tctx.moveTo(canvaspoints[namesp.currentframe-1].x, canvaspoints[namesp.currentframe-1].y);\r\n\t\t\r\n\t\tfor(var x=0; x<pointsperframeactual; x++)\r\n\t\t{\r\n\t\t\tif(namesp.currentframe>=canvaspoints.length)\r\n\t\t\t{  //clearInterval(timeouts.moveinterval); timeouts.moveinterval=null; \r\n\t\t\t\tclearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\t\r\n\t\t\t\t//necessary so you don't have to wait forever\r\n\t\t\t\t//if you adjusted the percent time mid-draw.\r\n\t\t\t\tctx.stroke();\r\n\r\n\t\t\t\ttimeouts.repeattimeout = setTimeout(function() {\r\n\t\t\t\t\tdraw_curve_active(ctx, time, percenttime, radius, silhouette, startheight); }, dimensions.DELAY_BETWEEN_DRAWS * 1000);\r\n\t\t\t\t\t\r\n\t\t\t\t//draw a little circle where the coin *ended*.\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.strokeStyle=\"#5c6870\";\r\n\t\t\t\tctx.arc(canvaspoints[canvaspoints.length-1].x, canvaspoints[canvaspoints.length-1].y,5,0,2*Math.PI);\r\n\t\t\t\tctx.stroke();\r\n\t\t\t\tctx.strokeStyle=\"#000000\";\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\treturn; \r\n\t\t\t}\r\n\r\n\t\t\tctx.lineTo(canvaspoints[namesp.currentframe].x, canvaspoints[namesp.currentframe].y)\r\n\r\n\t\t\t//draw a little circle at the coin's current spot.\r\n\t\t\t/*  //this is buggy. Too difficult with only a tiny return.\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.lineWidth = 6;\r\n\t\t\tctx.strokeStyle=\"#ffffff\"; //erase the previous drawing of the coin...\r\n\t\t\tctx.arc(canvaspoints[namesp.currentframe-1].x, canvaspoints[namesp.currentframe-1].y,5,0,2*Math.PI);\r\n\t\t\tctx.stroke();\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.lineWidth = 3;\r\n\t\t\tctx.strokeStyle=\"#5c6870\"; //draw the current coin\r\n\t\t\tctx.arc(canvaspoints[namesp.currentframe].x, canvaspoints[namesp.currentframe].y,5,0,2*Math.PI);\r\n\t\t\tctx.stroke();\r\n\t\t\tctx.strokeStyle=\"#000000\";\r\n\t\t\tctx.lineWidth = 2;\r\n\t\t\t\r\n\t\t\tif(namesp.currentframe > 2) {  //redraw the line after erasing the coin\r\n\t\t\t\tctx.moveTo(canvaspoints[namesp.currentframe-3].x, canvaspoints[namesp.currentframe-3].y) \r\n\t\t\t\tctx.lineTo(canvaspoints[namesp.currentframe-2].x, canvaspoints[namesp.currentframe-2].y) \t\r\n\t\t\t}\r\n\t\t\tif(namesp.currentframe > 1) { \r\n\t\t\t\tctx.moveTo(canvaspoints[namesp.currentframe-2].x, canvaspoints[namesp.currentframe-2].y) \r\n\t\t\t\tctx.lineTo(canvaspoints[namesp.currentframe-1].x, canvaspoints[namesp.currentframe-1].y) \t\r\n\t\t\t}\r\n\t\t\tif(namesp.currentframe > 0) { //extend the line forward.\r\n\t\t\t\tctx.moveTo(canvaspoints[namesp.currentframe-1].x, canvaspoints[namesp.currentframe-1].y) \r\n\t\t\t\tctx.lineTo(canvaspoints[namesp.currentframe].x, canvaspoints[namesp.currentframe].y) \t\r\n\t\t\tctx.stroke();\r\n\t\t\t} */\r\n\t\t\t\r\n\t\t\tnamesp.currentframe+=1;\r\n\t\t}\r\n\t\tctx.stroke();\r\n\r\n\t\tif(namesp.currentframe<=canvaspoints.length)\r\n\t\t\t{timeouts.movetimeout = setTimeout(moveline, time_delay_in_ms)}\r\n\r\n\t};\r\n\r\n\ttimeouts.movetimeout = setTimeout(moveline, time_delay_in_ms);\r\n\t//timeouts.moveinterval = setInterval(moveline, time_delay_in_ms);\r\n}\r\n\r\n\r\n\r\n\r\n//increment the scale nicely to units of 1,2,4,5,10,20,40,50,100,...\r\n//more intuitive for the user.\r\nfunction scale_increment() {\r\n\tthis.series = -1;\r\n\t\t\r\n\tthis.run = function(value) {\r\n\t\tthis.series+=1;\r\n\t\tif(this.series==4)\r\n\t\t{\r\n\t\t\tthis.series=0;\r\n\t\t}\r\n\t\t\r\n\t\tif(this.series!=2)\r\n\t\t{\r\n\t\t\treturn value*=2\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\treturn value+=value/4\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n//generate the positions for a scale mark,\r\n//given the angle on a circle where you want to display it and a labeled \"value\"\r\nfunction scalemark(radius, angle, minmaxes, value, dimensions)\r\n{\r\n\t//mark size 10px, means 5px above and below station curve\r\n\t//subtract the proper number of feet-per-pixel from the radius to achieve.\r\n\tvar x1 = (radius - (5 / minmaxes.pxperfoot)) * Math.cos(angle)\r\n\tvar x2 = (radius + (5 / minmaxes.pxperfoot)) * Math.cos(angle)\r\n\t//var x3 = (radius + (30 / minmaxes.pxperfoot)) * Math.cos(angle)\r\n\t\r\n\tvar y1 = (radius - (5 / minmaxes.pxperfoot)) * Math.sin(angle) + radius\r\n\tvar y2 = (radius + (5 / minmaxes.pxperfoot)) * Math.sin(angle) + radius\r\n\t//var y3 = (radius + (20 / minmaxes.pxperfoot)) * Math.sin(angle) + radius\r\n\t\r\n\tthis.start = new CanvasPoint( x1, y1)\r\n\tthis.end = new CanvasPoint( x2, y2)\r\n\t\r\n\tthis.angle=angle\r\n\t\r\n\tvar length = value.toString().length;\r\n\tvar canvasX3 = this.end.x - length*3 + length*3*Math.cos(angle) + 10*Math.cos(angle)\r\n\tvar canvasY3 = this.end.y - 15*Math.sin(angle) + 3*(Math.sin(angle)+1)\r\n\t\t\t\t//the draw coord starts from the bottom. adjust for that.\r\n\t\t\t\t//the more \"up\" on the circle, the more it matters.\r\n\t\t\t\t\r\n\tthis.numberspot = {x : canvasX3, y : canvasY3}\r\n\t//this.numberoffsetX = value.toString().length*5\r\n\t//this.numberoffsetY = -5 * Math.cos(angle)\r\n\tthis.value = value\r\n}\r\n\r\n\r\n\r\nfunction draw_scale(ctx, radius, lastpoint)\r\n{\r\n\tvar minmaxes = namesp.minmaxes;\r\n\tvar dimensions = namesp.dimensions;\r\n\t\r\n\tconst scale_color = \"#9dfcdb\"\r\n\t\r\n\t//angle swept from person (floor) to coin's landing position.\r\n\tvar half_chord_value = lastpoint.persontoCoin/(2*radius)\r\n\tif(half_chord_value > 1) { half_chord_value = 1 }  //a bugfix\r\n\tvar chord_angle = 2 * Math.asin(half_chord_value)\r\n\t\r\n\t//var chord_angle = lastpoint.angle_poc //is apparently not equivalent?\r\n\r\n\t//var curve_dist = radius * chord_angle //total scale distance\r\n\t\t\t\t\t\t\t\t\t\t\t//variable never used.\r\n\t\r\n\tvar start = 3*Math.PI/2  //starting scale angle, always at 3PI/2 (270D)\r\n\t\r\n\t//show the scale in both directions! \r\n\t//If the coin goes the other way, then display the scale the other way.\r\n\tvar end\r\n\tif(lastpoint.x < 0)\r\n\t{\tend = start - chord_angle  } //end scale angle\r\n\telse\r\n\t{\tend = start + chord_angle  }\r\n\r\n\r\n\t//Match the scale to the canvas. Calculate arc-per-foot, px-per-foot.\r\n\t//Or METERS...the math works out the same. I'm not changing variable names.\r\n\t//arcperfoot is the variable actually used to calculate tic locations.\r\n\t//Pxperfoot is used to generate a scale range that would actually be\r\n\t//human-interpretable.\r\n\tvar arc_per_foot = 1 / radius\r\n\t\r\n\t//Pick a scale distance that fits with > 20 pixels between each tick.\r\n\t//Intelligently increment the scale interval to something human-interpretable.\r\n\t//Goes 1, 2, 4, 5, 10, 20, 40, 50, 100, 200, 400, 500, 1000...\r\n\tvar increment=1;\r\n\tvar increaseval = new scale_increment()\r\n\t\r\n\twhile(minmaxes.pxperfoot*increment<25)\r\n\t{\r\n\t\tincrement = increaseval.run(increment);\r\n\t}\r\n\r\n\t//if the numbers are long, give it extra space\r\n\t//by incrementing the interval a bit more.\r\n\tif(increment.toString().length >= 3 || (chord_angle * radius) > 1000)\r\n\t{\twhile(minmaxes.pxperfoot*increment<45)\r\n\t\t{\r\n\t\t\tincrement = increaseval.run(increment);\r\n\t\t}\r\n\t}\r\n\t\r\n\t//generate the locations for the tic marcks, \r\n\t//up to the end spot plus one tic.\r\n\t//coded for both a positive arc and a negative arc, depending\r\n\t//which way the coin went.\r\n\tvar i=0;\r\n\tvar scalemarks = [];\r\n\tvar a\r\n\tif(lastpoint.x < 0)\r\n\t{\r\n\t\t//incrementing over an angle, so I called it a for angle.\r\n\t\tfor(a=start; a>end-(arc_per_foot*increment); a-=(arc_per_foot*increment))\r\n\t\t{\r\n\t\t\tscalemarks.push(new scalemark(radius, a, minmaxes, i, dimensions) )\r\n\t\t\ti+=increment;\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\tfor(a=start; a<end+(arc_per_foot*increment); a+=(arc_per_foot*increment))\r\n\t\t{\r\n\t\t\tscalemarks.push(new scalemark(radius, a, minmaxes, i, dimensions) )\r\n\t\t\ti+=increment;\r\n\t\t}\r\n\t}\r\n\t\r\n\tif(scalemarks.length===2)\r\n\t{\r\n\t\tvar angle=((scalemarks[1].angle - start) * -1) + start\r\n\t\tscalemarks.push(new scalemark(radius, angle, minmaxes, scalemarks[1].value, dimensions) )\r\n\t}\r\n\r\n\t//draw the marks\t\r\n\tctx.font = \"bold 14px Arial\";\r\n\tctx.lineWidth = 3;\r\n\t\r\n\tctx.beginPath();\r\n\tctx.fillStyle = scale_color;\r\n\tctx.strokeStyle = scale_color;\r\n\tfor(i=0; i<scalemarks.length; i++)\r\n\t{\r\n\t\tvar mark = scalemarks[i]\r\n\t\tctx.moveTo(mark.start.x, mark.start.y)\r\n\t\tctx.lineTo(mark.end.x, mark.end.y)\r\n\t\tctx.fillText(mark.value.toString(), mark.numberspot.x, mark.numberspot.y);\r\n\t}\r\n\tctx.stroke()\r\n\t\r\n\tctx.fillStyle=\"#000000\"\r\n\tctx.strokeStyle=\"#000000\"\r\n\tctx.lineWidth = 2;\r\n}\r\n\r\n\r\n\r\n//erase canvas, draw the floor, and draw the scale if applicable.\r\nfunction reset_canvas(ctx, radius, lastpoint, silhouette, startheight) {\r\n\t\r\n\tvar minmaxes = namesp.minmaxes;\r\n\tvar dimensions = namesp.dimensions;\r\n\t\r\n\t//clearTimeout(timeouts.movetimeout); timeouts.movetimeout=null;\r\n\tctx.clearRect(0, 0, dimensions.width, dimensions.height);\r\n\t\r\n\tdraw_floor(ctx, radius)\t\r\n\t\r\n\t/*var handheight\r\n\tif(dimensions.units===\"ft\")\r\n\t{ handheight=4 }\r\n\telse\r\n\t{ handheight=1.219 }*/\r\n\t\r\n\tif(silhouette!=null)\r\n\t{ draw_silhouette(ctx, silhouette, minmaxes, dimensions, dimensions.defaultheight);  }\r\n\t\r\n\tif( startheight !== dimensions.defaultheight )\r\n\t{   canvas_arrow(ctx, startheight); \t}\r\n\t\r\n\tdraw_scale(ctx, radius, lastpoint)\r\n\t\r\n}\r\n\r\n//draw an arrow to the coin's starting position (if the position isn't default)\r\nfunction canvas_arrow(ctx, startheight) {\t //, fromx, fromy, tox, toy){\r\n    \r\n\t//var minmaxes = namesp.minmaxes;\r\n\tvar dimensions = namesp.dimensions;\r\n\t\r\n\tvar origin = new CanvasPoint( 0, 0) //floor where feet are\r\n\tvar start = new CanvasPoint( 0, startheight) //throw start\r\n\r\n\tvar fromx = origin.x \r\n\tvar fromy = origin.y \r\n\tvar tox = start.x \r\n\tvar toy = start.y  + 7 //+7 so it's not dwarfing the coin.\r\n\t\r\n\tvar headlen = 10;   // length of head in pixels\r\n    var angle = Math.atan2(toy-fromy,tox-fromx);\r\n\t\r\n\tvar pxheight = fromy - toy\r\n\tif(pxheight > 15)\r\n\t{\r\n\t\tctx.font = \"bold 14px Arial\";\r\n\t\tctx.beginPath()\r\n\t\tctx.strokeStyle=\"red\"\r\n\t\tctx.fillStyle=\"red\"\r\n\t\tctx.lineWidth=1.5\r\n\t\tctx.moveTo(fromx, fromy);\r\n\t\tctx.lineTo(tox, toy);\r\n\t\tctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/6),toy-headlen*Math.sin(angle-Math.PI/6));\r\n\t\tctx.moveTo(tox, toy);\r\n\t\tctx.lineTo(tox-headlen*Math.cos(angle+Math.PI/6),toy-headlen*Math.sin(angle+Math.PI/6));\r\n\r\n\t\tctx.fillText(round(startheight).toString() + \" \" + dimensions.units, fromx + 5, fromy - pxheight/2);\r\n\t\tctx.stroke()\r\n\t\t\r\n\t\tctx.strokeStyle=\"#000000\";\r\n\t\tctx.fillStyle=\"#000000\";\r\n\t\tctx.lineWidth=1;\r\n\t}\r\n}\r\n\r\n//Draw the person.\r\nfunction draw_silhouette(ctx, silhouette, minmaxes, dimensions, startheight)\r\n{\r\n\t//drawing is dimensions [323,831] (width, height).\r\n\t//Need the spot (24, 539) (from bottom) to cooincide\r\n\t\t//with *relative* coordinate (0,4), aligned to the canvas.\r\n\r\n\t//var footbuffer = 2\r\n\t\r\n\tvar origin = new CanvasPoint( 0, 0) //feet on floor\r\n\tvar px_startheight = minmaxes.pxperfoot * startheight\r\n\tvar numpixtotop = (px_startheight * 830/539)\r\n\tvar drawing_top = origin.y - numpixtotop\r\n\tvar px_width = numpixtotop * 323/831\r\n\tvar px_offset_left = px_width * 24/323\r\n\t\r\n\tvar drawing_left\r\n\tif(minmaxes.directionLeft)\r\n\t{\r\n\t\tdrawing_left = origin.x - px_offset_left\t\r\n\t\tdrawImage(ctx, silhouette, drawing_left , drawing_top , px_width, numpixtotop);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tdrawing_left = origin.x + px_offset_left\r\n\t\tdrawImage(ctx, silhouette, drawing_left -px_width, drawing_top , px_width, numpixtotop, 0, true);\r\n\t}\r\n}\r\n\r\n\r\nfunction drawImage(ctx, img, x, y, width, height, deg, flip, flop, center)\r\n{\r\n\tctx.save();\r\n\r\n\tif(typeof width === \"undefined\") width = img.width;\r\n\tif(typeof height === \"undefined\") height = img.height;\r\n\tif(typeof center === \"undefined\") center = false;\r\n\r\n\t// Set rotation point to center of image, instead of top/left\r\n\tif(center) {\r\n\t\tx -= width/2;\r\n\t\ty -= height/2;\r\n\t}\r\n\r\n\t// Set the origin to the center of the image\r\n\tctx.translate(x + width/2, y + height/2);\r\n\r\n\t// Rotate the canvas around the origin\r\n\tvar rad = 2 * Math.PI - deg * Math.PI / 180;    \r\n\tctx.rotate(rad);\r\n\r\n\tvar flipScale\r\n\tvar flopScale\r\n\t// Flip/flop the canvas\r\n\tif(flip) flipScale = -1; else flipScale = 1;\r\n\tif(flop) flopScale = -1; else flopScale = 1;\r\n\tctx.scale(flipScale, flopScale);\r\n\r\n\t// Draw the image    \r\n\tctx.drawImage(img, -width/2, -height/2, width, height);\r\n\r\n\tctx.restore();\r\n}\r\n\r\n//only runs when the canvaspoints need to be *changed*.\r\n//(when the model is changed, or percent speed is altered)\r\nfunction getCanvaspoints(relativepoints, time, percenttime) {\r\n\t\r\n\tvar canvaspoints = []\r\n\t\r\n\tvar i=0;\r\n\r\n\tfor(var inc=0; inc<relativepoints.length; inc+=1) //interval)\r\n\t{\r\n\t\ti=Math.ceil(inc)\r\n\t\tif(i>=relativepoints.length)\r\n\t\t{\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\t\r\n\t\tcanvaspoints.push(new CanvasPoint( relativepoints[i]))\r\n\t}\r\n\t\t\r\n\t//ensure the very last relativepoint gets used, to make it seamless with the floor.\r\n\tif(i!=relativepoints.length-1)\r\n\t{\r\n\t\tcanvaspoints.push(new CanvasPoint( relativepoints[relativepoints.length-1]))\r\n\t}\r\n\r\n\tnamesp.canvaspoints = canvaspoints\r\n\t\r\n\t//return { canvaspoints: canvaspoints, minmaxes: minmaxes,};  //set it in the global namespace for the draw functions.\r\n}\r\n\r\n\r\n\r\n//Generate a point object. \r\n//Calculate and store the location of the person and coin at t = time,\r\n//given the rotation rate and coin's slope.\r\n// Start with a coordinate system where (0,0) is the center of rotation\r\n// and (0, -radius) is where the person started.\r\n\r\n// Translate this to a new coordinate system where the moving person's feet\r\n// are at (0,0) wherever the person is. \r\n// Find the coin's distance relative to the person's feet oriented \"upward.\"\r\n// The important output variables are x_rel and y_rel. The math stays oriented\r\n// about the origin until that point.\r\nfunction RelativePoint( time, radius, omega, startheight, start_v_x, start_v_y)\r\n{\r\n\t\t//solve for the location of the person and the coin.\r\n\r\n\r\n\t\t//person's current angle on the unit circle (like most coordinate systems)\r\n\t\t// from 0 degrees at horizontal-right (angle horizontal-origin-person)\r\n\t\t//calculated by subtracting swept angle from 3PI/2 or 270 degrees (start).\r\n\tvar angle_hop = (3* Math.PI / 2) - (omega * time) \r\n\r\n\twhile(angle_hop > 2*Math.PI)\r\n\t{ angle_hop -= 2*Math.PI; } //if the person circles more than once, \r\n\t\t\t\t\t\t\t\t//then simplify this a little :-)\r\n\t\t\r\n\t\r\n\tvar x_person = radius * Math.cos(angle_hop)  //x from rotation origin\r\n\tvar y_person = radius * Math.sin(angle_hop)  //y from rotation origin\r\n\r\n\t\t//simple physics. At t=0, x=0 so this is easy.\r\n\tvar x_coin = start_v_x * time  \r\n\r\n\t\t//Doesn't start from zero. Usually starts from point (0,-21)\r\n\tvar y_coin = start_v_y * time - ( radius - startheight)\t\r\n\t\r\n\t\t\r\n\t//now translate it to a relative point\r\n\tvar x_diff = x_coin - x_person\t\t//difference is positive if the \r\n\tvar y_diff = y_coin - y_person\t\t//coin is up and to the right of person\r\n\t\r\n\t//distance from person's foot to coin\r\n\tvar persontoCoin = Math.sqrt( Math.pow( (y_diff), 2) + Math.pow( (x_diff), 2) )\r\n\t\r\n\t\r\n\t\t //angle coin-person-horizontalright (horizontal at person's feet)\r\n\t\t //with coordinate system about the center of rotation\r\n\t\t //and the person is still moving\r\n\tvar angle_cph\r\n\t\r\n\t//angle origin-person-horizontalright  (origin = center of rotation)\r\n\tvar angle_oph = Math.atan(y_person/x_person)\r\n\r\n\tvar angle_cpo //angle coin-person(feet/floor)-origin\r\n\tvar x_rel\r\n\tvar y_rel\r\n\t\r\n\t\r\n\tif(y_diff>0) //if the coin is currently above the person...\r\n\t{\t\t\r\n\t\t\t\t//(subtract 90deg - angle_vertical_person_coin\r\n\t\tangle_cph = (Math.PI /2) - Math.atan(x_diff / y_diff) \r\n\t\tangle_cpo = (angle_cph - angle_oph)\r\n\t\t\r\n\t\t\t//coin's distance from person tangent to floor\r\n\t\tx_rel = -1 * persontoCoin * Math.sin(angle_cpo)\r\n\t}\r\n\telse{   \t//the coin is below the person's feet\r\n\t\t\r\n\t\tif(x_diff>0)  //coin is below to the right (will be true in most cases)\r\n\t\t{\t\t\t  // (e.g. coin is less negative / less leftward)\r\n\t\t\t//coin-person-horizontalright. -1 b/c xdiff is pos and ydiff is neg,\r\n\t\t\t//so atan will give negative number, which we don't want.\r\n\t\t\tangle_cph = -1 * Math.atan(y_diff / x_diff)\r\n\t\t}\r\n\t\telse   //scenario where the coin is to the left of the person \r\n\t\t\t//but \"below\" them (person has looped halfway around/is on top?)\r\n\t\t{\t\r\n\t\t\t\t//coin-person-verticaldown + 90deg = coin-person-horiz.right\r\n\t\t\t\t//xdiff is neg and ydiff is neg, atan gives positive number\r\n\t\t\tangle_cph = Math.atan(x_diff / y_diff) + (Math.PI / 2)\r\n\t\t}   \t//note, if person is on top, their angle_oph will be neg\r\n\t\t\t\t//because x_person is neg and y_diff is pos \r\n\t\t\t\t//so the next step will be a subtraction\r\n\t\t\r\n\t\tangle_cpo = (angle_cph + angle_oph)\r\n\t\t\t\t//is actually a subtraction if the person is in quadrant 2\r\n\t\t\t\t//because oph will be negative due to atan(neg)\r\n\t\t\r\n\t\tx_rel = persontoCoin * Math.sin(angle_cpo)\r\n\r\n\t}\r\n\t\r\n\t\r\n\t//height above person relative to line from person to origin.\r\n\ty_rel = persontoCoin * Math.cos(angle_cpo)\r\n\t\r\n\t//rare case if the person traverses an entire half-arc (in quadrant 1 or 4)\r\n\t//you have to be really playing with the model to get this\r\n\tif(x_person>0)\r\n\t{\r\n\t\tx_rel = x_rel*-1\r\n\t\ty_rel = y_rel*-1\r\n\t}\r\n\t\t\r\n\tthis.persontoCoin = persontoCoin\r\n\tthis.x = x_rel\r\n\tthis.y = y_rel\r\n\tthis.time = time\r\n\t//this.x_diff = x_diff\r\n\t//this.y_diff = y_diff\r\n\t//this.angle_cph = angle_cph\r\n\t//this.angle_oph = angle_oph\r\n\t//this.angle_cpo = angle_cpo\r\n}\r\n\r\n\r\n//Generate point coordinates with respect to the canvas\r\n//where (0,0) is the top-left of the drawing area.\r\n//Adjust for all of my buffers/shifts and adjustments (1px does not equal 1 foot!)\r\nfunction CanvasPoint( x, y) {\r\n\t//canvasPoint can accept either X and Y coordinates or a RelativePoint.\r\n\t\r\n\tvar minmaxes = namesp.minmaxes;\r\n\tvar dimensions = namesp.dimensions;\r\n\t\r\n\tif(!(typeof x==\"number\"))\r\n\t{ /*dimensions = y;*/ y = x.y; x=x.x; }\r\n\t\r\n\t//Place the smallest x value on path to be drawn all the way to the left.\r\n\t//Then divide by range, and multiply by canvas size (so adjusted to canvas)\r\n\t//Then add the X_BUFFER to buffer a bit of space from left side\r\n\t//the offsetX centers the drawing on the page when tall and skinny\r\n\t//(otherwise, despite all the buffers it will be smashed to the left)\r\n\t\r\n\tvar canvasX = ((((x - minmaxes.minX) / minmaxes.range) * minmaxes.canvasSize) + minmaxes.offsetX) + dimensions.X_BUFFER\r\n\tvar canvasY = dimensions.DRAWING_HEIGHT - (( y / minmaxes.range ) * minmaxes.canvasSize ) + dimensions.Y_BUFFER\r\n\t\r\n\tthis.x = canvasX;\r\n\tthis.y = canvasY;\r\n}\r\n\r\n//calculate the min and max values for the displayed canvas.\r\nfunction minmax(pointlist, dimensions) {\r\n\t\r\n\t//Ensure, that if these max values are not reached, that\r\n\t//these are set to the maxes (otherwise it will find a greater value)\r\n\tvar minX=pointlist[0].x  //a good starting value is the first one in the list.\r\n\r\n\tvar maxX=pointlist[0].x \r\n\tvar maxY\r\n\tif(dimensions.units==\"ft\")\r\n\t{\tif(pointlist[0].x < 1)\r\n\t\t{ maxX = 1 }\r\n\r\n\t\tmaxY=6 \t\r\n\t}\r\n\telse\r\n\t{\tif(pointlist[0].x < 1)\r\n\t\t{ maxX = 0.3048 }\r\n\r\n\t\tmaxY = 1.829  //meters \r\n\t}\r\n\r\n\r\n\r\n\tvar minY=0 //definitely need to show the original floor. Include y=0 in the range!\r\n\r\n\t//the coin toss assumes a 6-ft person :-)\r\n\t//I'd ideally like to put that person into the window.\r\n\t\r\n\t//Iterate through the given point list to find the min and max values\r\n\t//(assuming it supercedes the values I initialized above)\r\n\tfor(var i=0; i<pointlist.length; i++)\r\n\t{\r\n\t\tif(pointlist[i].x < minX)\r\n\t\t{ minX = pointlist[i].x }\r\n\r\n\t\tif(pointlist[i].x > maxX)\r\n\t\t{ maxX = pointlist[i].x }\r\n\r\n\t\tif(pointlist[i].y < minY)\r\n\t\t{ minY = pointlist[i].y }\r\n\r\n\t\tif(pointlist[i].y > maxY)\r\n\t\t{ maxY = pointlist[i].y }\r\n\t}\r\n\t\r\n\tvar rangeX = Math.abs(maxX - minX)\r\n\tvar rangeY = Math.abs(maxY - minY)\r\n\tvar range\r\n\tif(rangeX > rangeY)\r\n\t{ range = rangeX }\r\n\telse\r\n\t{ range = rangeY }\r\n\t\r\n\t//Ensures the scale stays proportional if height/width are adjusted differently.\r\n\tvar canvasSize\r\n\tif(dimensions.DRAWING_WIDTH/dimensions.DRAWING_HEIGHT < rangeX/rangeY)\r\n\t{\tcanvasSize = dimensions.DRAWING_WIDTH \t}\r\n\telse\r\n\t{ \tcanvasSize = dimensions.DRAWING_HEIGHT  }\r\n\t\r\n\t\r\n\tvar offsetX = (dimensions.DRAWING_WIDTH - (rangeX / range) * canvasSize) / 2\r\n\r\n\t/*\r\n\t//(counteract the side menu somewhat)\r\n\tif(dimensions.menuRightOpen && dimensions.menuLeftOpen)\r\n\t{\t\t\t} //do nothing\r\n\telse if(dimensions.menuLeftOpen && dimensions.width < 900 && rangeY/rangeX<=10)\r\n\t{\t\toffsetX *= 2;  \t}  //offsetX *= (7/4);\r\n\telse if(dimensions.menuRightOpen && dimensions.width < 900 && rangeY/rangeX<=10)\r\n\t{\t\toffsetX = 0;  \t}  //offsetX *= (1/4);\r\n\telse if(dimensions.menuLeftOpen && dimensions.width < 900 && rangeY/rangeX > 10)\r\n\t{\t\toffsetX *= (7/4);\t}\r\n\telse if(dimensions.menuRightOpen && dimensions.width < 900 && rangeY/rangeX > 10)\r\n\t{\t\toffsetX *= (1/4);\t}\r\n\telse if(dimensions.menuLeftOpen && dimensions.width >= 900)\r\n\t{\t\toffsetX *= (3/2); \t}\r\n\telse if(dimensions.menuRightOpen && dimensions.width >= 900)\r\n\t{\t\toffsetX *= (1/2); \t}\r\n\t*/\r\n\t\r\n\t//used to know which way the silhouette should face :-).\r\n\t//DIFFERENT than the directionleft in crunch numbers...\r\n\tvar directionLeft=true; //true means silhouette is facing left\r\n\tif(pointlist.length>10) //sometimes it is only one point. Don't want it to crash.\r\n\t{ \t\r\n\t\tvar point_difference=pointlist[10].x-pointlist[0].x\r\n\t\tif( point_difference > 1e-4)  //either very small or positive (to the right)\r\n\t\t{ directionLeft=false; }\r\n\t}\r\n\t\r\n\tvar minmaxes = { minX: minX,\r\n\t\t\t\t maxX: maxX,\r\n\t\t\t\t minY: minY,\r\n\t\t\t\t maxY: maxY,\r\n\t\t\t\t range: range, //only one variable for range, to keep x proportional with y.\r\n\t\t\t\t canvasSize: canvasSize,\r\n\t\t\t \t pxperfoot: canvasSize / range,\r\n\t\t\t\t directionLeft: directionLeft,\r\n\t\t\t\t offsetX: offsetX,\r\n\t\t\t\t rangeX: rangeX,\r\n\t\t\t\t rangeY: rangeY,\r\n\t}\r\n\r\n\treturn minmaxes\r\n\t\r\n\r\n}\r\n\r\n\r\n\r\n//Custom circle-drawing function to render the station floor.\r\n\r\n//depending on the parameters, the station could be HUGE, or very small.\r\n\t//If it's huge, I don't want to render the entire floor. Too big!\r\n\t//If it's small, I DO want to render the entire floor.\r\n\t\r\n//I felt that it would be easier to keep it proportional by doing this\r\n\t\t//together with my canvaspoint()'s,\r\n//rather than simply using the context.arc() function.\r\nfunction draw_floor(ctx, radius)\r\n{\r\n\tvar minmaxes = namesp.minmaxes;\r\n\tvar dimensions = namesp.dimensions;\r\n\t\r\n\tconst floor_color = \"#007acc\"\r\n\tconst floor_width = 6\r\n\t//const space_color = \"#9e9e9e\"\r\n\tconst station_color = \"white\"\r\n\r\n\tctx.lineWidth=floor_width;\r\n\tctx.strokeStyle=floor_color;\r\n\tctx.fillStyle=station_color;\r\n\t\r\n\t\r\n\tvar factor = 2\r\n\tif(dimensions.DRAWING_WIDTH/dimensions.DRAWING_HEIGHT > (minmaxes.rangeX/minmaxes.rangeY) / 4)\r\n\t{\tfactor=5  }  //if the canvas is four times wider than the proportions of the throw\r\n\t\r\n\tvar toconvert = factor * minmaxes.range / radius\r\n\tvar values\r\n\t\r\n\t//Double-check here that I'm using valid values for the arc-cosine.\r\n\tvar floor_start\r\n\tvar floor_end\r\n\tif(toconvert < 1)\r\n\t{\r\n\t\tfloor_start = Math.acos( toconvert )\r\n\t\tfloor_end = Math.acos( -1 * toconvert )\r\n\t}\r\n\telse{\r\n\t\tfloor_start = 0\r\n\t\tfloor_end = Math.PI\r\n\t}\r\n\t\r\n\t\r\n\tvar arc = floor_end - floor_start\r\n\r\n\tvar x\r\n\tvar y\r\n\tvar i\r\n\tvar bottomcurve = [] //points for bottom half of circle\r\n\t\r\n\t//remember canvaspoint wants the distance from the person's feet.\r\n\t//And I'm only feeding in angles from 0 to PI, which is why the -1 on y\r\n\tfor(i=floor_start; i<floor_end; i+=arc/100)\r\n\t{\t\r\n\t\tx = radius * Math.cos(i)\r\n\t\ty = -1 * radius * Math.sin(i) + radius //-1, bottom arc!\r\n\t\tvalues = new CanvasPoint( x, y)\r\n\t\tbottomcurve.push(values)\r\n\t}\r\n\r\n\t//once more AT floor_end, so there won't be a break if I render the top.\r\n\tx = radius * Math.cos(floor_end)\r\n\ty = -1 * radius * Math.sin(floor_end) + radius //-1, bottom arc!\r\n\tvalues = new CanvasPoint( x, y)\r\n\tbottomcurve.push(values)\r\n\r\n\r\n\t//if the top of the station is close to actually appearing, then render it.\r\n\tx=radius*Math.cos(0)\r\n\ty=radius*Math.sin(0) + radius\r\n\tvalues = new CanvasPoint( x, y)\r\n\tif(values.y>-50)\r\n\t{\r\n\t\t//generate points for top curve\r\n\t\tvar topcurve = []\r\n\t\tfor(i=floor_end; i>floor_start; i-=arc/100) //the reverse direction!\r\n\t\t{\t\r\n\t\t\tx = radius * Math.cos(i)\r\n\t\t\ty = radius * Math.sin(i) + radius //+1, top arc!\r\n\t\t\tvalues = new CanvasPoint( x, y)\r\n\t\t\ttopcurve.push(values)\r\n\t\t}\r\n\t\t\r\n\t\t//START by filling outer-space around the curve!\r\n\t\tctx.beginPath()\r\n\r\n\t\tctx.moveTo(bottomcurve[0].x, bottomcurve[0].y)\r\n\t\t\r\n\t\tfor(i=1; i<bottomcurve.length; i+=1)\r\n\t\t{\r\n\t\t\tctx.lineTo(bottomcurve[i].x, bottomcurve[i].y)\r\n\t\t}\r\n\t\t\r\n\t\t//ctx.moveTo(topcurve[0].x, topcurve[0].y)\r\n\t\t\r\n\t\tfor(i=0; i<topcurve.length; i+=1)\r\n\t\t{\r\n\t\t\tctx.lineTo(topcurve[i].x, topcurve[i].y)\r\n\t\t}\r\n\r\n\t\tctx.closePath()\r\n\t\tctx.fill()\r\n\t\tctx.stroke()\r\n\t}\r\n\telse //no top curve\r\n\t{\r\n\t\t//START by filling outer-space around the curve!\r\n\t\tctx.beginPath()\r\n\t\tctx.moveTo(bottomcurve[0].x, bottomcurve[0].y)\r\n\t\t\r\n\t\tfor(i=1; i<bottomcurve.length; i+=1)\r\n\t\t{\r\n\t\t\tctx.lineTo(bottomcurve[i].x, bottomcurve[i].y)\r\n\t\t}\r\n\t\t\r\n\t\ti-=1; //set i=last element to make this less tedious\r\n\t\tif(bottomcurve.length>0)\r\n\t\t{\r\n\t\t\t//create a box around the top of the screen.\r\n\t\t\tctx.lineTo(-1 * floor_width, -1 * floor_width);\r\n\t\t\tctx.lineTo(dimensions.width+floor_width, -1 * floor_width);\r\n\t\t\tctx.closePath()\r\n\t\t\tctx.fillStyle=station_color;\r\n\t\t\tctx.fill()\r\n\t\t}\r\n\t\t\r\n\t\tctx.stroke()\r\n\t\t\r\n\t}\r\n\t\r\n\r\n\t//reset the stroke\r\n\tctx.lineWidth=1;\t\r\n\tctx.strokeStyle=\"#000000\";\r\n\tctx.fillStyle=\"#000000\";\r\n}\r\n\r\n\r\nexport default CanvasSpace;\r\n\r\n","import React, { Component } from 'react';\r\nimport './App.css';\r\n//import ReactDOM from 'react-dom'\r\n\r\n\r\nclass AngleInput extends Component {\r\n\t\r\n\tconstructor(props) {\r\n      super(props);\r\n\t\t\r\n\t  this.compassRef = React.createRef();\r\n      this.state = { focused:false, compassSize: 30 }\r\n\t  this.onFocus = this.onFocus.bind(this);\r\n\t  this.onBlur = this.onBlur.bind(this);\r\n\t  this.handleOutput = this.handleOutput.bind(this);\r\n\t}\r\n\t\r\n\tonFocus() { this.setState({focused:true,})\t}\r\n\r\n\t//onBlur() { this.setState({focused:false,})\t}\r\n\tonBlur(e) { this.setState({focused:false,}); this.props.updateState(e)\t}\r\n\t\r\n\tshouldComponentUpdate(newProps, newState)\r\n\t{\r\n\t\t//If the only change was focusing the field, no point in updating unless the value is zero.\r\n\t\t//(blanks the line)\r\n\t\tif( (newState.focused===true && this.state.focused===false && this.props.value !==0) ||\r\n\t\t\t(newState.focused===false && this.state.focused===true && this.props.value !==0) )\r\n\t\t\t{  //console.log(\"false\")\r\n\t\t\t\treturn false  }\r\n\t\telse if( this.props.value===newProps.value\r\n\t\t\t\t&& this.state.focused===newState.focused\r\n\t\t\t\t&& this.props.min===newProps.min\r\n\t\t\t\t&& this.props.max===newProps.max\r\n\t\t\t\t&& this.props.display===newProps.display\r\n\t\t\t\t&& this.props.units===newProps.units)\r\n\t\t\t{  //console.log(\"nothing changed\")\r\n\t\t\t\treturn false  }\r\n\t\telse\r\n\t\t{  //console.log(\"true\")\r\n\t\t\treturn true   }\r\n\t}\r\n\t\r\n\t\r\n\tcomponentDidMount()\r\n\t{ this.componentDidUpdate(); }\r\n\t\r\n\tcomponentDidUpdate()\r\n\t{\r\n\t\tvar compassSize = this.state.compassSize\r\n\t\tlet canvas = this.compassRef.current;\r\n\t\t//let canvas = ReactDOM.findDOMNode(this.compassRef.current);\r\n\t\tlet ctx = canvas.getContext('2d');\r\n\t\t\r\n\t\tctx.clearRect(0, 0, compassSize, compassSize);\r\n\t\t\r\n\t\tctx.beginPath();\r\n\t\tctx.strokeStyle=\"#000000\";\t\r\n\t\tctx.arc(compassSize/2, compassSize/2, compassSize/2, 0, 2 * Math.PI, false);\r\n\t\t\r\n\t\tvar computedangle = (this.props.value * Math.PI / 180);\r\n\t\tvar x = compassSize/2 * Math.sin(computedangle)\r\n\t\tvar y = compassSize/2 * Math.cos(computedangle)\r\n\t\t\r\n\t\tctx.moveTo(compassSize/2,compassSize/2)\r\n\t\tctx.lineTo(compassSize/2-x, compassSize/2+y)\r\n\t\tctx.stroke();\r\n\r\n\t\tctx.lineWidth=2\t\t\r\n\t\tctx.beginPath();\r\n\t\tctx.strokeStyle=\"#e02e0b\";\r\n\t\tctx.moveTo(compassSize/2,compassSize/2)\r\n\t\tctx.lineTo(compassSize/2+x, compassSize/2-y)\r\n\t\tctx.stroke();\t\t\r\n\t}\r\n\t\r\n\thandleOutput(e) {\r\n\t\t\r\n\t\tvar value = Number(e.target.value)\r\n\r\n\t\t//sticky numbers, so you can get to the defaults more easily\r\n\t\t\t//(Only do this for the slider.)\r\n\t\tif(e.target.type===\"range\" && Math.abs(value-this.props.default) < 5)\r\n\t\t{ value = this.props.default; }\r\n\t\t\r\n\t\tthis.props.updateState(value, this.props.variable)\r\n\t}\r\n\r\n\t\r\n\trender() {\r\n\t\r\n\tvar UnitsStyle\r\n\tif(this.props.units!=null)\r\n\t{\tUnitsStyle={ width:\"15px\", }\t}\r\n\telse\r\n\t{\tUnitsStyle={ display:\"none\", }  }\r\n\t\r\n\tconst compassStyle= {\r\n\t\tmarginLeft:\"0px\",\r\n\t\tmarginTop:\"1px\",\r\n\t\tbackgroundColor:\"white\",\r\n\t\tborderRadius:'50%',\r\n\t\tpadding:'1px',\r\n\t}\r\n\r\n\tvar value=this.props.value;\r\n\tif(this.props.value===0 && this.state.focused)  //otherwise you are never able to backspace entirely. Frustrating.\r\n\t{  value=\"\";  }\r\n\r\n\t\r\n\tconst spanstyle={\r\n\t\tfontSize:'14px',\r\n\t\tcolor:'#adccff',\r\n\t\t//width:'155px',\r\n\t\ttextAlign:'center',\r\n\t}\r\n\t\r\n\tconst blurbwidth={\r\n\t\t//width:'220px',\r\n\t}\r\n\t\r\n\tvar simplified=\"\"\r\n\tvar simplified2=\"\"\r\n\tvar plural=\"s\"\r\n\t\r\n\tif(this.props.droppedflag)\r\n\t{  simplified=\"(dropped)\" }\r\n\telse if(this.props.value===0)\r\n\t{  simplified=\"(thrown straight up)\"\t}\r\n\telse if(this.props.value===90)\r\n\t{  simplified=\"(thrown straight right\"\r\n\t   simplified2=\"or “opposite” the station)\" }\r\n\telse if(this.props.value===-90)\r\n\t{  simplified=\"(thrown straight left\"\r\n\t   simplified2=\"or “with” the station)\" }\r\n\telse if(Math.abs(this.props.value)===180)\r\n\t{  simplified=\"(thrown straight down)\" }\r\n\telse if(this.props.value > 0 && this.props.value < 45)\r\n\t{  if(this.props.value===1){plural=\"\"}\r\n\t   simplified=\"(thrown \" + this.props.value.toString() + \" degree\" + plural +\" to the right)\" }\r\n\telse if(this.props.value < 0 && this.props.value > -45)\r\n\t{  if(this.props.value===-1){plural=\"\"}\r\n\t   simplified=\"(thrown \" + Math.abs(this.props.value).toString() + \" degree\" + plural +\" to the left)\" }\r\n\telse if(this.props.value > 90)\r\n\t{  if(this.props.value===91){plural=\"\"}\r\n\t   simplified=\"(thrown \" + (this.props.value-90).toString() + \" degree\" + plural +\" “down”,\" \r\n\t   simplified2=\"to the right or “opposite” the station)\" }\r\n\telse if(this.props.value < -90)\r\n\t{  if(this.props.value===-91){plural=\"\"}\r\n\t   simplified=\"(thrown \" + ((-1*this.props.value)-90).toString() + \" degree\" + plural +\" “down”,\" \r\n\t   simplified2=\"to the left or “with” the station)\" }\r\n\telse if(this.props.value >= 45 && this.props.value < 90)\r\n\t{  if(this.props.value===89){plural=\"\"}\r\n\t   simplified=\"(thrown \" + (90-this.props.value).toString() + \" degree\" + plural +\" “up”,\"\r\n\t   simplified2=\"to the right or “opposite” the station)\" }\r\n\telse if(this.props.value <= -45 && this.props.value > -90)\r\n\t{  if(this.props.value===-89){plural=\"\"}\r\n\t   simplified=\"(thrown \" + (90-(-1*this.props.value)).toString() + \" degree\" + plural +\" “up”,\"\r\n\t   simplified2=\"to the left or “with” the station)\" }\r\n\t/*else if(Math.abs(this.props.value) > 90)\r\n\t{ simplified=\"(thrown \" + (Math.abs(this.props.value)-90).toString() + \" degrees “down”)\" }*/\r\n\t/*else if(Math.abs(this.props.value) >= 80 && Math.abs(this.props.value) < 90)\r\n\t{ simplified=\"(thrown \" + (90-Math.abs(this.props.value)).toString() + \" degrees “up”)\"}*/\r\n\t\r\n\tconst leftstyle = { float:'left' }\r\n\tconst rightstyle = { float:'right' }\r\n\tconst small = { fontSize:'0.85em' }\r\n\r\n\treturn(\r\n\t\t\t<div>\r\n\t\t\t<table className=\"InputBox\" style={small}><tbody>\r\n\t\t\t\t<tr><td>{this.props.title}</td>\r\n\t\t\t\t\t<td><div className=\"range\"><div style={leftstyle}>{this.props.min}</div><div style={rightstyle}>{this.props.max}</div></div></td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<table style={{marginBottom:'-5px', marginTop:'-5px'}}><tbody><tr><td><canvas ref={this.compassRef} style={compassStyle} width={this.state.compassSize.toString()} height={this.state.compassSize.toString()} /></td>\r\n\t\t\t\t\t\t\t<td><input type='number' className=\"InputStyle\" onFocus={this.onFocus} onBlur={this.onBlur} value={value} step=\"any\" min={this.props.min} max={this.props.max} onChange={this.handleOutput} style={{width:'50px'}}/><div className=\"UnitsStyle\" style={UnitsStyle}>{this.props.units}</div>\r\n\t\t\t\t\t\t\t</td></tr></tbody></table>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td><input type='range' className=\"slider\" min={this.props.min} max={this.props.max} step={1} value={this.props.value} onChange = {this.handleOutput} /></td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody></table>\r\n\t\t\t<div style={blurbwidth}><div style={spanstyle}>{simplified}<br/>{simplified2}</div></div></div>\r\n\t  );\r\n\t}\r\n}\r\n\r\nexport default AngleInput;\r\n\r\n\r\n\r\n\r\n","import React, { Component } from 'react';\r\nimport './App.css';\r\n//import ReactDOM from 'react-dom'\r\n\r\nclass InputField extends Component {\r\n\t\r\n\tconstructor(props) {\r\n      super(props);\r\n\t\r\n      this.state = { focused:false,\r\n\t\t\t\t\t minSlider:0,  //minpos\r\n\t\t\t\t\t maxSlider:1, //maxpos\r\n\t\t\t\t\t offset:4,\r\n\t\t\t\t\t}\r\n\t  this.onFocus = this.onFocus.bind(this);\r\n\t  this.onBlur = this.onBlur.bind(this);\r\n\t  this.handleSlider = this.handleSlider.bind(this);\r\n\t  this.handleOutput = this.handleOutput.bind(this);\r\n\t  //this.checkKeyPressed = this.handleOutput.bind(this); //for Edge browser. Boo.\r\n    }\r\n\t\r\n\t/*componentDidMount() {\r\n\t\tdocument.addEventListener(\"keydown\", this.checkKeyPressed, false);\r\n   }\r\n\r\n\tcheckKeyPressed(e) {\r\n\t\tif(this.state.focused===true)\r\n\t\t{\r\n\t\t\tvar x = e.which || e.keyCode;\r\n\t\t\tif(x===38 || x===40)\r\n\t\t\t{\r\n\t\t\t\tReactDOM.findDOMNode(this.props.variable).onchange()   //ref={this.props.variable} \r\n\t\t\t\t//this.fireEvent(\"onchange\");\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {}\r\n\t}*/\r\n\t\r\n\tonFocus() { this.setState({focused:true,})\t}\r\n\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t//for the sake of Edge browser\r\n\tonBlur(e) { this.setState({focused:false,}); this.handleOutput(e)\t}\r\n\t\r\n\tshouldComponentUpdate(newProps, newState)\r\n\t{\r\n\t\t//If the only change was focusing the field, no point in updating unless the value is zero.\r\n\t\t//(blanks the line)\r\n\t\tif( (newState.focused===true && this.state.focused===false && this.props.value !==0) ||\r\n\t\t\t(newState.focused===false && this.state.focused===true && this.props.value !==0) )\r\n\t\t\t{  //console.log(\"false\")\r\n\t\t\t\treturn false  }\r\n\t\telse if( this.props.value===newProps.value\r\n\t\t\t\t&& this.state.focused===newState.focused\r\n\t\t\t\t&& this.props.min===newProps.min\r\n\t\t\t\t&& this.props.max===newProps.max\r\n\t\t\t\t&& this.props.display===newProps.display\r\n\t\t\t\t&& this.props.units===newProps.units)\r\n\t\t\t{  //console.log(\"nothing changed\")\r\n\t\t\t\treturn false  }\r\n\t\telse\r\n\t\t{  //console.log(\"true\")\r\n\t\t\treturn true   }\r\n\t}\r\n\t\r\n\thandleOutput(e) {\t//this function handles the number input\r\n\t\r\n\t\tvar actualValue = Number(e.target.value)\r\n\t\tthis.props.updateState(actualValue, this.props.variable)\r\n\t}\r\n\t\r\n\thandleSlider(e) {\r\n\t\t\r\n\t\tvar sliderValue = Number(e.target.value)\r\n\r\n\t\tvar offsetMin = this.props.min + this.state.offset\r\n\t\tvar offsetMax = this.props.max + this.state.offset\r\n\t\t//var offsetValue = actualValue + this.state.offset\r\n\t\tvar scale = (Math.log(offsetMax) - Math.log(offsetMin))/(this.state.maxSlider - this.state.minSlider)\r\n\t\t\r\n\t\t\r\n\t\t//return Math.exp((position - this.minpos) * this.scale + this.minlval);\r\n\r\n\t\tvar actualValue = round(Math.exp((sliderValue - this.state.minSlider) * scale + Math.log(offsetMin) ) - this.state.offset)\r\n\t\t\r\n\t\tif(actualValue > this.props.max)\r\n\t\t{\tactualValue = this.props.max  }\r\n\t\tif(actualValue < this.props.min)\r\n\t\t{\tactualValue = this.props.min  }\r\n\r\n\t\t//sticky numbers, so you can get to defaults more easily\r\n\t\tif(Math.abs(actualValue - this.props.default) < (this.props.default/6))\r\n\t\t{  actualValue = this.props.default }\r\n\r\n\t\r\n\t\tthis.props.updateState(actualValue, this.props.variable)\r\n\t}\r\n\t\r\n  render() {\r\n\t\r\n\tvar className\r\n\tif(this.props.display===false)\r\n\t{\r\n\t\tclassName=\"hide\";\r\n\t}\r\n\telse\r\n\t{\r\n\t\tclassName=\"InputBox\";\r\n\t}\r\n\t\r\n\tvar UnitsStyle\r\n\tif(this.props.units!=null)\r\n\t{\r\n\t\tUnitsStyle={}\r\n\t}\r\n\telse\r\n\t{\r\n\t\tUnitsStyle={\r\n\t\t\tdisplay:\"none\",\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\tvar offsetMin = this.props.min + this.state.offset\r\n\tvar offsetMax = this.props.max + this.state.offset\r\n\tvar offsetValue = this.props.value + this.state.offset\r\n\tvar scale = (Math.log(offsetMax) - Math.log(offsetMin))/(this.state.maxSlider - this.state.minSlider)\r\n\t\r\n\t//to slider\r\n\t//return this.minpos + (Math.log(value) - this.minlval) / this.scale;\r\n\tvar sliderValue = this.state.minSlider + (Math.log(offsetValue) - Math.log(offsetMin) ) / scale\r\n\r\n\t\r\n\tvar value=this.props.value; //round(this.props.value, 3);\r\n\t\r\n\tif(this.props.value===0 && this.state.focused)  //otherwise you are never able to backspace entirely. Frustrating.\r\n\t{  value=\"\";  }\r\n\t\r\n\tvar sliderclass\r\n\tvar rangeclass\r\n\tvar rangemin\r\n\tvar rangemax\r\n\tconst leftstyle = { float:'left' }\r\n\tconst rightstyle = { float:'right' }\r\n\tconst midstyle = { paddingLeft:'10px', color:'#ffadad', display:'inline-block', }\r\n\t\r\n\tvar bignumber = \"\"\r\n\tif(this.props.value > 9999)\r\n\t{ bignumber = this.props.value.toExponential(0).replace(\"e+\",\"x10^\") }\t\r\n\t\r\n\tif(Number(this.props.min)>=0 && Number(this.props.max) > 1)\r\n\t{ sliderclass=\"slider\"\r\n\t  rangeclass=\"range\"\r\n\t  rangemin=this.props.min.toString()\r\n\t  \r\n\t  if(this.props.max > 9999)\r\n\t  { \r\n\t\trangemax=this.props.max.toExponential(1)\r\n\t\trangemax = rangemax.replace(\"e+\",\" x 10^\")\t}\r\n\t  else\r\n\t  { rangemax=round(this.props.max).toString() }\r\n\t}\r\n\telse\r\n\t{ sliderclass=\"hide\" \r\n\t  rangeclass=\"hide\" }\r\n\t\r\n\treturn(\r\n\t\t<table className={className}><tbody>\r\n\t\t  <tr><td>{this.props.title}</td>\r\n\t\t\t  <td><div className={rangeclass}><div style={leftstyle}>{rangemin}</div><div style={midstyle}>{bignumber}</div><div style={rightstyle}>{rangemax}</div></div></td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td>\r\n\t\t\t\t<input type='number' onFocus={this.onFocus} onBlur={this.onBlur} className=\"InputStyle\" value={value} step=\"any\" min={this.props.min} max={this.props.max} onChange={this.handleOutput} id={this.props.variable}/><div className=\"UnitsStyle\" style={UnitsStyle}>{this.props.units}</div>\r\n\t\t\t</td>\r\n\t\t\t<td><input type='range' step={.01} className={sliderclass} min={0} max={1} value={sliderValue} onChange={this.handleSlider}/>\r\n\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t\t\t\t\r\n\t\t</tbody></table>\r\n\t  );\r\n\r\n  }\r\n}\r\n\r\n/*\r\nfunction exp10( x )\r\n{\treturn Math.pow(10, x);   }// 10^x\r\n*/\r\n\r\n//rounds to three significant figures.\r\nfunction round(num, places) {\r\n\tif(num===0)\r\n\t{ return 0 }\r\n\t\r\n    if(places==null && num > 1)\r\n\t{\r\n\t\tvar order = Math.floor(Math.log(num) / Math.LN10\r\n                       + 0.000000001); // because float math sucks like that\r\n\t\tplaces = (order * -1) + 2\r\n\t}\r\n\telse if(places==null)\r\n\t{ places = 2 }\r\n\t\r\n\tvar multiplier = Math.pow(10, places);\r\n    var output = Math.round(num * multiplier) / multiplier;\r\n\t\r\n\t//fix some weird output. Probably due to feet/meters conversion not being more precise.\r\n\tif(Math.abs(output - Math.round(output)) <= .0011)\r\n\t{ output = Math.round(output); }\r\n\r\n\treturn output;\t\r\n}\r\n\r\n\r\n\r\n\r\nexport default InputField;\r\n\r\n\r\n\r\n\r\n\r\n\r\n//not used. Just an example.\r\n/*\r\nfunction LogSlider(options) {\r\n   options = options || {};\r\n   this.minpos = options.minpos || 0;\r\n   this.maxpos = options.maxpos || 100;\r\n   this.minlval = Math.log(options.minval || 1);\r\n   this.maxlval = Math.log(options.maxval || 100000);\r\n\r\n   this.scale = (this.maxlval - this.minlval) / (this.maxpos - this.minpos);\r\n}\r\n\r\nLogSlider.prototype = {\r\n   // Calculate value from a slider position\r\n   value: function(position) {\r\n      return Math.exp((position - this.minpos) * this.scale + this.minlval);\r\n   },\r\n   // Calculate slider position from a value\r\n   position: function(value) {\r\n      return this.minpos + (Math.log(value) - this.minlval) / this.scale;\r\n   }\r\n};\r\n*/\r\n","import React, { Component } from 'react';\r\nimport './App.css';\r\n//import ReactDOM from 'react-dom'\r\n\r\nclass PlayBack extends Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t  \r\n\t\tvar maxvalue = this.props.max\r\n\t\tif(maxvalue > 9999 ) { maxvalue = 9999; }\r\n\t\tthis.state = { \tminSlider:0,  //minpos\r\n\t\t\t\t\t\tmaxSlider:1, //maxpos\r\n\t\t\t\t\t\toffset:4,\r\n\t\t\t\t\t}\r\n\t\r\n\t\tthis.handleSlider = this.handleSlider.bind(this);\r\n    }\r\n\t\t\r\n\tshouldComponentUpdate(newProps, newState)\r\n\t{\r\n\t\tif( this.state.max===newProps.max\r\n\t\t\t\t&& this.props.value===newProps.value\r\n\t\t\t\t&& this.state.focused===newState.focused\r\n\t\t\t\t&& this.props.min===newProps.min\r\n\t\t\t\t&& this.props.display===newProps.display\r\n\t\t\t\t&& this.props.units===newProps.units)\r\n\t\t\t{  //console.log(\"nothing changed\")\r\n\t\t\t\treturn false  }\r\n\t\telse\r\n\t\t{  //console.log(\"true\")\r\n\t\t\treturn true   }\r\n\t}\r\n\t\t\r\n\t\r\n\thandleSlider(e) {\r\n\t\t\r\n\t\tvar max = this.props.max\r\n\t\tvar min = this.props.min\r\n\t\tif(max>9999) \r\n\t\t\t{ max = 9999; }\r\n\t\telse if(!isFinite(this.props.max))\r\n\t\t\t{ min=0; max = 0; }\r\n\t\t\r\n\t\tvar sliderValue = Number(e.target.value)\r\n\r\n\t\tvar offsetMin = min + this.state.offset\r\n\t\tvar offsetMax = max + this.state.offset\r\n\t\t//var offsetValue = actualValue + this.state.offset\r\n\t\tvar scale = (Math.log(offsetMax) - Math.log(offsetMin))/(this.state.maxSlider - this.state.minSlider)\r\n\t\t\r\n\t\t\r\n\t\t//return Math.exp((position - this.minpos) * this.scale + this.minlval);\r\n\r\n\t\tvar actualValue = round(Math.exp((sliderValue - this.state.minSlider) * scale + Math.log(offsetMin) ) - this.state.offset)\r\n\t\t\r\n\t\tif(actualValue > max)\r\n\t\t{\tactualValue = max  }\r\n\t\tif(actualValue < min)\r\n\t\t{\tactualValue = min  }\r\n\r\n\t\tif(Math.abs(actualValue - this.props.default) < (this.props.default/6))\r\n\t\t{  actualValue = this.props.default }\r\n\r\n\t\r\n\t\tthis.props.updateState(actualValue, this.props.variable)\r\n\t}\r\n\t\r\n\trender() {\t\r\n\t\t\r\n\t\tvar max = this.props.max\r\n\t\tvar min = this.props.min\r\n\t\tif(max>9999) \r\n\t\t\t{ max = 9999; }\r\n\t\telse if(!isFinite(this.props.max))\r\n\t\t\t{ min=0; max = 0; }\r\n\t\t\r\n\t\tvar offsetMin = min + this.state.offset\r\n\t\tvar offsetMax = max + this.state.offset\r\n\t\tvar offsetValue = this.props.value + this.state.offset\r\n\t\tvar scale = (Math.log(offsetMax) - Math.log(offsetMin))/(this.state.maxSlider - this.state.minSlider)\r\n\t\t\r\n\t\t//to slider\r\n\t\t//return this.minpos + (Math.log(value) - this.minlval) / this.scale;\r\n\t\tvar sliderValue = this.state.minSlider + (Math.log(offsetValue) - Math.log(offsetMin) ) / scale\r\n\t\t\r\n\t\tif(!isFinite(sliderValue)) { sliderValue = 0; }\r\n\t\t\r\n\t\tvar rangemin\r\n\t\tvar rangemax\r\n\t\t\r\n\t\tvar bignumber = this.props.value.toString()\r\n\t\t\r\n\t\trangemin=min.toString()\r\n\t\t\r\n\t\tif(max < 9999)\r\n\t\t{ rangemax=round(max).toString() }\r\n\t\telse\t//if it equals 9999 then just display that.\r\n\t\t{ rangemax= max.toString() }\r\n\r\n\t\treturn(\r\n\t\t<div id=\"playback\">\r\n\t\t\t<span style={{padding:'2px 0px 0px 2px', color:\"#098f5f\"}}>Playback speed&ensp;</span>\r\n\t\t\t<span style={{color:'#f44e42', padding:'2px', backgroundColor:'#a0c4ff', borderRadius:'2px'}}>{bignumber}%</span>\r\n\t\t\t<table><tbody>\r\n\t\t\t  <tr><td style={{fontSize:'0.85em'}}>{rangemin}</td>\r\n\t\t\t\t  <td><input type='range' className=\"slider\" style={{width:'100px'}} step={.01} min={0} max={1} value={sliderValue} onChange={this.handleSlider}/></td>\r\n\t\t\t\t  <td style={{fontSize:'0.85em',backgroundColor:'white',borderRadius:'3px'}}>{rangemax}</td>\r\n\t\t\t  </tr>\r\n\t\t\t</tbody></table>\r\n\t\t</div>\r\n\t\t  );\r\n\r\n\t}\r\n}\r\n\r\n/*\r\nfunction exp10( x )\r\n{\treturn Math.pow(10, x);   }// 10^x\r\n*/\r\n\r\n//rounds to three significant figures.\r\nfunction round(num, places) {\r\n\tif(num===0)\r\n\t{ return 0 }\r\n\t\r\n    if(places==null && num > 1)\r\n\t{\r\n\t\tvar order = Math.floor(Math.log(num) / Math.LN10\r\n                       + 0.000000001); // because float math sucks like that\r\n\t\tplaces = (order * -1) + 2\r\n\t}\r\n\telse if(places==null)\r\n\t{ places = 2 }\r\n\t\r\n\tvar multiplier = Math.pow(10, places);\r\n    var output = Math.round(num * multiplier) / multiplier;\r\n\t\r\n\t//fix some weird output. Probably due to feet/meters conversion not being more precise.\r\n\tif(Math.abs(output - Math.round(output)) <= .0011)\r\n\t{ output = Math.round(output); }\r\n\r\n\treturn output;\t\r\n}\r\n\r\n\r\n\r\n\r\nexport default PlayBack;\r\n\r\n\r\n\r\n\r\n\r\n\r\n//not used. Just an example.\r\n/*\r\nfunction LogSlider(options) {\r\n   options = options || {};\r\n   this.minpos = options.minpos || 0;\r\n   this.maxpos = options.maxpos || 100;\r\n   this.minlval = Math.log(options.minval || 1);\r\n   this.maxlval = Math.log(options.maxval || 100000);\r\n\r\n   this.scale = (this.maxlval - this.minlval) / (this.maxpos - this.minpos);\r\n}\r\n\r\nLogSlider.prototype = {\r\n   // Calculate value from a slider position\r\n   value: function(position) {\r\n      return Math.exp((position - this.minpos) * this.scale + this.minlval);\r\n   },\r\n   // Calculate slider position from a value\r\n   position: function(value) {\r\n      return this.minpos + (Math.log(value) - this.minlval) / this.scale;\r\n   }\r\n};\r\n*/\r\n","import React, { Component } from 'react';\r\n\r\nclass RadioConvertUnits extends Component {\r\n\t\r\n\trender(){\r\n\r\n\t\t\r\n\treturn (\r\n\t\t<form className=\"RadioBox\"><table><tbody>\r\n\t\t\r\n\t\t<tr>\r\n\t\t\t<td>\r\n\t\t\t\t<input type=\"radio\" name=\"units1\" value=\"ft\" onChange={this.props.onChange} checked={this.props.units === \"ft\"} /></td>\r\n\t\t\t\t<td>Imperial (feet)</td><td>&#160;&#160;</td>\r\n\t\t\r\n\t\t\t<td>\r\n\t\t\t<input type=\"radio\" name=\"units2\" value=\"m\"  onChange={this.props.onChange} checked={this.props.units === \"m\"} /></td>\r\n\t\t\t\t<td>Metric (meters)</td>\r\n\t\t</tr>\r\n\t\t\t\t\r\n\t\t</tbody></table></form>\r\n\t)}\r\n}\r\n\r\nexport default RadioConvertUnits;","/*eslint-disable eqeqeq*/\r\n\r\n//var Decimal = require('decimal.js');\r\n//import * as Decimal from 'decimal.js';\r\n\r\nimport {Decimal} from 'decimal.js';\r\n\r\nDecimal.set({ precision: 30 });\r\n\r\n\r\n//This JS file does the rest of the number crunching started by App.js,\r\n//using decimal.js to do more precise calculations.\r\n//Decimal.js requires that you multiply and divide, etc. with number.mul(), .div().\r\n//I have left the old, simpler-looking (but equivalent) equations in comments\r\n//so you can seee what's going on.\r\n//I should also note, that CanvasSpace.js does much of this calculation a second time\r\n//in getRelativePoints(). (though it's for a different purpose, and done differently)\r\n//The purpose of crunchnumbers() is mostly just to show the statistics on screen.\r\n\r\nvar PI = Decimal.acos(-1);\r\n\r\n//finds the coin's landing position on the circle, and max height achieved.\r\n//export function crunchnumbers( radius, omega, start_v_x, start_v_y, r_oncoin )\r\nexport function crunchnumbers( inputvalues )\r\n{\r\n\t\r\n\t//Calculate misc. variables /////////////////////////////////////\r\n\t/////////////////////////////////////////////////////////////////\r\n\tvar anglefromVertical=inputvalues.anglefromVertical\r\n\tvar speed=inputvalues.speed\r\n\tvar accel_earth=inputvalues.accel_earth\r\n\tvar percentgravity=inputvalues.percentgravity\r\n\tvar diameter=inputvalues.diameter\r\n\tvar startheight=inputvalues.startheight\r\n\t\r\n\tvar computedangle = (-1* anglefromVertical * Math.PI / 180) + (Math.PI / 2);\r\n\r\n\t\t//x component of speed without the part from rotation\r\n\tvar relative_v_x = speed * Math.cos(computedangle)\r\n\t\t//y matches reality\r\n\tvar relative_v_y = speed * Math.sin(computedangle)\r\n\t\r\n\tvar expectedheight\r\n\tvar expectedtime\r\n\t\r\n\tif(relative_v_y > 0)  //was thrown upwards\r\n\t{\t\t\t\r\n\t\t//var expectedheight = height_start + height_thrown; //works out exactly the same for case throw \"up\"\r\n\r\n\t\texpectedheight = (Math.pow(relative_v_y,2) / (2 * accel_earth)) + startheight;\r\n\t\texpectedtime = Math.sqrt( 2 * expectedheight / accel_earth ) + ( relative_v_y / accel_earth)  //same formula as throw \"up\"\r\n\t}\r\n\telse if(relative_v_y <= 0)  //was thrown downwards\r\n\t{\r\n\t\texpectedheight = startheight;\r\n\t\t\r\n\t\tvar end_v_y = -1 * Math.sqrt( Math.pow(relative_v_y,2) + 2*accel_earth*startheight )  //temporary variable\r\n\t\texpectedtime = Math.abs(2 * expectedheight / (relative_v_y + end_v_y))\r\n\t}\r\n\r\n\tvar g_accel = accel_earth * percentgravity / 100\r\n\t\r\n\tvar omega = Math.sqrt( g_accel / (diameter/2) )  //radians per second of station\r\n\tvar standingvelocity = Math.sqrt( g_accel * (diameter/2) )\r\n\t\r\n\tvar r_oncoin = (diameter/2) - startheight\t//radius at coin start\r\n\tvar g_oncoin = omega*omega*r_oncoin;\t\t//gravity acting on the coin\r\n\t\r\n\tvar standingcoin\t\t//standing velocity of coin\r\n\tif(startheight < diameter/2)\t\t//if coin started from below the radius (almost always)\r\n\t{  standingcoin = -1 * Math.sqrt( g_oncoin * r_oncoin ) } //-1 b/c station is rotating clockwise\r\n\telse\t\t\t//if coin starts above the center of rotation, it's actually going the other way\r\n\t{  standingcoin = Math.sqrt( g_oncoin * r_oncoin ) } //-1 b/c station is rotating clockwise\r\n\t\r\n\tvar start_v_x = relative_v_x + standingcoin\t//actual starting speed of coin\r\n\t\r\n\tvar expecteddist = Math.abs(relative_v_x * expectedtime) //expected distance on Earth\r\n\tvar start_speed = Math.sqrt( Math.pow(start_v_x,2) + Math.pow(relative_v_y,2) ) \r\n\t\t//actual start speed of coin with standing velocity incorporated\r\n\t\r\n\t\t//the coin's actual y velocity doesn't change when standing speed is incorporated\r\n\tvar start_v_y = relative_v_y \r\n\tvar radius = diameter/2\r\n\t\r\n\t//Find the coin's intersection with the circle.///////////////////////\r\n\t/////////////////////////////////////////////////////////////////////\r\n\t\r\n\t//console.log(\"omega\",omega)\r\n\tif(Math.abs(start_v_x) < 1e-2)\r\n\t{ start_v_x=new Decimal(0) }\r\n\tif(Math.abs(start_v_y) < 1e-2)\r\n\t{ start_v_y=new Decimal(0) }\r\n\t\r\n\tradius = new Decimal(radius)\r\n\tomega = new Decimal(omega)\r\n\tstart_v_x = new Decimal(start_v_x)\r\n\tstart_v_y = new Decimal(start_v_y)\r\n\tr_oncoin = new Decimal(r_oncoin)\r\n\t\t\r\n\t//slope of ball's path\r\n\t//var slope_ball = start_v_y / start_v_x\r\n\tvar slope = start_v_y.div( start_v_x )  //Decimal.js requires that I\r\n\t\t\t\t\t\t\t\t\t\t\t//divide using .div()\r\n\t\t\t\t\t\t\t\t\t\t\t//and multiply using .mul()\r\n\t\r\n\t//two possible forms of quadratic equation for x due to the +- operator.\r\n\t//sqroot1 is the square root part of the quadratic, which I then punch into the\r\n\t//rest of the quadratic formula with the correct operator. \r\n\t//This gives me the x landing coordinate on the circle.\r\n\t//Then punch in the x answer into the line in slope-intercept form to get y.\r\n\t\r\n\t//var sqroot1 = Math.sqrt( Math.pow(radius,2)*(1+Math.pow(slope_ball,2))-Math.pow(r_oncoin,2))\r\n\t\t\r\n\tvar sqroot1 = ( radius.pow(2).mul( new Decimal(1).add( slope.pow(2) ) ).sub( r_oncoin.pow(2))).sqrt()\r\n\t\r\n\t\r\n\t//first nail down the final position of the coin\r\n\tvar x_c\t//final spot of coin x\r\n\tvar y_c\t//final spot of coin y\r\n\r\n\t//coin is moving up to the left, or down to the left, or horizontal left\r\n\tif( (Number(slope)<0 && Number(start_v_x) < 0) || (slope > 0 && Number(start_v_x) < 0) || (slope == 0 && Number(start_v_x) < 0) )\r\n\t{\r\n\t\t//var x_c = ( (slope * r_oncoin) - sqroot1 ) / ( 1 + Math.pow(slope,2)) // -\r\n\t\tx_c = ( (slope.mul(r_oncoin)).sub( sqroot1 )).div( new Decimal(1).add( slope.pow(2)) ) // - operator\r\n\t\ty_c = slope.mul(x_c).sub(r_oncoin)\r\n\t}\r\n\t//coin is moving up to the right, or down to the right, or horizontal right\r\n\telse if((slope > 0 && Number(start_v_x) > 0) || (slope < 0 && Number(start_v_y) < 0) || (slope == 0 && Number(start_v_x) > 0) )\r\n\t{\r\n\t\t//var x_c = ( (slope * r_oncoin) + sqroot1 ) / ( 1 + Math.pow(slope,2)) // +\r\n\t\tx_c = ( (slope.mul(r_oncoin)).add(sqroot1)).div( new Decimal(1).add(slope.pow(2))) //+\r\n\t\ty_c = slope.mul(x_c).sub(r_oncoin)\r\n\t}\r\n\t\r\n\t//////////////////////////////////////////////////////////\r\n\t//This section calculates the time elapsed,\r\n\t//also deals with cases where slope is not finite (thrown vertically),\r\n\t//and calculates the max height of the coin above the floor.\r\n\t/////////////////////////////////////////////////////////\r\n\t\r\n\tvar time\r\n\tvar maxvalue\r\n\tif(slope.isFinite() && Number(start_v_x) != 0 )\r\n\t{\r\n\t\ttime= x_c.div(start_v_x)\r\n\t\t\r\n\t\t//Max height--a maximization script. Loop over time increments to find max.\r\n\t\tif(Number(start_v_y) > 0)\r\n\t\t{\r\n\t\t\t//Max distance from the circle can be found in the exact middle of a chord\r\n\t\t\t//where the line perpendicular goes to the circle's center.\r\n\t\t\t\r\n\t\t\t//The perpendicular line will be y=(-v_x/v_y)x\r\n\t\t\t//The current chord is y=(v_y/v_x)x-r_oncoin\r\n\t\t\t//The intersection can be found by (-v_x/v_y)x=(v_y/v_x)x-r_oncoin\r\n\t\t\t//(v_y/v_x)x-(-v_x/v_y)x=r_oncoin\r\n\t\t\t//x[(v_y/v_x)+(v_x/v_y)]=r_oncoin\r\n\t\t\t//x = r_oncoin / [(v_y/v_x)+(v_x/v_y)]\r\n\t\t\t\r\n\t\t\tvar max_x = r_oncoin / [(start_v_y/start_v_x)+(start_v_x/start_v_y)]\r\n\t\t\tif((max_x>0 && start_v_x<0) || (max_x>0 && start_v_x<0)) { max_x = 0 }\r\n\t\t\tvar max_y = (start_v_y/start_v_x)*max_x-r_oncoin\r\n\t\t\t\r\n\t\t\tmaxvalue = radius - Math.sqrt( Math.pow(max_x, 2) + Math.pow(max_y, 2)  )\r\n\t\t\t\r\n\t\t}\r\n\t\telse //if it was thrown downwards\r\n\t\t{\r\n\t\t\tmaxvalue = radius - r_oncoin; //starting height\r\n\t\t}\r\n\t}\t\t\t//if slope is vertical, fix the calculations\r\n\telse if( !slope.isFinite() && Number(start_v_y) > 0 )\t//thrown up\r\n\t{\r\n\t\ttime = (((new Decimal(2).mul(radius)).sub( radius.sub(r_oncoin) ) ).div(start_v_y)).abs()\r\n\t\tx_c = new Decimal(0)\r\n\t\ty_c = radius\r\n\t\tmaxvalue = radius\t//max height above the floor can't be higher than radius\r\n\t}\r\n\telse if( !slope.isFinite() && Number(start_v_y) < 0 )\t//thrown down\r\n\t{\r\n\t\ttime = ( radius.sub(r_oncoin).mul(-1) ).div(start_v_y)\r\n\t\tx_c = new Decimal(0)\r\n\t\ty_c = new Decimal(0)\r\n\t\tmaxvalue = radius.sub(r_oncoin)\t\t//starting height\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t///Final distance and curvilinear distance at landing//////////////\r\n\t///////////////////////////////////////////////////////////////////\r\n\r\n\t//if start_v_x==0 AND start_v_y == 0, then the coin is frozen in the air and the answers remain undefined. The script deals with this here.\r\n\tif(isFinite(time))\r\n\t{\r\n\t\t//radial angle swept by the person\r\n\t\t\r\n\t\t//var theta_traversed_person = omega * time\r\n\t\t//var initial_angle_person = (3 * Math.PI) / 2\r\n\t\t//var final_angle_person = initial_angle_person - theta_traversed_person //minus b/c clockwise rotation\r\n\t\tvar theta_traversed_person = Number( omega.mul( time ) )\r\n\t\tvar initial_angle_person = (new Decimal(3).mul( PI )).div(2)\r\n\t\tvar final_angle_person = initial_angle_person.sub(theta_traversed_person)\r\n\t\t\r\n\t\t\r\n\t\t//final position of person\r\n\t\t//fortunately Javascript uses radians, not degrees\r\n\t\t\r\n\t\t//var x_p = radius * Math.cos(final_angle_person)\r\n\t\t//var y_p = radius * Math.sin(final_angle_person)\r\n\t\tvar x_p = radius.mul( final_angle_person.cos() )\r\n\t\tvar y_p = radius.mul( final_angle_person.sin() )\r\n\t\t\r\n\t\t\r\n\t\t//var x_difference = x_p - x_c\r\n\t\t//var y_difference = x_p - y_c\t\r\n\t\t//var total_difference = Math.sqrt( Math.pow(x_difference,2) + Math.pow(y_difference,2) )\r\n\t\tvar x_difference = x_p.sub( x_c )\r\n\t\tvar y_difference = y_p.sub( y_c )\r\n\t\tvar total_difference = ( x_difference.pow(2).add(y_difference.pow(2) ) ).sqrt()\t//your final answer!\r\n\r\n\t\t\r\n\t\t//Now also calculate the coin's curvilinear distance difference (along floor)\r\n\t\t\r\n\t\tvar coin_distance = Math.sqrt(Math.pow(x_c,2) + Math.pow( Number(radius) + Number(y_c),2))\r\n\t\t\t//chord from floor where person started (270deg) to where coin lands\r\n\t\t\r\n\t\t//(formula) kahn acadamy says chordlength = 2radius * sin(angle/2)\r\n\t\t//so by using that you can get the angle of the chord.\r\n\t\tvar half_chord_value = coin_distance/(2*radius)\r\n\t\t\t//a bugfix for arcsin, if the coin lands almost exactly halfway across\r\n\t\t\t//then glitchy float values could give you 1.000000000001 and crash.\r\n\t\tif(half_chord_value > 1) { half_chord_value = 1 }  \r\n\t\tvar theta_traversed_coin = 2 * Math.asin(half_chord_value) \r\n\t\t\t\t//goes from 3PI/2 start to where the coin lands.\r\n\t\t\r\n\t\tvar new_theta_traversed_person = theta_traversed_person\r\n\t\twhile(new_theta_traversed_person > 2*Math.PI)\r\n\t\t{ new_theta_traversed_person -= 2* Math.PI}\r\n\t\t\t\t\r\n\t\t//correct the arcsin answer if the coin traveled left \r\n\t\t//and lands in quadrant 1 or 4\r\n\t\tif(x_c>0&&start_v_x<0) { theta_traversed_coin += 2*(Math.PI-theta_traversed_coin) }\r\n\t\t\r\n\t\tvar angular_diff = Math.abs(new_theta_traversed_person-theta_traversed_coin)\r\n\t\tif(angular_diff > Math.PI) {  angular_diff = (2* Math.PI) - angular_diff }\r\n\t\tvar curvilinear = angular_diff * radius  //convert from radians to feet\r\n\t\t\t\t//distance *along floor* at landing\r\n\t}\r\n\r\n\tif(!isFinite(time))\t\t//if the coin isn't moving at all, fix max height\r\n\t{ maxvalue = Math.abs(radius - r_oncoin) }\t//can't fix the other calculations\r\n\t\t\r\n\treturn {\r\n\t\tmaxheight:Number(maxvalue),\r\n\t\t//x_c : Number(x_c),\r\n\t\t//y_c : Number(y_c),\r\n\t\ttime: Number(time),\r\n\t\tslope: Number(slope),\r\n\t\ttotal_difference: Number(total_difference),\r\n\t\tcurvilinear: Number(curvilinear),\r\n\t\ttheta_traversed_person: theta_traversed_person,  //has already been converted to a number.\r\n\t\ttheta_traversed_coin: theta_traversed_coin,\r\n\t\t\r\n\t\texpectedtime: expectedtime,\r\n\t\texpectedheight: expectedheight,\r\n\t\tstandingvelocity: standingvelocity,\r\n\t\tomega: omega,\r\n\t\tstart_v_x: start_v_x,\r\n\t\tstandingcoin: standingcoin,\r\n\t\tg_oncoin: g_oncoin,\t\t\t//only in output menu\r\n\t\texpecteddist: expecteddist,\r\n\t\tstart_speed: start_speed,\t//only in output menu\r\n\t\t\r\n\t\t\r\n\t}\r\n}\r\n\r\n\r\n/*\t\t\t//Max height: a maximization script ////////////////////////\r\n\t\t\t\r\n\t\t\t//Starting values\r\n\t\t\tvar currenttime = 0   //time value at current loop\r\n\t\t\tvar time_increment = time/5  //time to increment over\r\n\t\t\t\r\n\t\t\t\t\t//iterate forwards to start. Reverses if you've passed the max.\r\n\t\t\tvar direction = 1\r\n\t\t\tmaxvalue = radius.sub(r_oncoin)  //initial \"maximum\" is initial height\r\n\t\t\tvar current_x = 0\t\t//current coordinates of coin\r\n\t\t\tvar current_y = 0\r\n\t\t\tvar current_value = 0 //height value calculated at current increment\r\n\t\t\tvar disttocenter = 0  //distance to center at current increment\r\n\t\t\tvar previousvalue = 0  //height value from previous loop\r\n\t\t\tvar timesinarow = 0   //how many times in a row has the value not changed\r\n\t\t\t\r\n\t\t\tfor(var i=0; i<1000; i++)\r\n\t\t\t{\r\n\t\t\t\tcurrenttime += (time_increment*direction)\r\n\r\n\t\t\t\t//distance=velocity*time\r\n\t\t\t\tcurrent_x = start_v_x * currenttime\r\n\t\t\t\t\r\n\t\t\t\t//y = mx + b\r\n\t\t\t\tcurrent_y = (slope * current_x) - r_oncoin\r\n\t\t\t\t\r\n\t\t\t\t//pythagoras, to find distance to ball from center of station\r\n\t\t\t\tdisttocenter = Math.sqrt( Math.pow(current_x,2) +Math.pow(current_y,2) )\r\n\t\t\t\t\r\n\t\t\t\tcurrent_value = radius - disttocenter\t//height from floor\r\n\t\t\t\t\r\n\t\t\t\tif(current_value<previousvalue)\r\n\t\t\t\t{  \t\t//if the values are decreasing\r\n\t\t\t\t\t\t//then it's the wrong direction.\r\n\t\t\t\t\tdirection = direction * -1;\r\n\t\t\t\t\t\t//time increment decreases when you change direction\r\n\t\t\t\t\t\t//(means you're close!)\r\n\t\t\t\t\ttime_increment = time_increment / 2;\r\n\t\t\t\t}\t\r\n\r\n\t\t\t\tif(current_value > maxvalue) { maxvalue = current_value }\r\n\t\t\t\t\r\n\t\t\t\tif( Math.abs(current_value - previousvalue) < .0001 )\r\n\t\t\t\t{ timesinarow += 1\t}  //you've probably found the max\r\n\t\t\t\telse\r\n\t\t\t\t{ timesinarow = 0 }\r\n\t\t\t\t\r\n\t\t\t\tif(timesinarow === 5) {\tbreak; }\r\n\t\t\t\t\r\n\t\t\t\tpreviousvalue = current_value;\r\n\t\t\t}\r\n*/","//This file processes the query variables in the address bar\r\n//so you can customize the link to the model with the variables you want.\r\n\r\n/*List of supported queries:\r\n\t&units=feet\r\n\t&units=imperial\r\n\t&units=metric\r\n\t&units=meters\r\n\t&diameter=  (insert number after equals sign)\r\n\t&radius=\r\n\t&percenttime=\r\n\t&startheight=\r\n\t&percentgravity=\r\n\t&speed=\r\n\t&angle=\r\n\t&statsMenu\r\n\t&inputMenu\r\n\t&thrownUp= (calculates speed needed to throw it this many feet \"up\" on Earth)\r\n\t&throwHeight=\r\n\t&frozen\r\n*/\r\n\r\n\r\n\r\n\r\n//Defaults set as namespaces. Can reset to these default values in the input menu.\r\n//Note: these are also present in App.js.\r\n\t//If you edit them here, then make sure you edit them there too!\r\nvar defaultImperial = {\r\n\tdiameter:50,\r\n\tstartheight:4,\r\n\tunits:\"ft\",\r\n\tpercentgravity:100,\r\n\tthrownUp:3,\r\n\taccel_earth:32.174,\r\n\tanglefromVertical:0,\r\n\tspeed: 14, //13.894,\r\n\tpercenttime:100,\r\n}\r\n\r\nvar defaultMetric = {\r\n\tdiameter: 15, //15.24,\r\n\tstartheight: 1.2,  //1.219,\r\n\tunits:\"m\",\r\n\tpercentgravity:100,\r\n\tthrownUp: 1, //.92,\r\n\taccel_earth: 9.80665,\r\n\tanglefromVertical:0,\r\n\tspeed: 4, //4.235,\r\n\tpercenttime: 100,\t\r\n}\r\n\r\nfunction getQueryVariable(variable) {\r\n    var query = document.location.href;\r\n    var vars = query.split('&');\r\n    for (var i = 0; i < vars.length; i++) {\r\n        var pair = vars[i].split('=');\r\n        if (decodeURIComponent(pair[0]) === variable) {\r\n            if(pair.length===2)\r\n\t\t\t{ return decodeURIComponent(pair[1]); }\r\n\t\t\telse\r\n\t\t\t{ return decodeURIComponent(pair[0]); }\r\n        }\r\n    }\r\n    //console.log('Query variable %s not found', variable);\r\n}\r\n\r\n\r\nexport function processQueryVariables()\r\n{\r\n\tvar queryflag=false;\t\t//lets app know if there was a query variable\r\n\r\n\t//if(document.location.href.includes('&'))\r\n\t//{ \t\t\t//don't skip the queries because this also sets the default variables.\r\n\t  \r\n\t//imperial or metric units\r\n\tvar units=getQueryVariable(\"units\")\r\n\tif(units===\"feet\" || units===\"imperial\" || units===\"ft\")\r\n\t\t{ units=\"ft\"; queryflag=true;  }\r\n\telse if(units===\"metric\" || units===\"meters\" || units===\"m\")\r\n\t\t{ units=\"m\"; queryflag=true; }\r\n\telse { units=\"ft\" } //if the result is uninterpretable\r\n  \r\n\tvar defaults\r\n\tif(units===\"ft\")\r\n\t\t{ defaults = defaultImperial; }\r\n\telse\r\n\t\t{ defaults = defaultMetric; }\r\n  \r\n\t//check for query variables!\r\n  \r\n\t//set diameter\r\n\tvar diameter = Number(getQueryVariable(\"diameter\"));\r\n\tif (isNaN(diameter))\r\n\t\t{ diameter=defaults.diameter}\r\n\telse { queryflag=true; }\r\n\r\n\t//set radius\r\n\tvar radius = Number(getQueryVariable(\"radius\"));\r\n\tif (radius) { diameter=radius*2; queryflag=true; }\r\n  \r\n\r\n\t//set playback speed\r\n\tvar percenttime = Number(getQueryVariable(\"percenttime\"));\r\n\tif(isNaN(percenttime)) percenttime = Number(getQueryVariable(\"playback\"));\r\n\tif (isNaN(percenttime))\r\n\t\t{ percenttime=defaults.percenttime }\r\n\telse { queryflag=true; }\r\n  \r\n\t//set start  height\r\n\tvar startheight = Number(getQueryVariable(\"startheight\"));\r\n\tif (isNaN(startheight))\r\n\t\t{ startheight=defaults.startheight }\r\n\telse { queryflag=true; }\r\n\r\n\t//set percent gravity\r\n\tvar gravity = Number(getQueryVariable(\"percentgravity\"));\r\n\tif (isNaN(gravity))\r\n\t\t{ gravity=defaults.percentgravity }\r\n\telse { queryflag=true; }\r\n  \r\n\t//set the speed\r\n\tvar speed = Number(getQueryVariable(\"speed\"));\r\n\tif (isNaN(speed))\r\n\t\t{ speed=defaults.speed; }\r\n\telse { queryflag=true; }\r\n\r\n\t//set the angle\r\n\tvar angle = Number(getQueryVariable(\"angle\"));\r\n\tif (isNaN(angle))\r\n\t\t{ angle=defaults.anglefromVertical }\r\n\telse { queryflag=true; }\r\n\r\n\t//start with right menu open\r\n\tvar queryMenu=2; //this variable is kind of dumb, but I couldn't think of another way to get this to work.\r\n\tvar rightMenu = getQueryVariable(\"statsMenu\");\r\n\tif(rightMenu===\"true\" || rightMenu===\"statsMenu\")\r\n\t\t{ rightMenu=true; /*queryflag=true;*/ queryMenu=0; }\r\n\telse { rightMenu=false; }\r\n\r\n\t//start with left menu open\r\n\tvar leftMenu = getQueryVariable(\"inputMenu\");\r\n\tif(leftMenu===\"true\" || leftMenu===\"inputMenu\")\r\n\t\t{ leftMenu=true; /*queryflag=true;*/ queryMenu=0;}\r\n\telse { leftMenu=false; }\r\n\r\n\t\t//calculate radians from horizontal-right (the normal type of angle!)\r\n\tvar computedangle = (-1* angle * Math.PI / 180) + (Math.PI / 2);\r\n  \r\n\t//weird case of \"height it's thrown to on Earth.\" \r\n\t//Why am I supporting this feature?\r\n\tvar accel_earth = defaults.accel_earth\r\n\tvar thrownUp = Number(getQueryVariable(\"thrownUp\"));\r\n\tif (isNaN(thrownUp)) thrownUp = Number(getQueryVariable(\"throwHeight\"));\r\n\tif (isNaN(thrownUp)) thrownUp = defaults.thrownUp\r\n\telse {\r\n\t\tqueryflag = true;\r\n\t\tvar relative_v_y = Math.sqrt( 2 * accel_earth * thrownUp );\r\n\t\t\r\n\t\tif(angle===0)\r\n\t\t{\tspeed=relative_v_y\t}\r\n\t\telse\r\n\t\t{\tspeed=relative_v_y / Math.sin(computedangle) }\r\n\t}\r\n  \r\n\t//start in a frozen state\r\n\tvar frozen = getQueryVariable(\"frozen\");\r\n\tif(frozen===\"true\" || frozen===\"frozen\")\r\n\t\t{ frozen=true; /*queryflag=true;*/ } \r\n\telse if(frozen===\"false\")\r\n\t\t{ frozen=false; /*queryflag=true;*/ }\r\n\telse { if(!queryflag) frozen=false;  //don't freeze by default!\r\n\t\t\telse frozen=false; }\r\n\tvar displayPopUp=true\r\n\t\t\t//frozen state shouldn't lock the defaults\r\n\t\t\t//thus I'm not doing the queryflag here\r\n\r\n\t//if a query has been used, don't display the popup message.\r\n\tif(queryflag || getQueryVariable(\"noPopUp\")===\"noPopUp\") {displayPopUp=false;}\r\n\r\n\treturn {\r\n\t\tdiameter: diameter,\r\n\t\tstartheight: startheight,\r\n\t\tunits: units,\r\n\t\tpercentgravity: gravity,\r\n\t\tthrownUp: thrownUp,\r\n\t\taccel_earth: accel_earth,\r\n\t\tanglefromVertical:angle,\r\n\t\tspeed: speed,\r\n\t\tpercenttime: percenttime,\r\n\t\t\r\n\t\tdefaults: defaults,\r\n\t\tleftMenu: leftMenu,\r\n\t\trightMenu: rightMenu,\r\n\t\tfrozen: frozen,\r\n\t\tqueryMenu:queryMenu,\r\n\t\tqueryflag:queryflag,\r\n\t\tPopUpOpen: displayPopUp,\r\n\t}\t\t\r\n}","/*eslint-disable eqeqeq*/\r\n\r\nimport React, { Component } from 'react';\r\nimport './App.css';\r\n\r\nclass OutputMenu extends Component {\r\n\t\r\n\t//don't update the menu if it's closed!\r\n\tshouldComponentUpdate(newProps, newState)\r\n\t{\r\n\t\tif(newProps.menuOpen || this.props.menuOpen)\r\n\t\t{ return true;}\r\n\t\telse {return false;}\r\n\t}\r\n\t\t\r\n\t\r\n\trender() {\r\n\t\t\r\n\t\t//Pick the right units for rotation speed\r\n\t\tvar rotation = this.props.vars.rotation;\r\n\t\t//var rotation_units = \"rev/s\" //not likely. But I validate below.\r\n\t\tvar time_to_rotate = (1/rotation)\r\n\t\tvar time_to_rotate_units = \"s\"\r\n\r\n\t\tif(rotation < 1)\r\n\t\t{\t//rotation_units = \"rpm\"\r\n\t\t\trotation = rotation * 60; }\r\n\t\t\t\r\n\t\tif(rotation < 1)\r\n\t\t{\t//rotation_units = \"rev/h\"\r\n\t\t\trotation = rotation * 60;\r\n\t\t\t\r\n\t\t\ttime_to_rotate = time_to_rotate /60;\r\n\t\t\ttime_to_rotate_units = \"min\"\r\n\t\t}\r\n\t\t\t\r\n\t\tif(rotation < 0.5)\r\n\t\t{\t//rotation_units = \"rev/d\"\r\n\t\t\trotation = rotation * 24;\r\n\t\t\t\r\n\t\t\ttime_to_rotate = time_to_rotate /60;\r\n\t\t\ttime_to_rotate_units = \"hr\"\r\n\t\t}\r\n\t\t\r\n\t\t/*var units2\r\n\t\tif(this.props.vars.units===\"ft\")\r\n\t\t{ units2=\"mph\" }\r\n\t\telse if(this.props.vars.units===\"m\")\r\n\t\t{ units2=\"km/h\" }\r\n\t\t\r\n\t\tvar speedunits = this.state.units\r\n\t\t//var standingvelocity = this.props.vars.standingvelocity\r\n\t\tvar standingcoin = Math.abs(this.props.vars.standingcoin)\r\n\t\t//var throwspeed = this.props.vars.throwspeed\r\n\t\t\r\n\t\t//other speed formats\r\n\t\tif(speedunits===\"mph\")\r\n\t\t{ standingvelocity *= 0.681818; standingcoin *= 0.681818; throwspeed *= 0.681818; }\r\n\t\tif(speedunits===\"km/h\")\r\n\t\t{ standingvelocity *= 3.6; standingcoin *= 3.6; throwspeed *= 0.681818; }*/\r\n\r\n\t\tvar secondaryunits\r\n\t\tif(this.props.vars.units===\"ft\") secondaryunits=\"in\"\r\n\t\telse secondaryunits=\"cm\"\r\n\t\r\n\t\t//decide to display cm/inches\r\n\t\tvar displaysecondary = \"hide\"; var finalseparation2;  var expecteddist2;\r\n\t\tif(this.props.vars.finalseparation < 1.0)\r\n\t\t{\t\r\n\t\t\tif(this.props.vars.units==\"ft\") //in\r\n\t\t\t{\r\n\t\t\t\tfinalseparation2 = this.props.vars.finalseparation * 12;\r\n\t\t\t\texpecteddist2 = this.props.vars.expecteddist * 12;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this.props.vars.units==\"m\")  //cm\r\n\t\t\t{\r\n\t\t\t\tfinalseparation2 = this.props.vars.finalseparation * 100\r\n\t\t\t\texpecteddist2 = this.props.vars.expecteddist * 100\r\n\t\t\t}\r\n\t\t\tdisplaysecondary = \"\"\r\n\t\t}\r\n\r\n\t\t//hide the Curvilinear answer if it's the same as the straight-line answer\r\n\t\tvar showCurvy=\"\"\r\n\t\t//console.log(format(this.props.vars.curvilinear), format(this.props.vars.finalseparation))\r\n\t\tif(format(this.props.vars.curvilinear)==format(this.props.vars.finalseparation))\r\n\t\t{showCurvy=\"hide\"}\r\n\t\r\n\t\t//If the person has traveled more than half a circle,\r\n\t\t//display the number of rotations and display a warning. \r\n\t\t//nevermind don't. Just don't display the \"difference from expected.\"\r\n\t\tvar rotationAngle = \"\";  var numRotations = \"hide\";\r\n\t\tif(this.props.vars.theta_traversed_person > Math.PI || !isFinite(this.props.vars.theta_traversed_person) )\r\n\t\t\t{   numRotations=\"\";  rotationAngle=\"hide\"; }\r\n\r\n\t\treturn( \r\n\t\t\r\n<div id=\"outputbox\"><h3>Statistics</h3>\r\n<div id=\"outeroutputtable\">\r\n<table id=\"innertable\"><tbody>\r\n\t<tr className=\"border_bottom\"><td><h3>&emsp;</h3></td>\r\n\t\t<td className=\"redcolor\">On station</td>\r\n\t\t<td className=\"bluecolor\">On Earth</td>\r\n\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td className=\"borderright\">Time in the air</td>\r\n\t\t\t<td><div className=\"output1\">{format(this.props.vars.time)}&nbsp;s</div></td>\r\n\t\t\t<td><div className=\"output1\">{format(this.props.vars.expectedtime)}&nbsp;s</div></td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td className=\"borderright\">Max height reached</td>\r\n\t\t\t<td><div className=\"output1\">{format(this.props.vars.maxheight)}&nbsp;{this.props.vars.units}</div></td>\r\n\t\t\t<td><div className=\"output1\">{format(this.props.vars.expectedheight)}&nbsp;{this.props.vars.units}</div></td>\r\n\t\t</tr>\r\n\t\t<tr id=\"boldrow\">\r\n\t\t\t<td className=\"borderright\"><div className=\"redcolor\"><div>Straight-line dist</div> “away” at landing</div></td>\r\n\t\t\t<td>\r\n\t\t\t\t<div className=\"output1\">{format(this.props.vars.finalseparation)}</div>\r\n\t\t\t\t\t<div className=\"output1\">&nbsp;{this.props.vars.units}</div>\r\n\t\t\t\t<div className={displaysecondary}>({format(finalseparation2)}&nbsp;{secondaryunits})</div>\r\n\t\t\t\t</td>\r\n\t\t\t<td>\r\n\t\t\t\t<div className=\"output1\">{format(this.props.vars.expecteddist)}</div>\r\n\t\t\t\t\t<div className=\"output1\">&nbsp;{this.props.vars.units}</div>\r\n\t\t\t\t<div className={displaysecondary}>({format(expecteddist2)}&nbsp;{secondaryunits})</div>\r\n\t\t\t\t</td>\r\n\t\t</tr>\r\n</tbody></table></div>\r\n\r\n<div className=\"conditionalBreak1\">&nbsp;</div>\r\n<div className=\"conditionalBreak\">&nbsp;</div>\r\n\r\n<table className=\"secondtable\"><tbody>\r\n\r\n<tr className={ showCurvy }><td><div className=\"leftoutput\">Distance “away” <i>along floor</i> at landing:</div></td>\r\n\t<td>{format(this.props.vars.curvilinear)}</td>\r\n\t<td>{this.props.vars.units}</td>\r\n</tr>\r\n\r\n<tr><td><div className=\"leftoutput\">Time to complete one rotation:</div></td>\r\n\t<td>{format(time_to_rotate)}</td>\r\n\t<td>{time_to_rotate_units}</td>\r\n</tr>\r\n\r\n<tr className={rotationAngle}><td><div className=\"leftoutput\">Angle the person rotates while the coin is midair:</div></td>\r\n\t<td>{format(this.props.vars.theta_traversed_person * 180 / Math.PI)}</td>\r\n\t<td>°</td>\r\n</tr>\r\n\r\n<tr className={numRotations}><td><div className=\"leftoutput\">Rotations the person completes while the coin is midair:</div></td>\r\n\t<td>{format(this.props.vars.theta_traversed_person / (2 * Math.PI))}</td>\r\n\t<td>rev</td>\r\n</tr>\r\n\r\n<tr><td><div className=\"leftoutput\">Object's speed before throw:</div></td>\r\n\t<td>{format(Math.abs(this.props.vars.standingcoin))}</td>\r\n\t<td>{this.props.vars.units}/s</td>\r\n</tr>\r\n\r\n<tr className=\"conditionalBreak1\"><td>&nbsp;</td></tr>\r\n</tbody></table>\r\n\r\n<h3>Links</h3>\r\n  <div style={{lineHeight:'1.25em'}}>\r\n\t<a href={window.articleUrl}>More</a> about the Coriolis effect<br/>\r\n\t<a href={window.articleUrl+'/ideas'}>Interesting throws</a> for this model<br/>\r\n\t<a href={window.articleUrl+'/math'}>The math</a> behind this model<br/>\r\n  </div>\r\n  <div className=\"conditionalBreak1\">&nbsp;</div>\r\n\t<button type=\"submit\" className=\"ResetButton\" style={{width:'200px', marginTop:'7px'}} onClick={ this.props.closeMenuButton }>Close menu</button>\r\n</div>\r\n\r\n\t\t);\r\n\r\n\t\t\r\n\t}\r\n}\r\n\r\n\r\n\r\nfunction format(num)\r\n{\r\n\tnum = round(num)\r\n\t\r\n\tif(!isFinite(num) )\r\n\t{ return \"∞\" }\r\n\telse\r\n\t{ if(num < 99999) return num.toString()\r\n\t  else return num.toExponential(0).replace(\"e+\",\"*10^\") }\r\n\t\r\n}\r\n\r\n//rounds to four significant figures.\r\nfunction round(num, places) {\r\n\tif(num===0)\r\n\t{ return 0 }\r\n\t\r\n    if(places==null && num > 1)\r\n\t{\r\n\t\tvar order = Math.floor(Math.log(num) / Math.LN10\r\n                       + 0.000000001); // because float math sucks like that\r\n\t\tplaces = (order * -1) + 3\r\n\t}\r\n\telse if(places==null)\r\n\t{ places = 2 }\r\n\t\r\n\tvar multiplier = Math.pow(10, places);\r\n    var output = Math.round(num * multiplier) / multiplier;\r\n\t\r\n\t//fix some weird output. Probably due to feet/meters conversion not being more precise.\r\n\tif(Math.abs(output - Math.round(output)) <= .0011)\r\n\t{ output = Math.round(output); }\r\n\r\n\treturn output;\t\r\n}\r\n\r\n\r\nexport default OutputMenu;\r\n\r\n","//The main page for my Coriolis model\n\nimport React, { Component } from 'react';\nimport './App.css';\n\nimport { slide as Menu } from 'react-burger-menu'\nimport CanvasEarth from './CanvasEarth'\nimport CanvasSpace from './CanvasSpace'\nimport AngleInput from './AngleInput'\nimport InputField from './InputField'\nimport PlayBack from './PlayBack'\nimport RadioConvertUnits from './RadioConvertUnits'\nimport { crunchnumbers } from './crunchnumbers.js'\nimport { processQueryVariables } from './processQueries.js'\nimport OutputMenu from './OutputMenu.js'\nimport ReactTouchEvents from \"react-touch-events\";\n\n\n//If ResizeObserver isn't supported to my liking...\n//then there is react-resize-observer import which could do the same thing,\n//perhaps even more simply. \n//But I liked the idea of using a browser function \n//instead of installing a new component.\n//Code I used to implement ResizeObserver:\n//https://seesparkbox.com/foundry/using_react_custom_hook\n\n\n\t\t//article url is global so I can define it here for every part of the app.\n//window.articleUrl = \"http://localhost:4000\"\nwindow.articleUrl = \"http://kevindprice.github.io/coriolis\"\n\n//Defaults set as namespaces. \n//Can push reset in input menu to return to these default values.\n//If a query variable was used, then it will return to that instead.\n//Note: these are also present in processQueries.js.\n\t//If you edit them here, then make sure you edit them there too!\nvar defaultImperial = {\n\tdiameter:50,\n\tstartheight:4,\n\tunits:\"ft\",\n\tpercentgravity:100,\n\tthrownUp:3,\n\taccel_earth:32.174,\n\tanglefromVertical:0,\n\tspeed: 14, //13.894,\n\tpercenttime:100,\n}\n\nvar defaultMetric = {\n\tdiameter: 15, //15.24,\n\tstartheight: 1.2,  //1.219,\n\tunits:\"m\",\n\tpercentgravity:100,\n\tthrownUp: 1, //.92,\n\taccel_earth: 9.80665,\n\tanglefromVertical:0,\n\tspeed: 4, //4.235,\n\tpercenttime: 100,\t\n}\n\nvar defaultQuery = {  //constructor sets the values\n\tdiameter: null,\t\t//if there is a query variable present.\n\tstartheight: null,\t//Then these will be the defaults\n\tunits:null,\t\t\t//for the input menu.\n\tpercentgravity:null,\n\tthrownUp: null,\n\taccel_earth: null,\n\tanglefromVertical:null,\n\tspeed: null,\n\tpercenttime: null,\n}\n\n\t\t\t\t\t//animation has to be global so I can stop it\n\t\t\t\t\t//from a different function from which it was called.\nvar starsanimation = null; \n\n//capture the page object from the ref *once*. Doing multiple times is crashy.\nvar burgerPageObject = null;\n\nclass App extends Component {\n\t\t\t\t\t\t //process query variables ////////////\n   constructor(props) {\t \t\t//and set variable defaults to state\n\t\tsuper(props);\n\t\t\n\t\tvar queryValues = processQueryVariables()\n\t\t\n\t\tdefaultQuery = {\n\t\t\tdiameter: queryValues.diameter,\n\t\t\tstartheight: queryValues.startheight,\n\t\t\tunits: queryValues.units,\n\t\t\tpercentgravity: queryValues.gravity,\n\t\t\tthrownUp: queryValues.thrownUp,\n\t\t\taccel_earth: queryValues.accel_earth,\n\t\t\tanglefromVertical: queryValues.anglefromVertical,\n\t\t\tspeed: queryValues.speed,\n\t\t\tpercenttime: queryValues.percenttime,\n\t\t}\n\t\n\t\t//duplicate updateOtherVars(), but since component is still unmounted\n\t\t//then don't do updateState(). But these variables need to be there\n\t\t//for component to render\n\t\t\n\t\tvar encapsulatedCrunch={\n\t\t\tanglefromVertical: queryValues.anglefromVertical,\n\t\t\tspeed: queryValues.speed,\n\t\t\taccel_earth: queryValues.accel_earth,\n\t\t\tpercentgravity: queryValues.percentgravity,\n\t\t\tdiameter: queryValues.diameter,\n\t\t\tstartheight: queryValues.startheight,\n\t\t}\n\n\t\tvar answers = crunchnumbers(encapsulatedCrunch)\n\t\t\n\t\tvar pageShape\n\t\tif (window.innerWidth>window.innerHeight) {pageShape = \"wide\"}\n\t\telse {pageShape = \"tall\"}\n\t\t\n\t\t//does not account for burger menu this way.\n\t\t//Will be updated on first render.\n\t\t\n\t\tthis.state = {\n\t\t\tdiameter: queryValues.diameter,\n\t\t\tstartheight: queryValues.startheight,\n\t\t\tunits: queryValues.units,\n\t\t\tpercentgravity: queryValues.percentgravity,\n\t\t\tthrownUp: queryValues.thrownUp,\n\t\t\tanglefromVertical: queryValues.anglefromVertical,\n\t\t\tspeed: queryValues.speed,\n\t\t\tpercenttime: queryValues.percenttime,\n\t\t\taccel_earth: queryValues.accel_earth,\t\t  \n\t\t\t\n\t\t\tmenuLeftOpen: queryValues.leftMenu,\n\t\t\tmenuRightOpen: queryValues.rightMenu,\n\t\t\tfrozen:queryValues.frozen,\n\t\t\tqueryMenu:queryValues.queryMenu,\n\t\t\tqueryflag:queryValues.queryflag,\t//used to lock the defaults if a query is used\n\t\t\tPopUpOpen: queryValues.PopUpOpen,\n\n\t\t\tstarSpeed: 5,  //percent speed of stars\n\t\t\tshowStarForm: true,\t//show the star speed dropdown menu\n\t\t\tcanvasStarData: null,\n\t\t\tdefaults: queryValues.defaults,\n\t\t\t//burgerFlag: false, //flag for canvases to rerender when the menu opens\n\n\t\t\t//vars from number crunching\n\t\t\texpectedtime : answers.expectedtime,\n\t\t\texpectedheight: answers.expectedheight,\n\t\t\tstandingvelocity: answers.standingvelocity,\n\t\t\tomega: answers.omega,\n\t\t\tmaxheight: answers.maxheight,\n\t\t\ttime: answers.time,\n\t\t\tslope: answers.slope,\n\t\t\ttotal_difference: answers.total_difference,\n\t\t\t\t//starting speed of coin with standing speed incorporated\n\t\t\tstart_v_x: answers.start_v_x,\t\n\t\t\tstandingcoin: answers.standingcoin,\n\t\t\tg_oncoin: answers.g_oncoin,\n\t\t\texpecteddist: answers.expecteddist,\t//coin's landing distance on earth\n\t\t\tstart_speed: answers.start_speed,\n\t\t\ttheta_traversed_person: answers.theta_traversed_person,\n\t\t\ttheta_traversed_coin: answers.theta_traversed_coin,\n\t\t\tcurvilinear: answers.curvilinear,\n\t\t\t\n\t\t\t\t//page renders differently if burger menu pushes it aside\n\t\t\t\t//and also state needs to update on resize so I know if it's \n\t\t\t\t\t//tallCanvas or wideCanvas\n\t\t\t//width:window.innerWidth,\n\t\t\t//height:window.innerHeight,\n\t\t\t\n\t\t\t//actually I only need to  know if it needs to be tall or wide.\n\t\t\t//Prevent unnecessary re-renders by not updating state on every resize.\n\t\t\tpageShape: pageShape,\n\t\t\tshouldShiftForBurger: (window.innerWidth > 600), \n\t\t\t\t//if the page is too skinny, like on mobile, then shrinking just looks ugly.\n\t\t\t\n\t\t\t//now calculated in the number crunching\n\t\t\t//standingvelocity: Math.sqrt( queryValues.accel_earth * queryValues.diameter/2),\n\t\t\t//omega: Math.sqrt( queryValues.accel_earth / (queryValues.diameter/2) ),\n\t\t}\n\n\t\tthis.setDefaultState = this.setDefaultState.bind(this);\n\t\tthis.updateStarSpeed = this.updateStarSpeed.bind(this);\n\t\tthis.receiveStarCenter = this.receiveStarCenter.bind(this);\n\t\tthis.freeze = this.freeze.bind(this);\n\t\tthis.updateState = this.updateState.bind(this);\n\t\tthis.convertunits = this.convertunits.bind(this);\n\t\tthis.updateDiameter = this.updateDiameter.bind(this);\n\t\tthis.updateOtherVars = this.updateOtherVars.bind(this);\n\t\tthis.toggleLeftMenu = this.toggleLeftMenu.bind(this);\n\t\tthis.toggleRightMenu = this.toggleRightMenu.bind(this);\n\t\tthis.closeMenus = this.closeMenus.bind(this);\n\t\tthis.closeMenuButton = this.closeMenuButton.bind(this);\n\t\tthis.togglePopUp = this.togglePopUp.bind(this);\n\t\t\n\t\t\t //get the dimensions of the page as it is shrunk by the burger menu\n\t\t\t //(not the window.innerWidth or innerHeight dimension)\n\t\tthis.burgerPageRef = React.createRef();\n\t\tthis.resizeObserver = null;\t\t\n\t}\n\t\n\tobserve = RO => {\n\t\tthis.resizeObserver = new RO(entries => {\n\t\t\tconst {\n\t\t\t\twidth,\n\t\t\t\theight,\n\t\t\t\t//top,\n\t\t\t\t//right,\n\t\t\t\t//bottom,\n\t\t\t\t//left\n\t\t\t} = entries[0].contentRect;\n\t\t\t\n\t\t\t//this.setState({ width, height })\n\t\t\tif(typeof width !== 'undefined'){\t\t\t\t\n\t\t\t\tif( width>height && this.state.pageShape === \"tall\") \n\t\t\t\t\t{  this.setState({pageShape:\"wide\"}) }\n\t\t\t\telse if(width<height && this.state.pageShape === \"wide\")\n\t\t\t\t\t{  this.setState({pageShape:\"tall\"})}\n\t\t\t}\n\t\t});\n\t};\n\t\n\tcomponentWillUnmount() {\n\t\tif(this.resizeObserver){\n\t\t\tthis.resizeObserver.disconnect();\n\t\t}\n\t}\n\t\n\n\tcomponentDidMount()\n\t{\n\t\tburgerPageObject = this.burgerPageRef.current\n\t\t\n\t\tif(\"ResizeObserver\" in window)\n\t\t{ this.observe(ResizeObserver);\t} \n\t\telse {  //If the browser doesn't support ResizeObserver...\n\t\t\n\t\t\t//...then don't shift for menu\n\t\t\tthis.setState({shrinkPageForBurger: false})\n\n\t\t\t//...event listener for window size\n\t\t\twindow.addEventListener('resize', () => { \t\n\t\t\t\tif( window.innerWidth>window.innerHeight && this.state.pageShape === \"tall\") \n\t\t\t\t\t{  this.setState({pageShape:\"wide\"}) }\n\t\t\t\telse if(window.innerWidth<window.innerHeight && this.state.pageShape === \"wide\")\n\t\t\t\t\t{  this.setState({pageShape:\"tall\"})} \n\t\t\t});\n\t\t}\n\t\t\n\t\t\n\t\tthis.resizeObserver.observe(burgerPageObject);\n\n\n\t\t//if the window is less than 600 px wide, then don't squish the page for the menu.\n\t\twindow.addEventListener('resize', () => {\n\t\t\tif(this.state.shouldShiftForBurger && window.innerWidth < 600)\n\t\t\t{ this.setState({shouldShiftForBurger:false}) }\n\t\t\tif(!this.state.shouldShiftForBurger && window.innerWidth > 600 && \"ResizeObserver\" in window)\n\t\t\t{ this.setState({shouldShiftForBurger:true}) }\n\t\t});\n\t\t\n\t}\n\n\t\n\t\n\tshouldComponentUpdate(newProps, newState)\n\t{\n\t\tif( this.state.frozen!==newState.frozen )\n\t\t{ return true; }\n\t\n\t\t\n\t\t//if one of these items was updated, then\n\t\t//updateOtherVars() will trigger a re-render anyway.\n\t\t//Checking this will prevent rendering twice.\n\t\tif( (this.state.diameter !== newState.diameter ||\n\t\t\tthis.state.startheight !== newState.startheight ||\n\t\t\tthis.state.units !== newState.units ||\n\t\t\tthis.state.percentgravity !== newState.percentgravity ||\n\t\t\tthis.state.thrownUp !== newState.thrownUp ||\n\t\t\tthis.state.anglefromVertical !== newState.anglefromVertical ||\n\t\t\tthis.state.speed !== newState.speed ||\n\t\t\tthis.state.percenttime !== newState.percenttime ||\n\t\t\tthis.state.accel_earth !== newState.accel_earth ||\n\t\t\t\n\t\t\t(this.state.canvasStarData !== newState.canvasStarData &&\n\t\t\tthis.state.showStarForm === newState.showStarForm)\n\n\t\t\t) //&&\n\t\t\t//this.state.displayArticle===newState.displayArticle\n\t\t)\n\t\t{ return false; }\n\t\telse\n\t\t{ return true; }\n\t}\n\t\n\t\n\t//called by pushing the reset button in input menu\n\tsetDefaultState()\n\t{\n\t  //preserve the units, revert everything else.\n\t  var defaults=this.state.defaults;\n\n      this.setState({\n\t\t  diameter: defaults.diameter,\n\t\t  startheight: defaults.startheight,\n\t\t  units: defaults.units,\n\t\t  percentgravity: defaults.percentgravity,\n\t\t  thrownUp: defaults.thrownUp,\n\t\t  anglefromVertical: defaults.anglefromVertical,\n\t\t  speed: defaults.speed,\n\t\t  percenttime: defaults.percenttime,\n\t\t  accel_earth:defaults.accel_earth,\n\t\t  standingvelocity: Math.sqrt( defaults.accel_earth * defaults.diameter/2),\n\t\t  omega: Math.sqrt( defaults.accel_earth / (defaults.diameter/2) ),\n\n\t\t  //droppedflag: false,\n\t\t}, ()=>{this.updateOtherVars();} )\n\t\t\n\t}\n\t\n\t\n   //onChange={(e) => this.setState({starSpeed: e.target.value, })}\n   //onChange={(e) => this.updateStarSpeed(e.target.value) }\n\tupdateStarSpeed(value)\t//called by dropdown form. \"Show stars at: 5%\"\n\t{\tthis.setState({ starSpeed: value });\t\n\t\tthis.receiveStarCenter(this.state.canvasStarData, value);\n\t}\n\n\t//callback function from CanvasSpace.js\n\t//This is where App.js receives the coordinates for the stars' center of rotation\n\t//And then starts / adjusts the star animation\n\treceiveStarCenter(childData, starSpeed)\n\t{\n\t\tif(typeof starSpeed==='undefined') {starSpeed=this.state.starSpeed; }\n\t\t\n\t\t//need this for if it's called by adjusting the star speed dropdown menu\n\t\t//instead of the canvas\n\t\tthis.setState({canvasStarData:childData,})\n\t\tvar starsobj = document.getElementById(\"stars\");\n\t\tvar frozenstars = document.getElementById(\"frozenstars\");\n\t\t\t\t\n\t\t//get top-left coordinate of canvas\n\t\tvar canvascoords = document.getElementById(\"spaceGround\").getBoundingClientRect();\n\t\t\n\t\t//center of rotation based on pixels from the top-left of screen\n\t\tvar page_x = childData.centerX + canvascoords.x\n\t\tvar page_y = childData.centerY + canvascoords.y\n\t\t\t\t\n\t\tif(starsobj != null) {\n\n\t\t\t//calculate distance from rotation center to bottom-right of screen\n\t\t\t//to give enough room for the stars to rotate without going off the page\n\t\t\tvar diagonal = Math.sqrt( Math.pow(window.innerHeight-page_y, 2) + Math.pow(window.innerWidth-page_x,2) )\n\t\t\t\n\t\t\t//distance from rotation center to bottom-left of screen\n\t\t\tvar diagonal2 = Math.sqrt( Math.pow(window.innerHeight-page_y, 2) + Math.pow(0-page_x,2) )\n\t\t\t\n\t\t\t//distance from rotation center to top-right of screen\n\t\t\tvar diagonal3 = Math.sqrt( Math.pow(page_y, 2) + Math.pow(window.innerWidth-page_x, 2))\n\t\t\t\n\t\t\t//and the top-left doesn't ever matter here.\n\t\t\t\n\t\t\tif(diagonal2>diagonal) {diagonal=diagonal2} //pick whichever is greater\n\t\t\tif(diagonal3>diagonal) {diagonal=diagonal3}\n\t\t\t\t\n\t\t\t//sets the stars size dynamically (below) up to 6 times the screen size.\n\t\t\t//(divides by 2, because you only need half of it to be > than diagonal)\n\t\t\tif(window.innerWidth*6/2 > diagonal && window.innerHeight*6/2 > diagonal)\n\t\t\t{\n\t\t\t\t//the exact size the stars need to be to cover the screen while spinning.\n\t\t\t\t//(don't waste resources in spinning something bigger than necessary)\n\t\t\t\tstarsobj.style.width=(diagonal*2).toString() + \"px\"\n\t\t\t\tstarsobj.style.height=(diagonal*2).toString() + \"px\"\n\t\t\t\t\n\t\t\t\tthis.setState( {showStarForm: true,} );\n\n\t\t\t\t//change css of stars object to center it at center of rotation\n\t\t\t\t\t\t//canvas is 1000% of screen size, so 500% is centered.\n\t\t\t\tvar leftval = page_x - starsobj.offsetWidth/2\n\t\t\t\tvar topval = page_y - starsobj.offsetHeight/2\n\t\t\t\tstarsobj.style.left = leftval.toString() + \"px\"\n\t\t\t\tstarsobj.style.top  = topval.toString() + \"px\"\n\t\t\t\t\n\t\t\t\tvar duration = childData.duration / ((this.state.percenttime/100)*(starSpeed/100));\n\t\t\t\t\n\t\t\t\tif (duration < 0 || isNaN(duration)) {duration=\"auto\"}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tstarsanimation = starsobj.animate({\n\t\t\t\t\t  transform: ['rotate(0)', 'rotate(-360deg)']}, \n\t\t\t\t{\n\t\t\t\t\tduration: duration,\n\t\t\t\t\titerations: Infinity\n\t\t\t\t});\n\t\t\t}\n\t\t\telse //if the station is huge, just move the stars horizontally\n\t\t\t{\t\n\t\t\t\t//moves at a random angle depending on the prior transformation.\n\t\t\t\t//starsobj.style.animation = \"move-stars-back 50s linear infinite\";\n\n\t\t\t\t//Aligning the stars object to exactly the size of the picture\n\t\t\t\t//makes the animation (below) perfectly smooth with no jumps.\n\t\t\t\t//This sets the picture to the minimum size to cover the entire screen\n\t\t\t\t//(don't waste resources sliding something that's not visible)\n\t\t\t\tvar slidestarsleft = 1280;\n\t\t\t\twhile( slidestarsleft < window.innerWidth)\n\t\t\t\t\t{ slidestarsleft+=1280; }\n\t\t\t\tvar slidestarswidth = 1280+window.innerWidth;\n\t\t\t\t\n\t\t\t\tstarsobj.style.width=slidestarswidth.toString() + \"px\"\n\t\t\t\tstarsobj.style.height=1*window.innerHeight.toString() + \"px\"\n\t\t\t\tstarsobj.style.left=-slidestarsleft.toString() + \"px\"\n\t\t\t\tstarsobj.style.top=(0).toString() + \"px\"\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t//This animation is good because it resets the rotation\n\t\t\t\t//and flows horizontally to the right the way I want it to.\n\t\t\t\tstarsanimation = starsobj.animate({ \n\t\t\t\ttransform: ['translateX(0)', 'translateX(1280px)']}, \n\t\t\t\t{\n\t\t\t\t\tduration: 10000, //50000,\n\t\t\t\t\titerations: Infinity\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.setState( {showStarForm: false,} );\n\t\t\t}\n\t\t}\n\t\telse //if I can't reach the stars object on the canvas\n\t\t{\n\t\t\tif(starsanimation!=null) {starsanimation.pause(); starsanimation=null;}\n\t\t}\n\t\t\n\t\tif(frozenstars!=null)\n\t\t{\n\t\t\tthis.setState( {showStarForm: true,} );\n\n\t\t\tfrozenstars.style.width=(2*window.innerWidth).toString() + \"px\"\n\t\t\tfrozenstars.style.height=(2*window.innerHeight).toString() + \"px\"\n\t\t\t\n\t\t\tfrozenstars.style.left = (-window.innerWidth/2).toString() + \"px\"\n\t\t\tfrozenstars.style.top  = (-window.innerHeight/2).toString() + \"px\"\n\t\t}\n\t}\n\n\tfreeze()\n\t{\n\t\tif (this.state.frozen===false) { //e.g. before it switches to true\n\t\t\tif(starsanimation != null) { \n\t\t\t\tstarsanimation.pause(); \n\t\t\t\tstarsanimation=null;\n\t\t\t}\n\t\t}\t\n\t\t\n\t\tthis.setState( {frozen: !this.state.frozen} )  \n\t}\n\t\n\t\n\tconvertunits(e)\n\t{\t\n\t\tif(e.target.value !== this.state.units)\n\t\t{\n\t\t\tvar startheight\n\t\t\tvar diameter\n\t\t\tvar thrownUp\n\t\t\tvar speed\n\n\t\t\tvar newdefaults\n\t\t\tif(this.state.units===\"ft\")\n\t\t\t{  newdefaults=defaultMetric }\n\t\t\telse\n\t\t\t{  newdefaults=defaultImperial }\n\t\t\t\n\t\t\tif(this.state.startheight===this.state.defaults.startheight)\n\t\t\t{ startheight=newdefaults.startheight; }\n\t\t\telse {  startheight=round(convertfeetmet(this.state.startheight, this.state.units, newdefaults.units)) }\n\t\t\t\n\t\t\tif(this.state.diameter===this.state.defaults.diameter)\n\t\t\t{ diameter=newdefaults.diameter; }\n\t\t\telse {  diameter=round(convertfeetmet(this.state.diameter, this.state.units, newdefaults.units)) }\n\t   \n\t\t\tif(this.state.thrownUp===this.state.defaults.thrownUp)\n\t\t\t{ thrownUp=newdefaults.thrownUp; }\n\t\t\telse {  thrownUp=round(convertfeetmet(this.state.thrownUp, this.state.units, newdefaults.units)) }\n\n\t\t\tif(this.state.speed===this.state.defaults.speed)\n\t\t\t{ speed=newdefaults.speed; }\n\t\t\telse {  speed=round(convertfeetmet(this.state.speed, this.state.units, newdefaults.units)) }\n\t\t\t\n\t\t\t//now that we've done the above...\n\t\t\tif(this.state.queryflag===true) //if there's a query variable, reset to starting condition\n\t\t\t{\tnewdefaults=defaultQuery;\t}\n\t\t\t\n\t\t\tthis.setState( {\n\t\t\t\tstartheight : startheight,  \n\t\t\t\tdiameter : diameter, \n\t\t\t\tthrownUp : thrownUp, \n\t\t\t\tspeed : speed,\n\t\t\t\t//relative_v_x : round(convertfeetmet(this.state.relative_v_x, this.state.units, newdefaults.units)),\n\t\t\t\t//relative_v_y : round(convertfeetmet(this.state.relative_v_y, this.state.units, newdefaults.units)),\n\t\t\t\tunits: e.currentTarget.value,\n\t\t\t\taccel_earth: newdefaults.accel_earth,\n\t\t\t\t//g_accel: newdefaults.accel_earth * this.state.percentgravity/100,\n\t\t\t\tdefaults: newdefaults,\n\t\t\t}, ()=>{this.updateOtherVars();} )\n\t\t}\n\t}\n\n\tupdateState(value, variable) //take a new input value from the sliders/input boxes and set it.\n\t{   \tif(this.state[variable] !== value) //check that it's actually changed\n\t\t{\t\t\t\t\t\t\t\t  //before needlessly running the logic\n\t\t\tthis.setState({[variable]: value,\n\t\t\t}, ()=>{this.updateOtherVars();} )\n\t\t}\n\t}\n\t\n\t\t\t\n\t//the starting height must NEVER be greater than the diameter!\n\t//Thus this field gets its own handling function.\n\tupdateDiameter(value, variable)\n\t{\n\t\tif(this.state.diameter !== value)\n\t\t{\n\t\t\tif(value < this.state.startheight) {\n\t\t\t\tthis.setState({diameter: value,\n\t\t\t\t\t\t\t\tstartheight: value,\n\t\t\t\t}, ()=>{this.updateOtherVars();} )\n\t\t\t} \n\t\t\telse if( this.state.diameter < 10 && value > 10 && this.state.startheight < 4 && this.state.units===\"ft\")\n\t\t\t{\n\t\t\t\tthis.setState({diameter: value,\n\t\t\t\t\t\t\t\tstartheight: 4,\n\t\t\t\t}, ()=>{this.updateOtherVars();} )\t\t   \n\t\t\t}\n\t\t\telse if( this.state.diameter < 2 && value > 2 && this.state.startheight < 1 && this.state.units===\"m\")\n\t\t\t{\n\t\t\t\tthis.setState({diameter: value,\n\t\t\t\t\t\t\t\tstartheight: 1.2,\n\t\t\t\t}, ()=>{this.updateOtherVars();} )\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.setState({diameter: value,\n\t\t\t\t}, ()=>{this.updateOtherVars();} )\t\t   \n\t\t\t}\n\t\t}\n\t}\n\n\t\n\tupdateOtherVars()  //crunch the numbers and save answers to state\n\t{\t\n\t\tvar encapsulatedCrunch={\n\t\t\tanglefromVertical: this.state.anglefromVertical,\n\t\t\tspeed: this.state.speed,\n\t\t\taccel_earth: this.state.accel_earth,\n\t\t\tpercentgravity: this.state.percentgravity,\n\t\t\tdiameter: this.state.diameter,\n\t\t\tstartheight: this.state.startheight,\n\t\t}\n\n\t\tvar answers = crunchnumbers(encapsulatedCrunch)\n\t\t\n\t\tthis.setState({\n\t\t\texpectedtime : answers.expectedtime,\n\t\t\texpectedheight: answers.expectedheight,\n\t\t\tstandingvelocity: answers.standingvelocity,\n\t\t\tomega: answers.omega,\n\t\t\t//g_accel: g_accel,\n\t\t\tmaxheight: answers.maxheight,\n\t\t\t//x_f : answers.x_f,\n\t\t\t//y_f : answers.y_f,\n\t\t\ttime: answers.time,\n\t\t\tslope: answers.slope,\n\t\t\ttotal_difference: answers.total_difference,\n\t\t\t//directionleft: answers.directionleft,\n\t\t\t\t\t\t//starting speed of coin with standing speed incorporated\n\t\t\tstart_v_x: answers.start_v_x,\t\n\t\t\tstandingcoin: answers.standingcoin,\n\t\t\tg_oncoin: answers.g_oncoin,\n\t\t\texpecteddist: answers.expecteddist,\t\t//coin's landing distance on earth\n\t\t\tstart_speed: answers.start_speed,\n\t\t\ttheta_traversed_person: answers.theta_traversed_person,\n\t\t\ttheta_traversed_coin: answers.theta_traversed_coin,\n\t\t\tcurvilinear: answers.curvilinear,\n\t\t})\n\t}\n\t\n\ttoggleLeftMenu() {\n\t\tthis.setState( {\n\t\t\t//menuLeftOpen: state.isOpen, frozen: state.isOpen,\n\t\t\tmenuLeftOpen: !this.state.menuLeftOpen,\n\t\t\tfrozen: !this.state.menuLeftOpen,\n\t\t} )\n\t}\n\t\n\ttoggleRightMenu() {\n\t\tthis.setState( {\n\t\t\t//menuRightOpen: state.isOpen, frozen: state.isOpen,\n\t\t\tmenuRightOpen: !this.state.menuRightOpen,\n\t\t\tfrozen: !this.state.menuRightOpen,\n\t\t} )\n\t}\n\t\n\t//triggers when the side menus are closed.\n\tcloseMenus(state) {\n\t\t\t//Without queryMenu, then I cannot open the menu with a query variable.\n\t\tif(state.isOpen===false /*&& !this.state.displayArticle*/ && this.state.queryMenu>1)\n\t\t{\n\t\t\t//console.log(\"close\")\n\n\t\t\tthis.setState({\n\t\t\t\tmenuRightOpen: false,\n\t\t\t\tmenuLeftOpen: false,\n\t\t\t\tfrozen: false,\n\t\t\t})\n\t\t}\n\t\telse if(this.state.queryMenu<2) //update state without triggering re-render\n\t\t\t\t\t\t\t\t\t\t//queryMenu isn't actually used to render this component...\n\t\t\t\t\t\t\t\t\t\t//thus it won't break the lifecycle methods.\n\t\t// eslint-disable-next-line react/no-direct-mutation-state\n\t\t{ \tthis.state.queryMenu += 1;\t}\n\t}\n\t\n\t//the apply button in the left menu\n\tcloseMenuButton() {\n\t\tthis.setState({ menuLeftOpen: false, menuRightOpen:false,});\n\t}\n\t\n\ttogglePopUp() {\n\t\tthis.setState( {PopUpOpen: !(this.state.PopUpOpen)} )\n\t}\n \n\t\n  render() {\n\t\t\n\t//var shape\t//is the window tall or wide? (based on event listener to state)\n\t//var bufferid\t//if tall, add a little height break between canvases.\n\t\n\t//console.log(window.innerWidth, window.innerHeight)\n\t/*if(this.state.width > this.state.height)// * 1.25)\n\t{\n\t\tshape=\"wideCanvas\";\t\t//add a width break between canvases.\n\t\tbufferid=\"widthBuffer\";\n\t}\n\telse\n\t{  \t\t\t\t\n\t\tshape=\"tallCanvas\";\n\t\tbufferid=\"heightBuffer\" //add a little height break between canvases.\n\t}*/\n\t\n\t\n\tvar fullunits\n\tif(this.state.units===\"ft\")\n\t{ fullunits = \"feet\" }\telse { fullunits = \"meters\" }  //\"Scale in meters\"\n\t\n\t\t//angle from horizontal-right\n\tvar computedangle = (-1* this.state.anglefromVertical * Math.PI / 180) + (Math.PI / 2)\n\tvar start_v_y = this.state.speed*Math.sin(computedangle)\n\t\n\t//prep vars for canvases\n\tvar EncapsulatedVariables = {\t\n\t\t\tslope : this.state.slope,\n\t\t\ttime : this.state.time,\n\t\t\tradius: this.state.diameter/2,\n\t\t\tomega: this.state.omega,\n\t\t\tstartheight: this.state.startheight,\n\t\t\tstart_v_x: this.state.start_v_x,\n\t\t\tstart_v_y: start_v_y,\n\t\t\tunits: this.state.units,\n\t\t\tmenuLeftOpen: this.state.menuLeftOpen,\n\t\t\tmenuRightOpen: this.state.menuRightOpen,\n\t\t\tpercenttime: this.state.percenttime,\n\t\t\tfrozen: this.state.frozen,\n\t\t\texpectedtime: this.state.expectedtime,\n\t\t\tanglefromVertical: this.state.anglefromVertical,\n\t\t\tspeed: this.state.speed,\n\t\t}\n\t\t\n\t//prep vars for output menu\n\tvar EncapsulatedOutput = {\t\n\t\t\trotation: this.state.omega / (2 * Math.PI),\n\t\t\tunits: this.state.units,\n\t\t\tstandingvelocity: this.state.standingvelocity,\n\t\t\tcentripaccel: this.state.accel_earth * this.state.percentgravity / 100,\n\t\t\tstandingcoin: -1 * this.state.standingcoin,\n\t\t\tg_oncoin: this.state.g_oncoin,\n\t\t\ttime: this.state.time,\n\t\t\texpectedtime: this.state.expectedtime,\n\t\t\tmaxheight: this.state.maxheight,\n\t\t\texpectedheight: this.state.expectedheight,\n\t\t\tfinalseparation: this.state.total_difference,\n\t\t\texpecteddist: this.state.expecteddist,\n\t\t\tthrowspeed: this.state.start_speed,\n\t\t\ttheta_traversed_person: this.state.theta_traversed_person,\n\t\t\ttheta_traversed_coin: this.state.theta_traversed_coin,\n\t\t\tcurvilinear: this.state.curvilinear,\n\t\t\t\n\t\t\t//need to know whether the coin landed to the right or left of the person.\n\t\t\t//relative_v_x: this.state.relative_v_x,  //actually no.\n\t\t\t//directionleft: this.state.directionleft,\n\t\t}\n\n\t//in input menu: \"Height coin reaches if thrown on Earth\"\n\tvar heightexpected = round(this.state.expectedheight)\n\tvar checkvalue = 11100; if(this.state.units===\"ft\") checkvalue *= 3.28084;\n\tif(start_v_y > checkvalue)\n\t{ heightexpected = \"Escape Velocity\"}\n\telse heightexpected = heightexpected.toString() + \" \" + this.state.units.toString()\n\t\n\t//Input menu also shows the throw in mph to be useful.\n\tvar secondspeed;\n\tif(this.state.units===\"ft\")\n\t{\tsecondspeed = \"(\" + round(this.state.speed * 0.681818).toString() + \" mph)\" }\n\telse\n\t{\tsecondspeed = \"(\"+ round(this.state.speed * 3.6).toString() + \" km/h)\" }\t\n\n\t //don't display the star speed option if it's just going horizontally/not synced\n\tvar showStarForm=\"starForm\";\n\tif(!this.state.showStarForm) { showStarForm=\"hide\"; }\n\t\n\t//canvas is frozen, then stars are frozen\n\tvar frozenstars\n\tif(this.state.frozen) { frozenstars = \"frozenstars\"; }\n\telse { frozenstars = \"stars\";}\n\t\n\t\n\t//this part preps the text to display difference on the main screen\n\t\tvar difference = Math.abs(this.state.total_difference-this.state.expecteddist);\n\t\t\n\t\t//If the person has traveled more than half a circle,\n\t\t//then don't display the \"Difference from throw on Earth\".\n\t\tvar showDifference=\"diffnotice\"\n\t\t//console.log(this.state.theta_traversed_person, this.state.theta_traversed_coin, difference)\n\t\tif( (Math.abs(this.state.theta_traversed_person-this.state.theta_traversed_coin) > Math.PI / 2 ) || !isFinite(difference) )\n\t\t\t{ showDifference=\"hide\" }\n\t\t\n\t\tvar secondaryunits\n\t\tvar show_diff_from_expected1=\"\"\n\t\tvar show_diff_from_expected2=\"hide\"\n\t\tvar diff_from_expected2\n\t\t//var diff_from_expected3\n\t\tif(difference < 1)\n\t\t{\n\t\t\tshow_diff_from_expected2 = \"\"\n\t\t\t//show_diff_from_expected1 = \"hide\"\n\t\t\tif(this.state.units ===\"ft\")\n\t\t\t{  diff_from_expected2 = difference * 12; secondaryunits=\"in\"; }  //in\n\t\t\telse\n\t\t\t{  diff_from_expected2 = difference * 100; secondaryunits=\"cm\"; } //cm\n\t\t}\n\t\telse if(difference>5280 && this.state.units===\"ft\") {\n\t\t\tshow_diff_from_expected2 = \"\"\n\t\t\t//show_diff_from_expected1 = \"hide\"\n\t\t\tdiff_from_expected2 = difference / 5280;\n\t\t\tsecondaryunits = \"mi\"\n\t\t\tshowDifference=\"diffnoticesmall\"\n\n\t\t}\n\t\telse if(difference>1000 && this.state.units===\"m\") {\n\t\t\tshow_diff_from_expected2 = \"\"\n\t\t\t//show_diff_from_expected1 = \"hide\"\n\t\t\tdiff_from_expected2 = difference / 1000;\n\t\t\tsecondaryunits = \"km\"\n\t\t\tshowDifference=\"diffnoticesmall\"\n\t\t}\n\n\t//reshape page if left menu opens\n\t//react-burger-menu has an option to push, but that pushes off the page\n\t//it also has an option to scale, but that doesn't work, \n\t\t\t//and I don't want to 'scale' everything, just reshape it.\n\t\t\t\n\tvar burgerPageClass = \"\"\n\tif(this.state.menuLeftOpen && this.state.shouldShiftForBurger) { burgerPageClass=\"pageShrunkForBurger\" }\n\t\n\nreturn (\n\n<div id=\"App\">\n\t<div id=\"starsparent\">\n\t\t<div id={frozenstars}></div>\n\t</div>\n\n\t<div id=\"bm-outer-container\">\n\t<Menu noOverlay isOpen={ this.state.menuLeftOpen } onStateChange={ this.closeMenus } menuClassName={ \"bm-menu-left\" }>\n\t  <ReactTouchEvents swipeTolerance={80} tapTolerance={70} onSwipe={ (e) => { if(e===\"left\") { this.closeMenus({isOpen:false}) } } }><div className=\"swipearea\">\n\n\t  <div id=\"CenteredLeftMenu\">\n\t\t<div><h3>Input Variables</h3></div>\n\t\t\n\t\t<RadioConvertUnits onChange={this.convertunits} units={this.state.units} />\n\n\t\t<InputField title=\"Starting height\" min={0} max={this.state.diameter} updateState={this.updateState} value={this.state.startheight} default={this.state.defaults[\"startheight\"]} variable=\"startheight\" units={this.state.units}/>\n\n\t\t<AngleInput title=\"Angle from vertical\" value={this.state.anglefromVertical} min=\"-180\" max=\"180\" default={0} updateState={this.updateState} variable=\"anglefromVertical\" units=\"°\" droppedflag={(this.state.speed===0)} />\n\t\t\n\t\t<InputField title=\"Throw speed\" value={this.state.speed} min={0} max={5000} updateState={this.updateState}  default={this.state.defaults[\"speed\"]}  variable=\"speed\" units={this.state.units+\"/s\"}/>\n\t\t\n\t\t<table><tbody>\n\t\t\t<tr><td><div className=\"randomFact\">Height coin reaches<br/>if thrown on Earth</div></td>\n\t\t\t\t<td><div className=\"UnitsStyle\" style={{width:'initial', backgroundColor:'#adccff', fontSize:'16px'}}>{heightexpected}</div></td>\n\t\t\t\t<td><div style={{width:'initial', color:'white', marginLeft:'5px', marginRight:'-20px', fontSize:'14px'}}>{secondspeed}</div></td></tr>\n\t\t</tbody></table>\n\n\t\t<InputField title=\"Station diameter\" value={this.state.diameter} min={1} max={10000000000}  default={this.state.defaults[\"diameter\"]} updateState={this.updateDiameter} variable=\"diameter\" units={this.state.units}/>\n\t\t\n\t\t<InputField title=\"Gravity at floor\" min={0} max={2000} updateState={this.updateState} variable=\"percentgravity\"  default={this.state.defaults[\"percentgravity\"]} value={this.state.percentgravity} units=\"%\"/>\n\n\t\t<button type=\"submit\" className=\"ResetButton\" onClick={ this.setDefaultState }>Return to<br/> defaults</button>&emsp;\n\t\t<button type=\"submit\" className=\"ResetButton\" onClick={ this.closeMenuButton }>Apply and<br/>close menu</button>\n\n\t  </div>\n\t  \n\t  </div></ReactTouchEvents>\n\t</Menu></div>\n\n\t<Menu right noOverlay isOpen={ this.state.menuRightOpen } onStateChange={ this.closeMenus } menuClassName={ \"bm-menu-right\" }>\n\t\t<ReactTouchEvents swipeTolerance={80} tapTolerance={70} onSwipe={ (e) => { if(e===\"right\") { this.closeMenus({isOpen:false}) } } }><div className=\"swipearea\">\n\t\t\t<OutputMenu menuOpen={this.state.menuRightOpen} closeMenuButton={this.closeMenuButton} vars={EncapsulatedOutput} />\n\t\t</div></ReactTouchEvents>\n\t</Menu>\n\t\n<div id=\"bm-page-wrap\" className={burgerPageClass} ref={this.burgerPageRef}>\n\n\t<div className=\"navbar\">A Toss on a Spinning Space Station</div>\n\n\t<div id=\"spaceGround\" className={this.state.pageShape + \"Canvas\"} >\n\t\t<div className=\"overlaytext\">On a {this.state.diameter} {this.state.units} station</div>\n\n\t\t<div className={showStarForm}>Show stars at:&nbsp;\n\t\t\t<select id=\"starDropdown\" value={this.state.starSpeed} onChange={(e) => this.updateStarSpeed(e.target.value) }>\n\t\t\t\t<option value={5}>Slow speed (5%)</option>\n\t\t\t\t<option value={100}>True speed (100%)</option>\n\t\t\t</select>\n\t\t</div>\n\t\t\n\t\t\n\t\t<CanvasSpace vars={EncapsulatedVariables} sendRotation={ this.receiveStarCenter } defaults={this.state.defaults} />\n\t\t\n\t\t<div className={ showDifference }>\n\t\t\t\t\t<span style={{color:'#adbdff'}}>Difference from throw on Earth:</span>\n\t\t\t\t\t<span className={show_diff_from_expected1}>&nbsp;{format(difference)}</span>\n\t\t\t\t\t<span className={show_diff_from_expected1}>&nbsp;{this.state.units}</span>\n\t\t\t\t\t<span className={show_diff_from_expected2}>&nbsp;({format(diff_from_expected2)}</span>\n\t\t\t\t\t<span className={show_diff_from_expected2}>&nbsp;{secondaryunits})</span>\n\t\t</div>\n\t</div>\n\n\t<div id={this.state.pageShape + \"Buffer\"}></div>\n\t\n\t<div className={this.state.pageShape + \"Canvas\"} >\n\t\t<div className=\"overlaytext\">On Earth</div>\n\t\t\n\t\t<PlayBack min={0} max={Math.ceil(this.state.time)*100} updateState={this.updateState} default={this.state.defaults[\"percenttime\"]}  variable=\"percenttime\" value={this.state.percenttime} units=\"%\"/>\n\t\t\n\t\t<CanvasEarth vars={EncapsulatedVariables} defaults={this.state.defaults} />\n\t\t\n\t\t<div id=\"scale\"><i>Scale in {fullunits}</i></div>\n\t</div>\n\t\t\t\t  \n\t<div>\n\t\t<MenuButton id={\"leftMenuButton\"} open={this.toggleLeftMenu}>Edit the Throw</MenuButton>\n\t\t<div className=\"centered\">\n\t\t\t<FreezeButton freeze={this.freeze} frozen={this.state.frozen} />\n\t\t\t<button id=\"referenceLink\" className=\"button\" onClick={this.togglePopUp}>About This Page</button>\n\t\t</div>\n\t\t<MenuButton id={\"rightMenuButton\"} open={this.toggleRightMenu}>Links & Stats</MenuButton>\n\t</div>\n</div>\n\n  <PopUp display={this.state.PopUpOpen} toggle={this.togglePopUp}/>\n\n</div>\n\t\n\t\n\n    );\n  }\n}\n\n\n\n//rounds to three significant figures. (unless given a specified num decimal places)\nfunction round(num, places) {\n\tif(num===0)\n\t{ return 0 }\n\t\n    if(places==null && num > 1)\n\t{\n\t\tvar order = Math.floor(Math.log(num) / Math.LN10\n                       + 0.000000001); // because float math sucks like that\n\t\tplaces = (order * -1) + 2\n\t}\n\telse if(places==null)\n\t{ places = 2 }\n\t\n\tvar multiplier = Math.pow(10, places);\n    var output = Math.round(num * multiplier) / multiplier;\n\t\n\t//fix some weird output. Probably due to feet/meters conversion not being more precise.\n\tif(Math.abs(output - Math.round(output)) <= .0011)\n\t{ output = Math.round(output); }\n\n\treturn output;\t\n}\n\n\nfunction convertfeetmet(value, fromunit, tounit)\n{\n\tif(fromunit===\"ft\" && tounit===\"m\")\n\t{ return to_meters(value) }\n\telse\n\t{ return to_feet(value) }\n}\n\nfunction to_meters(feet) //defined exactly by the National Bureau of Standards.\n{ return feet * 0.3048 } //Is the definition of a foot.\n\t\t\t\t\t\t //I can't get more accurate than that.\n\nfunction to_feet(meters)\t\t\t//The inverse calculates to more decimals...\n{ return meters * 3.2808333333 }\n\n\n\nfunction format(num)\n{\n\tnum = round(num)\n\t\n\tif(!isFinite(num) )\n\t{ return \"∞\" }\n\telse\n\t{ if(num < 99999) return num.toString()\n\t  else return num.toExponential(0).replace(\"e+\",\"*10^\") }\n\t\n}\n\n\n/*function process_md(markdownfile) {\n\tvar markdownCompileResult = md.render(markdownFile);\n\t\n\treturn markdownCompileResult\n}*/\n\n\nclass PopUp extends Component{\n\trender() {\n\t\n\tvar showelement=\"hide\";\n\tif(this.props.display) {showelement=\"\"}\n\n\treturn(\n<div className={showelement}>\n\t\n\t<div className=\"popupoverlay\" onClick={this.props.toggle}></div>\n\t\n\t<div id=\"popup\">\n\t\t<div style={{textAlign:'center'}}>\n\t\t\t<h1>About This Page</h1>\n\t\t</div>\n\t\t<div id=\"popupcontent\">\n\t\t\t<p>This page models motion on a space station that spins to produce gravity.</p>\n\t\t\t<p>No one has ever built a spinning space station before. Life on such a space station would be different from our experience.</p>\n\t\t\t<p>Objects move differently in a spinning environment due to a phenomena called the Coriolis effect. If you were to toss something in the air, it would not land where you expect it to. This model demonstrates that toss for you.</p>\n\t\t\t<p>You can change the toss by pressing the \"Edit the Throw\" button. <a href={window.articleUrl +'/ideas'}>This link</a> also generates some interesting throws to help you learn more about it.</p>\n\t\t</div>\n\t\t\n\t\t<div style={{textAlign:'center'}}>\n\t\t\t<button className=\"ResetButton\" type=\"submit\" onClick={this.props.toggle}>Got it</button>\n\t\t</div>\n\t</div>\n</div>\t\n\t\n\t);\n\t\t\n\t}\n}\n//\t\t\t<CrossIcon onClick={this.props.toggle} className=\"crossIcon\"/>\t\n\n\nclass FreezeButton extends Component {\n\trender() {\n\t\n\tvar buttontext\n\tif(this.props.frozen===false)\n\t{ buttontext=\"Freeze\" }\n\telse\n\t{ buttontext=\"Unfreeze\" }\n\t\n\treturn (\n\t\t<button type=\"submit\" className=\"button\" id=\"FreezeButton\" onClick={ this.props.freeze }>{buttontext}</button>\n\t)\n\t\n\t}\n\t\n}\n\n\n//Button to open the burger menus (two of them)\nclass MenuButton extends Component {\n\trender() {\n\t\t\n\treturn (\n\t\t<button type=\"submit\" className=\"button\" id={this.props.id} onClick={ this.props.open }>{this.props.children}</button>\n\t\t)\n  }\n}\n\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = __webpack_public_path__ + \"static/media/silhouette.244b8ee0.png\";"],"sourceRoot":""}